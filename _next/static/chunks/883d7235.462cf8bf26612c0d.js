"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7679],{10795:function(a,l,o){o.r(l),o.d(l,{default:function(){return Hc}});var s,c,d,f,v=o(15059),y=o(36609),b=o(12849),w=o(67294),x=o(68188),E=o(7207),S=o(57632),k=o(39597),I=o(76076),R=o(42216),T=o(4511),O=o(86744),M=o(82968),P=o(29619),F=o(94801),z=o(59821),_=o(91036),B=o(93041),H=o(43338),W=o(79890),U=o(38886),G=o(69203),Q=o(22512);let Z="clover",Y=Object.fromEntries(Object.entries({en:{commonClose:"Close",commonNext:"Next",commonPrevious:"Previous",commonSearch:"Search",commonSearchPlaceholder:"Search...",commonShare:"Share",commonViewAll:"View All",copyFailure:"Failed",copySuccess:"Copied",contentSearchLoading:"Loading...",contentSearchPlaceholder:"Search",contentSearchResultsNone:"No Results",contentSearchResultsMore:"More Results",informationPanelTabs:"Select",informationPanelTabsClose:"Viewer",informationPanelTabsAbout:"About",informationPanelTabsAnnotations:"Annotations",informationPanelTabsSearch:"Search",informationPanelToggle:"More Information",shareCollectionJson:"View Collection",shareCollectionCopy:"Copy Collection URL",shareManifestJson:"View Manifest",shareManifestCopy:"Copy Manifest URL"},pt:{}}).map(([a,l])=>[a,{[`${Z}`]:l}]));y.ZP.use(v.Z).use(b.Db).init({defaultNS:Z,fallbackLng:"en",ns:[Z],resources:{...Y}});var V=function(a){return function(){let l={type:a,getType:()=>a,toString:()=>a};return(a,o)=>({...l,...void 0!==a&&{payload:a},...void 0!==o&&{meta:o}})}},ee="@iiif/IMPORT_ENTITIES",et="@iiif/MODIFY_ENTITY_FIELD",ei="@iiif/REORDER_ENTITY_FIELD",en="@iiif/ADD_REFERENCE",ea="@iiif/UPDATE_REFERENCE",er="@iiif/REMOVE_REFERENCE",el="@iiif/ADD_METADATA",eo="@iiif/REMOVE_METADATA",es="@iiif/UPDATE_METADATA",ec="@iiif/REORDER_METADATA",ed=V(ee)(),eu=V(et)(),em=V(ei)(),eh=V(en)(),ep=V(er)(),ef=V(ea)(),eg=V(el)(),ev=V(es)(),ey={importEntities:ed,modifyEntityField:eu,reorderEntityField:em,addReference:eh,removeReference:ep,updateReference:ef,addMetadata:eg,removeMetadata:V(eo)(),updateMetadata:ev,reorderMetadata:V(ec)()},eb="@iiif/ADD_MAPPING",ew="@iiif/ADD_MAPPINGS",ex=V(eb)(),eE=V(ew)(),eS="RESOURCE_ERROR",eC="RESOURCE_LOADING",ek="RESOURCE_READY",eI="@iiif/REQUEST_RESOURCE",eA="@iiif/REQUEST_ERROR",eR="@iiif/REQUEST_MISMATCH",e$="@iiif/REQUEST_COMPLETE",eT=V(eI)(),eO=V(eA)(),eM=V(eR)(),eL=V(e$)(),eP="@iiif/BATCH",eF=V(eP)(),Ni=(a,l)=>{let{entities:o,resource:s,mapping:c}=(0,x.z)(l);if(void 0===s.id)return[eO({id:a,message:"ID is not defined in resource."})];let d=[ed({entities:o}),eE({mapping:c})];return s.id!==a&&(d.push(ex({id:a,type:s.type})),d.push(eM({requestId:a,actualId:s.id}))),d.push(eL({id:a})),d},ez=Number.isNaN||function(a){return"number"==typeof a&&a!=a};function yt(a,l){if(!Array.isArray(a)||!Array.isArray(l))return a===l;if(a.length!==l.length)return!1;for(let c=0;c<a.length;c++){var o,s;if(!((o=a[c])===(s=l[c])||ez(o)&&ez(s)))return!1}return!0}function Ve(a,l,o){let s=a.iiif.requests[l],c=a.iiif.mapping[l];if(!c||!a.iiif.entities[c][s.resourceUri])return;let d=a.iiif.entities[c][s.resourceUri];if(d&&d[x.c]){let a=d[x.c].find(a=>a[x.d]===d.id);return(0,x.j)(d,a)}return d}function bt(a,l,{waitTimeout:o=30}={}){return(s,c)=>{let d=a.getStore(),f=d.getState(),v=f.iiif.requests[s];if(v){if(v.loadingState===ek){let a=Ve(f,s);if(a)return a}switch(v.loadingState){case eS:break;case eC:return(async()=>{let a,l=!1;try{let c=await Promise.race([new Promise((o,c)=>{l||(a=d.subscribe(()=>{let a=d.getState();if(a.iiif.requests[s].loadingState===eS){c();return}if(a.iiif.requests[s].loadingState===ek){let l=Ve(a,s);l?o(l):c()}}))}),new Promise((a,s)=>setTimeout(()=>{l=!0,s()},6e4*o))]);if(a&&a(),c)return c}catch{a&&a()}})()}}a.dispatch(eT({id:s}));let u=l=>{if(!l)return;l.id||l["@id"]||(l["@type"]&&(l["@id"]=s),l.id=s);let o=Ni(s,l);return a.dispatch(eF({actions:o})),Ve(d.getState(),s)};try{let o=l(s,c);return o&&"function"==typeof o.then?(async()=>{try{return u(await o)}catch(l){throw a.dispatch(eO({id:s,message:l.toString()})),l}})():u(o)}catch(l){throw a.dispatch(eO({id:s,message:l.toString()})),l}}}function sn(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}let ej={};var wt=a=>{let l;let o=new Set,r=(a,s)=>{let c="function"==typeof a?a(l):a;if(!Object.is(c,l)){let a=l;l=s??("object"!=typeof c||null===c)?c:Object.assign({},l,c),o.forEach(o=>o(l,a))}},i=()=>l,s={setState:r,getState:i,getInitialState:()=>c,subscribe:a=>(o.add(a),()=>o.delete(a)),destroy:()=>{(ej?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},c=l=a(r,i,s);return s},Gi=a=>a?wt(a):wt,e_="@iiif/SET_META_VALUE",eD="@iiif/SET_META_VALUE_DYNAMIC",eV="@iiif/UNSET_META_VALUE",eB={setMetaValue:V(e_)(),setMetaValueDynamic:V(eD)(),unsetMetaValue:V(eV)()};let eH={};var Zi=(a,l)=>(o,s,c)=>(c.dispatch=l=>(o(o=>a(o,l),!1,l),l),c.dispatchFromDevtools=!0,{dispatch:(...a)=>c.dispatch(...a),...l}),eN=new Map,xe=a=>{let l=eN.get(a);return l?Object.fromEntries(Object.entries(l.stores).map(([a,l])=>[a,l.getState()])):{}},Ki=(a,l,o)=>{if(void 0===a)return{type:"untracked",connection:l.connect(o)};let s=eN.get(o.name);if(s)return{type:"tracked",store:a,...s};let c={connection:l.connect(o),stores:{}};return eN.set(o.name,c),{type:"tracked",store:a,...c}},to=(a,l={})=>(o,s,c)=>{let d;let{enabled:f,anonymousActionType:v,store:y,...b}=l;try{d=(f??(eH?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return(eH?"production":void 0)!=="production"&&f&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),a(o,s,c);let{connection:w,...x}=Ki(y,d,b),E=!0;c.setState=(a,l,d)=>{let f=o(a,l);if(!E)return f;let x=void 0===d?{type:v||"anonymous"}:"string"==typeof d?{type:d}:d;return void 0===y?null==w||w.send(x,s()):null==w||w.send({...x,type:`${y}/${x.type}`},{...xe(b.name),[y]:c.getState()}),f};let h=(...a)=>{let l=E;E=!1,o(...a),E=l},S=a(c.setState,s,c);if("untracked"===x.type?null==w||w.init(S):(x.stores[x.store]=c,null==w||w.init(Object.fromEntries(Object.entries(x.stores).map(([a,l])=>[a,a===x.store?S:l.getState()])))),c.dispatchFromDevtools&&"function"==typeof c.dispatch){let a=!1,l=c.dispatch;c.dispatch=(...o)=>{(eH?"production":void 0)==="production"||"__setState"!==o[0].type||a||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),a=!0),l(...o)}}return w.subscribe(a=>{var l;switch(a.type){case"ACTION":if("string"!=typeof a.payload){console.error("[zustand devtools middleware] Unsupported action format");return}return Ne(a.payload,a=>{if("__setState"===a.type){if(void 0===y){h(a.state);return}1!==Object.keys(a.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let l=a.state[y];if(null==l)return;JSON.stringify(c.getState())!==JSON.stringify(l)&&h(l);return}c.dispatchFromDevtools&&"function"==typeof c.dispatch&&c.dispatch(a)});case"DISPATCH":switch(a.payload.type){case"RESET":return h(S),void 0===y?null==w?void 0:w.init(c.getState()):null==w?void 0:w.init(xe(b.name));case"COMMIT":if(void 0===y){null==w||w.init(c.getState());break}return null==w?void 0:w.init(xe(b.name));case"ROLLBACK":return Ne(a.state,a=>{if(void 0===y){h(a),null==w||w.init(c.getState());return}h(a[y]),null==w||w.init(xe(b.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ne(a.state,a=>{if(void 0===y){h(a);return}JSON.stringify(c.getState())!==JSON.stringify(a[y])&&h(a[y])});case"IMPORT_STATE":{let{nextLiftedState:o}=a.payload,s=null==(l=o.computedStates.slice(-1)[0])?void 0:l.state;if(!s)return;h(void 0===y?s:s[y]),null==w||w.send(null,o);break}case"PAUSE_RECORDING":return E=!E}return}}),S},Ne=(a,l)=>{let o;try{o=JSON.parse(a)}catch(a){console.error("[zustand devtools middleware] Could not parse the received json",a)}void 0!==o&&l(o)},ro=a=>(l,o,s)=>{let c=s.subscribe;return s.subscribe=(a,l,o)=>{let d=a;if(l){let c=(null==o?void 0:o.equalityFn)||Object.is,f=a(s.getState());d=o=>{let s=a(o);if(!c(f,s)){let a=f;l(f=s,a)}},null!=o&&o.fireImmediately&&l(f,f)}return c(d)},a(l,o,s)};function je(a,l,o,s){return!(!a[o]||!a[o][l]||!a[o][l][s]||!Array.isArray(a[o][l][s]))}function C(a){return a.payload}function Ue(a,l){return typeof a>"u"?l:a}function un(a={}){let l=Object.keys(a);return function(o={},s){let c=!1,d={};for(let f=0;f<l.length;f++){let v=l[f];d[v]=a[v](o[v],s),c=c||d[v]!==o[v]}return c?d:o}}var eW=un({mapping:(a={},l)=>{switch(l.type){case eb:return{...a,[l.payload.id]:l.payload.type};case ew:return{...a,...l.payload.mapping};default:return a}},entities:(a=sn(),l)=>{var o;let n=(o,s)=>({...a,[C(l).type]:{...a[C(l).type],[C(l).id]:{...o,...s}}});switch(l.type){case et:{if(!a[C(l).type]||!a[C(l).type][C(l).id])return a;let o=a[C(l).type][C(l).id];return"string"==typeof o?a:n(o,{[C(l).key]:C(l).value})}case ei:{if(!je(a,C(l).id,C(l).type,C(l).key))return a;let o=a[C(l).type][C(l).id];if("string"==typeof o)return a;let s=Array.from(o[C(l).key]),[c]=s.splice(C(l).startIndex,1);return s.splice(C(l).endIndex,0,c),n(o,{[C(l).key]:s})}case ee:{let o=Object.keys(C(l).entities),s={...a};for(let c of o){let o=C(l).entities[c],d={...a[c]||{}},f=!1,v=Object.keys(o||{})||[];if(o&&v){for(let l of v)f=!0,d[l]=a[c][l]?function(a,l){let o={},s=[];for(let[c,d]of Object.entries(a||{})){s.push(c);let a=(l||{})[c];if(!a||0===a.length){o[c]=d;continue}o[c]=a}for(let[a,c]of Object.entries(l||{}))-1===s.indexOf(a)&&(o[a]=c);return o}(a[c][l],o[l]):o[l];f&&(s[c]=d)}}return s}case en:{if(!je(a,C(l).id,C(l).type,C(l).key))return a;let o=a[C(l).type][C(l).id],s=Array.from(o[C(l).key]);return s.splice(Ue(C(l).index,s.length+1),0,C(l).reference),n(o,{[C(l).key]:s})}case ea:case er:{if(!je(a,C(l).id,C(l).type,C(l).key))return a;let s=a[C(l).type][C(l).id],c=Array.from(s[C(l).key]),d=Ue(C(l).index,c.findIndex(a=>a&&a.id===C(l).reference.id));return -1===d||(null==(o=c[d])?void 0:o.id)!==C(l).reference.id?a:(l.type===ea?c.splice(d,1,C(l).reference):c.splice(d,1),n(s,{[C(l).key]:c}))}case el:{let o=a[C(l).type][C(l).id];if(!o)return a;let s=Array.from(o.metadata||[]),c=C(l);return s.splice(Ue(l.payload.beforeIndex,s.length+1),0,{label:c.label,value:c.label}),n(o,{metadata:s})}case ec:{let o=a[C(l).type][C(l).id];if("string"==typeof o||!o)return a;let s=Array.from(o.metadata||[]),[c]=s.splice(C(l).startIndex,1);return s.splice(C(l).endIndex,0,c),n(o,{metadata:s})}case es:case eo:{let o=a[C(l).type][C(l).id],s=Array.from(o.metadata||[]),c=C(l).atIndex;return typeof c>"u"||-1===c||!s[c]?a:(l.type===es?s.splice(c,1,{label:C(l).label,value:C(l).value}):s.splice(c,1),n(o,{metadata:s}))}default:return a}},requests:(a={},l)=>{switch(l.type){case eI:case"@iiif/REQUEST_OFFLINE_RESOURCE":return{...a,[l.payload.id]:{requestUri:l.payload.id,loadingState:eC,uriMismatch:!1,resourceUri:l.payload.id}};case eR:return{...a,[l.payload.requestId]:{...a[l.payload.requestId]||{},uriMismatch:!0,resourceUri:l.payload.actualId},[l.payload.actualId]:{requestUri:l.payload.requestId,loadingState:a[l.payload.requestId].loadingState,uriMismatch:!0,resourceUri:l.payload.actualId}};case eA:return{...a,[l.payload.id]:{...a[l.payload.id]||{},loadingState:eS,error:l.payload.message}};case e$:return{...a,[l.payload.id]:{...a[l.payload.id]||{},loadingState:ek,error:void 0}}}return a},meta:(a={},l)=>{let{id:o,updateValue:s,value:c,meta:d,key:f}=l&&l.payload||{};switch(l.type){case e_:return{...a,[o]:{...a[o]||{},[d]:{...a[o]&&a[o][d]||{},[f]:c}}};case eD:return{...a,[o]:{...a[o]||{},[d]:{...a[o]&&a[o][d]||{},[f]:s(a[o]&&a[o][d]?a[o][d][f]:void 0)}}};case eV:return a[o]&&a[o][d]&&a[o][d][f]?{...a,[o]:{...a[o]||{},[d]:{...a[o]&&a[o][d]||{},[f]:void 0}}}:a;default:return a}}}),eq=Object.defineProperty,po=(a,l,o)=>l in a?eq(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o,K=(a,l,o)=>(po(a,"symbol"!=typeof l?l+"":l,o),o);function j(a,l,o,s=!0){l[eG]=l[eG]||[],l[eG].push(a);let c=new Map;Object.defineProperty(l,a,{enumerable:s,get(){if(typeof l[eU][a]>"u")return;let s=l[eU][a];if(!s)return s;let d=o.get(l[eU][a],{parent:this.id?{id:this.id,type:this.type}:void 0});return c.has(d)||(c.clear(),c.set(d,ae(d,o))),c.get(d)},set(s){l[eU][a]!==s&&(this[eJ]?o.modifyEntityField({id:this.id,type:this.type},a,function mn(a){return Array.isArray(a)?a.map(a=>mn(a)):a&&a.type?{id:a.id,type:a.type}:a}(s)):this[eU][a]=s)}})}var eU=Symbol.for("_refs_"),eJ=Symbol.for("_reactive_"),eG=Symbol.for("_defined_"),eQ=Symbol.for("_parent_");function ae(a,l,o=!1,s){if(Array.isArray(a))return a.map(a=>ae(a,l,o));if(!a||!a.type||!a.id)return a;let c=function(a,l=!1,o){let s={id:"",type:"unknown",[eG]:[],[eU]:{},[eQ]:null,[eJ]:null,is(a){return"string"==typeof a?this.id===a:!!a.id&&a.id===this.id},reactive(){if(!this[eJ])return this[eJ]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){let a=this.unwrap();for(let l of Object.keys(a||{}))this[eG].includes(l)?this[eU][l]=a[l]:this[l]=a[l]}},unreactive(){this[eJ]&&(this[eJ](),this[eJ]=null)},unwrap(){if(!this.id)throw Error("Invalid object");let l=this[eQ];return a.get(this.id,{parent:l?{id:l,type:"unknown"}:void 0})},toPresentation3(){return a.toPresentation3(this.unwrap())},toPresentation2(){return a.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){return{...this,items:this.items,annotations:this.annotations,structures:this.structures,seeAlso:this.seeAlso,service:this.service,services:this.services,rendering:this.rendering,partOf:this.partOf,start:this.start,supplementary:this.supplementary,homepage:this.homepage,thumbnail:this.thumbnail,placeholderCanvas:this.placeholderCanvas,accompanyingCanvas:this.accompanyingCanvas,provider:this.provider}},subscribe(l,o=!0){return a.subscribe(()=>this.id?a.get(this.id):null,l,o)}};return j("items",s,a),j("annotations",s,a),j("structures",s,a),j("seeAlso",s,a),j("rendering",s,a),j("partOf",s,a),j("start",s,a,!1),j("supplementary",s,a),j("homepage",s,a),j("thumbnail",s,a),j("placeholderCanvas",s,a,!1),j("accompanyingCanvas",s,a,!1),j("provider",s,a),j("body",s,a),j("logo",s,a),s}(l,o),d=Object.create(c),f=Object.assign(d,a);return o&&f.reactive(),f}function St(a){switch(a){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return a}var eZ=class{constructor(a,l){var o;K(this,"options"),K(this,"store"),K(this,"emitter"),K(this,"isBatching",!1),K(this,"batchQueue",[]),K(this,"remoteFetcher"),K(this,"staticFetcher"),K(this,"defaultFetcher",a=>fetch(a).then(a=>a.json())),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},a||{}),this.store=l||function(a={}){var l;let{enableDevtools:o=!1,iiifStoreName:s="iiif",defaultState:c={iiif:{entities:sn(),meta:{},mapping:{},requests:{}}},customReducers:d={}}=a,f=(l=un({[s]:eW,...d}),(a,o)=>o&&o.type===eP?o.payload.actions.reduce(l,a):o&&"@iiif/BATCH_IMPORT"===o.type?{...a,iiif:{...a.iiif,...o.payload.state}}:l(a,o)),v="u">typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?to:(a,l)=>a;return Gi(ro(v(Zi(f,c),{enabled:o})))}({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter={all:o=o||new Map,on:function(a,l){var s=o.get(a);s?s.push(l):o.set(a,[l])},off:function(a,l){var s=o.get(a);s&&(l?s.splice(s.indexOf(l)>>>0,1):o.set(a,[]))},emit:function(a,l){var s=o.get(a);s&&s.slice().map(function(a){a(l)}),(s=o.get("*"))&&s.slice().map(function(o){o(a,l)})}},this.remoteFetcher=bt(this,this.options.customFetcher),this.staticFetcher=bt(this,(a,l)=>l)}batch(a){this.isBatching=!0;try{a(this),this.isBatching=!1,this.dispatch(eF({actions:this.batchQueue}))}catch(a){throw this.batchQueue=[],this.isBatching=!1,a}this.batchQueue=[]}async asyncBatch(a){this.isBatching=!0;try{await a(this),this.isBatching=!1,this.dispatch(eF({actions:this.batchQueue}))}catch(a){throw this.batchQueue=[],this.isBatching=!1,a}this.batchQueue=[]}modifyEntityField(a,l,o){this.dispatch(ey.modifyEntityField({id:a.id,type:a.type,key:l,value:o}))}dispatch(a){if(this.isBatching)this.batchQueue.push(a);else{if(a.type===eP){for(let l of a.payload.actions)this.emitter.emit(l.type,{action:l,state:this.store.getState()});this.store.dispatch(a);let l=this.getState();for(let o of a.payload.actions)this.emitter.emit(`after:${o.type}`,{action:o,state:l});return}this.emitter.emit(a.type,{action:a,state:this.store.getState()}),this.store.dispatch(a);let l=this.store.getState();this.emitter.emit(`after:${a.type}`,{action:a,state:l});return}}on(a,l){return this.emitter.on(a,l),()=>{this.emitter.off(a,l)}}serialize(a,l){return(0,x.B)(this.getState().iiif,a,l)}toPresentation2(a){return this.serialize(a,x.E)}toPresentation3(a){return this.serialize(a,x.F)}hydrate(a,l,o={}){return this.get(a,l,{...o,skipSelfReturn:!1})}get(a,l,o={}){"string"!=typeof l&&(o=l||{},l=void 0);let{skipSelfReturn:s=!0}=o||{},c=o.parent?"string"==typeof o.parent?o.parent:o.parent.id:void 0;if(Array.isArray(a))return a.map(a=>this.get(a,o));let d=this.getState();if((0,E.a)(a)&&!o.preserveSpecificResources&&(a=a.source),"string"==typeof a){let o=St(l||d.iiif.mapping[a]);if(!o)return s?null:{id:a,type:"unknown"};a={id:a,type:o}}if(a&&a.partOf&&!c&&!o.skipPartOfCheck){let l=Array.isArray(a.partOf)?a.partOf[0]:a.partOf;l&&("string"==typeof l&&(c=l),"string"==typeof l.id&&(c=l.id))}let f=St(l||(null==a?void 0:a.type)),v=null==a?void 0:a.id,y=d.iiif.entities[f];if(!y){let l=d.iiif.requests[v];return l&&l.resourceUri!==v?this.get(l.resourceUri,o):s?null:a}let b=y[a.id];if(b&&b[x.c]){let a=b[x.c].find(a=>c?a[x.d]===c:a[x.d]===b.id);return(0,x.j)(b,a)}return y[a.id]||(s?null:a)}select(a){return a(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(a,l){if(typeof a>"u")return this.get(l,{skipSelfReturn:!1});if("function"==typeof a)try{let o=a(this.get(l,{skipSelfReturn:!1})),i=a=>this.deep(a,o);return i.size=Array.isArray(o)?o.length:1,i}catch{let i=a=>this.deep(a,void 0);return i.size=0,i}let n=l=>this.deep(l,a);return n.size=Array.isArray(a)?a.length:1,n}loadManifest(a,l){let o="string"==typeof a?a:a.id;return this.load(o,l)}loadCollection(a,l){let o="string"==typeof a?a:a.id;return this.load(o,l)}load(a,l){let o="string"==typeof a?a:a.id;return l?Promise.resolve(this.staticFetcher(o,l)):Promise.resolve(this.remoteFetcher(o))}loadSync(a,l){let o="string"==typeof a?a:a.id;return this.staticFetcher(o,l)}loadManifestSync(a,l){let o="string"==typeof a?a:a.id;return this.loadSync(o,l)}loadCollectionSync(a,l){let o="string"==typeof a?a:a.id;return this.loadSync(o,l)}areInputsEqual(a,l){return yt(a,l)}subscribe(a,l,o){return typeof o>"u"&&(typeof l>"u"||!1===l||!0===l)&&(o=l,l=a,a=a=>a),this.store.subscribe(a,a=>l(a,this),{equalityFn:yt,fireImmediately:!o})}async ensureLoaded(a){let l="string"==typeof a?a:a.id;this.requestStatus(l)||await this.load(l)}requestStatus(a){return this.select(l=>l.iiif.requests[a])}getResourceMeta(a,l){let o=this.getState().iiif.meta[a];if(o)return l?o[l]:o}getObject(a,l,o={}){let{reactive:s,...c}=o;return ae(this.get(a,l,c),this,s)}async loadObject(a,l){return ae(await this.load(a,l),this)}async loadManifestObject(a,l){return ae(await this.loadManifest(a,l),this)}async loadCollectionObject(a,l){return ae(await this.loadCollection(a,l),this)}wrapObject(a){return ae(this.get(a,{skipSelfReturn:!1}),this)}isWrapped(a){return!!a[eG]}setMetaValue([a,l,o],s){this.dispatch("function"==typeof s?eB.setMetaValueDynamic({id:a,meta:l,key:o,updateValue:s}):eB.setMetaValue({id:a,meta:l,key:o,value:s}))}};let bo=a=>{let l=a.toString().split(":"),o=Math.ceil(parseInt(l[0])),s=Math.ceil(parseInt(l[1])),c=Eo(Math.ceil(parseInt(l[2])),2),d=`${0!==o&&s<10?(s+"").padStart(2,"0"):s}:${c}`;return 0!==o&&(d=`${o}:${d}`),d},hn=a=>{let l=new Date(1e3*a).toISOString().substr(11,8);return bo(l)},pn=(a,l)=>{if("object"!=typeof a||null===a)return l;for(let o in l)"object"!=typeof l[o]||null===l[o]||Array.isArray(l[o])?a[o]=l[o]:(a[o]||(a[o]={}),a[o]=pn(a[o],l[o]));return a},wo=a=>a.split("").reduce(function(a,l){return(a=(a<<5)-a+l.charCodeAt(0))&a},0),gn=(a,l)=>Object.hasOwn(a,l)?a[l].toString():void 0,Eo=(a,l)=>String(a).padStart(l,"0"),eX={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},crossOrigin:void 0,ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:{behavior:"smooth",block:"center"}}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1};function vn(a){let l={...eX.informationPanel.vtt.autoScroll};return"object"==typeof a&&(l="enabled"in a?a:{enabled:!0,settings:a}),!1===a&&(l.enabled=!1),function({behavior:a,block:l}){let o=["auto","instant","smooth"],s=["center","end","nearest","start"];if(!o.includes(a))throw TypeError(`'${a}' not in ${o.join(" | ")}`);if(!s.includes(l))throw TypeError(`'${l}' not in ${s.join(" | ")}`)}(l.settings),l}let eY=vn(null==(d=null==(c=null==eX?void 0:eX.informationPanel)?void 0:c.vtt)?void 0:d.autoScroll),eK={activeCanvas:"",activeManifest:"",activeSelector:void 0,OSDImageLoaded:!1,collection:{},configOptions:eX,customDisplays:[],plugins:[],isAutoScrollEnabled:eY.enabled,isAutoScrolling:!1,isInformationOpen:null==(f=null==eX?void 0:eX.informationPanel)?void 0:f.open,isLoaded:!1,isUserScrolling:void 0,sequence:[[],[]],vault:new eZ,openSeadragonViewer:null,viewerId:(0,S.Z)(),visibleCanvases:[],visibleAnnotations:[]},e0=w.createContext(eK),e1=w.createContext(eK);function Io(a,l){switch(l.type){case"updateActiveCanvas":return l.canvasId||(l.canvasId=""),{...a,activeCanvas:l.canvasId};case"updateActiveManifest":return{...a,activeManifest:l.manifestId};case"updateOSDImageLoaded":return{...a,OSDImageLoaded:l.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...a,isAutoScrollEnabled:l.isAutoScrollEnabled};case"updateAutoScrolling":return{...a,isAutoScrolling:l.isAutoScrolling};case"updateCollection":return{...a,collection:l.collection};case"updateConfigOptions":return{...a,configOptions:pn(a.configOptions,l.configOptions)};case"updateInformationOpen":return{...a,isInformationOpen:l.isInformationOpen};case"updateInformationPanelResource":return{...a,informationPanelResource:l.informationPanelResource};case"updateIsLoaded":return{...a,isLoaded:l.isLoaded};case"updateManifestSequence":return{...a,sequence:l.sequence};case"updateUserScrolling":return{...a,isUserScrolling:l.isUserScrolling};case"updateOpenSeadragonViewer":return{...a,openSeadragonViewer:l.openSeadragonViewer};case"updateViewerId":return{...a,viewerId:l.viewerId};case"updateActiveSelector":return{...a,activeSelector:l.selector};case"updateVisibleCanvases":return{...a,visibleCanvases:l.visibleCanvases};default:throw Error(`Unhandled action type: ${l.type}`)}}let Ao=({initialState:a=eK,children:l})=>{let[o,s]=(0,w.useReducer)(Io,a);return w.createElement(e0.Provider,{value:o},w.createElement(e1.Provider,{value:s},l))};function L(){let a=w.useContext(e0);if(void 0===a)throw Error("useViewerState must be used within a ViewerProvider");return a}function J(){let a=w.useContext(e1);if(void 0===a)throw Error("useViewerDispatch must be used within a ViewerProvider");return a}let Ro=async(a,l)=>{let o=a.get({id:l,type:"Canvas"});if(!(null!=o&&o.annotations)||!o.annotations[0])return[];let s=a.get(o.annotations).filter(a=>!!a.items&&a),c=[];for(let l of s)if(l.items.length>0){let a=l.label||{none:["Annotations"]};c.push({...l,label:a})}else{let o={};try{o=await a.load(l.id)}catch(a){console.log(a)}if(o.items&&o.items.length>0){let a=o.label||{none:["Annotations"]};c.push({...o,label:a})}}return c},wn=async(a,l,o)=>{try{if(null==o||null==o.q)return{};let s=o.q.trim(),c=new URL(l);return c.searchParams.set("q",s),await a.load(c.toString())}catch(a){return console.warn("Error in getContentSearchResources:",a),{}}},En=(a,l,o,s)=>{var c,d;let f={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]};if(f.canvas=a.get(l),f.canvas&&(f.annotationPage=a.get(f.canvas.items[0]),f.accompanyingCanvas=null!=(c=f.canvas)&&c.accompanyingCanvas?a.get(null==(d=f.canvas)?void 0:d.accompanyingCanvas):void 0),f.annotationPage){let c=a.get(f.annotationPage.items).map(l=>({body:a.get(l.body[0].id),motivation:l.motivation,type:"Annotation"})),d=[];c.forEach(l=>{"Choice"===l.body.type?l.body.items.forEach(o=>d.push({...l,id:o.id,body:a.get(o.id)})):d.push(l)}),f.annotations=d.filter(c=>{if(c){if(!c.body||!c.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",c);return}let d=c.body;Array.isArray(d)&&(d=d[0]);let f=a.get(d.id);if(f)switch(o){case"painting":return c.target===l.id&&c.motivation&&"painting"===c.motivation[0]&&s.includes(f.type)&&(c.body=f),!!c;case"supplementing":return;default:throw Error("Invalid annotation motivation.")}}})}return f},ut=(a,l="en")=>{if(!a)return"";if(!a[l]){let l=Object.getOwnPropertyNames(a);if(l.length>0)return a[l[0]]}return a[l]},ce=(a,l)=>{let o=En(a,{id:l,type:"Canvas"},"painting",["Image","Sound","Video"]);if(0!==o.annotations.length&&o.annotations&&o.annotations)return o.annotations.map(a=>null==a?void 0:a.body)},e2={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:e3,css:e4,keyframes:e5,createTheme:e6}=(0,O.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(209 100% 38.2%)",accentMuted:"hsl(209 80% 61.8%)",accentAlt:"hsl(209 80% 30%)",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 200ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:e2}),e8=e3("div",{display:"flex",flexDirection:"column",alignItems:"center"}),e7=e3("p",{fontWeight:"bold",fontSize:"x-large"}),e9=e3("span",{fontSize:"medium"}),mt=({error:a})=>{let{message:l}=a;return w.createElement(e8,{role:"alert"},w.createElement(e7,{"data-testid":"headline"},"Something went wrong"),l&&w.createElement(e9,null,`Error message: ${l}`," "))},te=e3("div",{position:"relative",zIndex:"0"}),tt=e3("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden"}),ti=e3("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"100%",height:"100%","&[data-aside-active='true']":{width:"61.8%","@sm":{width:"0",opacity:"0"}},"&[data-aside-toggle='false']":{"@sm":{width:"100% !important",opacity:"1 !important"}}}),tn=e3("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"0",maxHeight:"100%","&[data-aside-active='true']":{width:"38.2%","@sm":{width:"100%"}},"&[data-aside-toggle='false']":{"@sm":{width:"0 !important"}}}),tr=e3("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${tt}`]:{flexGrow:"1"},[`& ${ti}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{}}}),tl=e3(M.fC,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% -  2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),ts=e3(M.aV,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"5px solid #6663","@sm":{margin:"0 1rem"}}),td=e3(M.xz,{display:"flex",position:"relative",padding:"0.5rem 1.618rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&[data-value='manifest-back']":{display:"none;","@sm":{display:"block"}},"&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),tu=e3(M.VY,{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),tm=e3(({handleScroll:a,children:l,className:o})=>w.createElement("div",{className:o,onScroll:a},l),{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),th={position:"relative",display:"flex",margin:"0 1.618rem",padding:"0.5rem 0",fontFamily:"inherit",fontSize:"0.8333rem",lineHeight:"1.47rem",color:"inherit",background:"none",borderRadius:"3px"},tp=e3("button",{textAlign:"left","&:hover":{color:"$accent"}}),tf=e3("div",{display:"flex",flexDirection:"column",width:"100%",header:{margin:"0 1.618rem 0.5rem ",fontWeight:700,fontSize:"0.8333rem"},paddingBottom:"1rem",marginBottom:"1rem",borderBottom:"1px solid #0001"}),tg=e3("div",{gap:"1rem",fontSize:"1rem",lineHeight:"1.47em",margin:"0","&[data-content-search=true]":{em:{fontWeight:700,display:"inline"}}}),tv=e3("div",{...th,display:"flex",flexDirection:"row",gap:"1rem","&[data-format='text/vtt']":{marginTop:"-1rem","> span":{display:"none"}},"> span":{display:"flex",width:"2rem",height:"2rem",backgroundColor:"#0001",flexShrink:"0",borderRadius:"3px",marginTop:"0.25rem"},[`&[dir=rtl] ${tg}`]:{textAlign:"right !important"}}),Ho=({value:a,handleClick:l})=>w.createElement(tp,{onClick:l},w.createElement(tg,{dangerouslySetInnerHTML:{__html:a}})),Vo=({caption:a,handleClick:l,imageUri:o})=>w.createElement(tp,{onClick:l},w.createElement("img",{src:o,alt:`A visual annotation for ${a}`}),w.createElement("span",null,a)),Wo=({value:a,handleClick:l})=>{let o=(0,P.Z)(a);return w.createElement(tp,{onClick:l},w.createElement(tg,{dangerouslySetInnerHTML:{__html:o.html}}))},Ct=({value:a,handleClick:l,isContentSearch:o})=>w.createElement(tp,{onClick:l},w.createElement(tg,{dangerouslySetInnerHTML:{__html:a},"data-content-search":o})),No=()=>{function e(a){return a.map(a=>{let l=a.identifier||(0,S.Z)();return{...a,identifier:l}})}return{addIdentifiersToParsedCues:e,createNestedCues:function(a){var l;let o=[],s=[],c=e(a);for(let a of c){for(;s.length>0&&s[s.length-1].end<=a.start;)s.pop();s.length>0?(s[s.length-1].children||(s[s.length-1].children=[]),null==(l=s[s.length-1].children)||l.push(a)):o.push(a),s.push(a)}return o},isChild:function(a,l=[]){return l.some(l=>a.start>=l.start&&a.end<=l.end)},orderCuesByTime:function(a=[]){return a.sort((a,l)=>a.start-l.start)}}},ty=e3(F.fC,{display:"flex",flexDirection:"column",width:"100%"}),tb=e3(F.ck,{...th,justifyContent:"space-between",textAlign:"left",flexGrow:1,margin:0,padding:"0.618rem 1rem",width:"100%",fontSize:"1rem",strong:{marginLeft:"1rem"},"&:hover":{color:"$accent"},"&[aria-checked='true']":{background:"#6662"}}),qo=a=>{for(;a&&a!==document.body;){let l=window.getComputedStyle(a).overflowY;if("visible"!==l&&"hidden"!==l&&a.scrollHeight>a.clientHeight)return a;a=a.parentNode}return null},Go=({label:a,start:l,end:o})=>{var s,c;let d=J(),{configOptions:f,isAutoScrollEnabled:v,isUserScrolling:y}=L(),b=null==(c=null==(s=null==f?void 0:f.informationPanel)?void 0:s.vtt)?void 0:c.autoScroll,[x,E]=(0,w.useState)(!1),S=(0,w.useRef)(null),k=document.getElementById("clover-iiif-video");return(0,w.useEffect)(()=>(null==k||k.addEventListener("timeupdate",()=>{let{currentTime:a}=k;E(l<=a&&a<o)}),()=>document.removeEventListener("timeupdate",()=>{})),[o,l,k]),(0,w.useEffect)(()=>{var a,l;if(v&&x&&S.current&&!y){let o=S.current;if(o&&o instanceof HTMLElement){let s=qo(o);if(s&&s instanceof HTMLElement){let c;switch(null==(a=null==b?void 0:b.settings)?void 0:a.block){case"center":let f=s.getBoundingClientRect();c=o.offsetTop+o.offsetHeight-Math.floor((f.bottom-f.top)/2);break;case"end":c=o.offsetTop+o.offsetHeight-(s.clientHeight-o.clientHeight)+2;break;default:c=o.offsetTop-2}d({type:"updateAutoScrolling",isAutoScrolling:!0}),s.scrollTo({top:c,left:0,behavior:null==(l=null==b?void 0:b.settings)?void 0:l.behavior}),setTimeout(()=>d({type:"updateAutoScrolling",isAutoScrolling:!1}),750)}}}},[b,x,y,v,d]),w.createElement(tb,{ref:S,"aria-checked":x,"data-testid":"information-panel-cue",onClick:()=>{k&&(k.pause(),k.currentTime=l,k.play())},value:a},a,w.createElement("strong",null,hn(l)))},tw=e3("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${tb}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),Tn=({items:a})=>w.createElement(tw,null,a.map(a=>{let{text:l,start:o,end:s,children:c,identifier:d}=a;return w.createElement("li",{key:d},w.createElement(Go,{label:l,start:o,end:s}),c&&w.createElement(Tn,{items:c}))})),Jo=({label:a,vttUri:l})=>{let[o,s]=w.useState([]),{createNestedCues:c,orderCuesByTime:d}=No(),[f,v]=w.useState();return(0,w.useEffect)(()=>{l&&fetch(l,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(a=>a.text()).then(a=>{let l=(0,z.parse)(a).cues,o=d(l),f=c(o);s(f)}).catch(a=>{console.error(l,a.toString()),v(a)})},[l]),w.createElement(ty,{"data-testid":"annotation-item-vtt","aria-label":`${ut(a)}`},f&&w.createElement("div",{"data-testid":"error-message"},"Network Error: ",f.toString()),w.createElement(Tn,{items:o}))},Yo=a=>{let l=a.split("-")[0];return["ar","fa","ur","ps","dv","sd","ug","ku","he","yi","jrb","jpr","nqo"].includes(l)?"RTL":"LTR"},Xo=a=>{var l,o,s,c,d;let f={id:"string"==typeof a?a:a.source};if("string"==typeof a){if(a.includes("#xywh=")){let l=a.split("#xywh=");if(l&&l[1]){let[a,o,s,c]=l[1].split(",").map(a=>Number(a));f={id:l[0],rect:{x:a,y:o,w:s,h:c}}}}else if(a.includes("#t=")){let l=a.split("#t=");l&&l[1]&&(f={id:l[0],t:l[1]})}}else if("object"==typeof a){if((null==(l=a.selector)?void 0:l.type)==="PointSelector")f={id:a.source,point:{x:a.selector.x,y:a.selector.y}};else if((null==(o=a.selector)?void 0:o.type)==="SvgSelector")f={id:a.source,svg:a.selector.value};else if((null==(s=a.selector)?void 0:s.type)==="FragmentSelector"&&null!=(c=a.selector)&&c.value.includes("xywh=")&&"Canvas"==a.source.type&&a.source.id){let l=null==(d=a.selector)?void 0:d.value.split("xywh=");if(l&&l[1]){let[o,s,c,d]=l[1].split(",").map(a=>Number(a));f={id:a.source.id,rect:{x:o,y:s,w:c,h:d}}}}}return f},$n=({annotation:a,targetResource:l,isContentSearch:o})=>{var s,c;let{target:d}=a,f=(null==(c=null==(s=null==d?void 0:d.selector)?void 0:s.value)?void 0:c.split("=")[1])||"full",[v,y]="full"!==f?null==f?void 0:f.split(",").slice(2):[100,100],b=`${l}/${f}/!${((a,l)=>{let o=Math.max(a,l);return[Math.round(a/o*100),Math.round(l/o*100)].join(",")})(v,y)}/0/default.jpg`,x=L(),E=J(),{openSeadragonViewer:S,vault:k,visibleCanvases:I}=x,R=a.body.map(a=>k.get(a.id)),{format:T,language:O="en",value:M="",chars:P=""}=R[0],F=M||P,z=Yo(O).toLocaleLowerCase();function $(l){var o;l.preventDefault(),l.stopPropagation();let s=null==(o=null==a?void 0:a.target)?void 0:o.source.id;I.map(a=>a.id).includes(s)?function(){var l;let o=null==S?void 0:S.getOverlayById(a.id);if(o&&null!=S&&S.viewport){null!=o&&o.element&&(null==(l=o.element)||l.focus());let a=null==o?void 0:o.getBounds(S.viewport);a.x-=.2,a.y-=.2,a.width+=.5,a.height+=.5,S.viewport.fitBounds(a,!1)}}():E({type:"updateActiveCanvas",canvasId:s})}return w.createElement(tv,{dir:z,"data-format":T},w.createElement("span",{style:{backgroundImage:`url(${b})`,backgroundSize:"cover",backgroundPosition:"center"}}),function(){var a,l;switch(T){case"text/plain":return w.createElement(Ct,{value:F,handleClick:$,isContentSearch:o});case"text/html":return w.createElement(Ho,{value:F,handleClick:$});case"text/markdown":return w.createElement(Wo,{value:F,handleClick:$});case"text/vtt":return w.createElement(Jo,{label:R[0].label,vttUri:R[0].id||""});case null==(a=null==T?void 0:T.match(/^image\//))?void 0:a.input:let s=(null==(l=R.find(a=>{var l;return!(null!=(l=a.id)&&l.includes("vault://"))}))?void 0:l.id)||"";return w.createElement(Vo,{caption:M,handleClick:$,imageUri:s});default:return w.createElement(Ct,{value:F,handleClick:$})}}())},Mn=(a,l="none")=>{if(!a)return null;if("string"==typeof a)return[a];if(!a[l]){let l=Object.getOwnPropertyNames(a);if(l.length>0)return a[l[0]]}return a[l]&&Array.isArray(a[l])?a[l]:null},q=(a,l="none",o=", ")=>{let s=Mn(a,l);return Array.isArray(s)?s.join(`${o}`):s};function X(a,l){let o=Object.keys(a).filter(a=>l.includes(a)?null:a),s={};return o.forEach(l=>{s[l]=a[l]}),s}let tx=e3("span",{}),ne=a=>{let{as:l,label:o}=a,s=X(a,["as","label"]);return w.createElement(tx,{as:l,...s},q(o,s.lang))},ta=(a,l="200,",o="full")=>{let s;Array.isArray(a)&&(a=a[0]);let{id:c,service:d}=a;if(!d)return c;if(Array.isArray(a.service)&&a.service.length>0&&(s=d[0]),s){if(s["@id"])return`${s["@id"]}/${o}/${l}/0/default.jpg`;if(s.id)return`${s.id}/${o}/${l}/0/default.jpg`}},tE=e3("img",{objectFit:"cover"}),na=a=>{let l;let o=(0,w.useRef)(null),{contentResource:s,altAsLabel:c,region:d="full"}=a;c&&(l=q(c));let f=X(a,["contentResource","altAsLabel"]),{type:v,id:y,width:b=200,height:x=200,duration:E}=s;(0,w.useEffect)(()=>{if(!y&&!o.current||["Image"].includes(v)||!y.includes("m3u8"))return;let a=new B.ZP;return o.current&&(a.attachMedia(o.current),a.on(B.ZP.Events.MEDIA_ATTACHED,function(){a.loadSource(y)})),a.on(B.ZP.Events.ERROR,function(l,o){if(o.fatal)switch(o.type){case B.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${l} network error encountered, try to recover`),a.startLoad();break;case B.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${l} media error encountered, try to recover`),a.recoverMediaError();break;default:a.destroy()}}),()=>{a&&(a.detachMedia(),a.destroy())}},[y,v]);let S=(0,w.useCallback)(()=>{if(!o.current)return;let a=0,l=30;if(E&&(l=E),!y.split("#t=")&&E&&(a=.1*E),y.split("#t=").pop()){let l=y.split("#t=").pop();l&&(a=parseInt(l.split(",")[0]))}let s=o.current;s.autoplay=!0,s.currentTime=a,setTimeout(()=>S(),1e3*l)},[E,y]);(0,w.useEffect)(()=>S(),[S]);let k=ta(s,`${b},${x}`,d);switch(v){case"Image":return w.createElement(tE,{as:"img",alt:l,css:{width:b,height:x},key:y,src:k,...f});case"Video":return w.createElement(tE,{as:"video",css:{width:b,height:x},disablePictureInPicture:!0,key:y,loop:!0,muted:!0,onPause:S,ref:o,src:y});default:return console.warn(`Resource type: ${v} is not valid or not yet supported in Primitives.`),w.createElement(w.Fragment,null)}},tS=e3("a",{}),ia=a=>{let{children:l,homepage:o}=a,s=X(a,["children","homepage"]);return w.createElement(w.Fragment,null,o&&o.map(a=>{let o=q(a.label,s.lang);return w.createElement(tS,{"aria-label":l?o:void 0,href:a.id,key:a.id,...s},l||o)}))},tC={delimiter:", "},tk=(0,w.createContext)(void 0),On=()=>{let a=(0,w.useContext)(tk);if(void 0===a)throw Error("usePrimitivesContext must be used with a PrimitivesProvider");return a},ht=({children:a,initialState:l=tC})=>{let o=aa(l,"delimiter");return w.createElement(tk.Provider,{value:{delimiter:o}},a)},aa=(a,l)=>Object.hasOwn(a,l)?a[l].toString():void 0,tI=e3("span",{}),At=a=>{let{as:l,markup:o}=a,{delimiter:s}=On();if(!o)return w.createElement(w.Fragment,null);let c=X(a,["as","markup"]),d={__html:_(q(o,c.lang,s),{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})};return w.createElement(tI,{as:l,...c,dangerouslySetInnerHTML:d})},Pn=a=>w.useContext(tk)?w.createElement(At,{...a}):w.createElement(ht,null,w.createElement(At,{...a})),la=({as:a="dd",lang:l,value:o})=>w.createElement(Pn,{markup:o,as:a,lang:l}),tA=e3("span",{}),da=({as:a="dd",customValueContent:l,lang:o,value:s})=>{var c;let{delimiter:d}=On(),f=null==(c=Mn(s,o))?void 0:c.map(a=>(0,w.cloneElement)(l,{value:a}));return w.createElement(tA,{as:a,lang:o},null==f?void 0:f.map((a,l)=>[l>0&&`${d}`,w.createElement(w.Fragment,{key:l},a)]))},Fn=a=>{var l;let{item:o,lang:s,customValueContent:c}=a,{label:d,value:f}=o,v=null==(l=q(d))?void 0:l.replace(" ","-").toLowerCase();return w.createElement("div",{role:"group","data-label":v},w.createElement(ne,{as:"dt",label:d,lang:s}),c?w.createElement(da,{as:"dd",customValueContent:c,value:f,lang:s}):w.createElement(la,{as:"dd",value:f,lang:s}))},tR=e3("dl",{}),fa=a=>{let{as:l,customValueContent:o,metadata:s}=a;if(!Array.isArray(s))return w.createElement(w.Fragment,null);let c=gn(a,"customValueDelimiter"),d=X(a,["as","customValueContent","customValueDelimiter","metadata"]);return w.createElement(ht,{..."string"==typeof c?{initialState:{delimiter:c}}:void 0},s.length>0&&w.createElement(tR,{as:l,...d},s.map((a,l)=>{let s=o?function(a,l){let o=l.filter(l=>{let{matchingLabel:o}=l,s=Object.keys(l.matchingLabel)[0],c=q(o,s);if(q(a,s)===c)return!0}).map(a=>a.Content);if(Array.isArray(o))return o[0]}(a.label,o):void 0;return w.createElement(Fn,{customValueContent:s,item:a,key:l,lang:null==d?void 0:d.lang})})))};e3("li",{}),e3("ul",{});let t$=e3("li",{}),tT=e3("ul",{}),ga=a=>{let{as:l,rendering:o}=a,s=X(a,["as","rendering"]);return w.createElement(tT,{as:l},o&&o.map(a=>{let l=q(a.label,s.lang);return w.createElement(t$,{key:a.id},w.createElement("a",{href:a.id,...s,target:"_blank"},l||a.id))}))},tO=e3("dl",{}),ya=a=>{let{as:l,requiredStatement:o}=a;if(!o)return w.createElement(w.Fragment,null);let s=gn(a,"customValueDelimiter"),c=X(a,["as","customValueDelimiter","requiredStatement"]);return w.createElement(ht,{..."string"==typeof s?{initialState:{delimiter:s}}:void 0},w.createElement(tO,{as:l,...c},w.createElement(Fn,{item:o,lang:c.lang})))},tM=e3("li",{}),tL=e3("ul",{}),Ea=a=>{let{as:l,seeAlso:o}=a,s=X(a,["as","seeAlso"]);return w.createElement(tL,{as:l},o&&o.map(a=>{let l=q(a.label,s.lang);return w.createElement(tM,{key:a.id},w.createElement("a",{href:a.id,...s},l||a.id))}))},xa=a=>{let{as:l,summary:o}=a,s=X(a,["as","customValueDelimiter","summary"]);return w.createElement(Pn,{as:l,markup:o,...s})},_n=a=>{let{thumbnail:l,region:o}=a,s=X(a,["thumbnail"]);return w.createElement(w.Fragment,null,l&&l.map(a=>w.createElement(na,{contentResource:a,key:a.id,region:o,...s})))},Sa=({annotationPage:a})=>{var l,o,s,c,d,f;let v=L(),{vault:y}=v;if(!a||!a.items||(null==(l=a.items)?void 0:l.length)===0)return w.createElement(w.Fragment,null);let b=a.items.map(a=>y.get(a.id));if(!b)return w.createElement(w.Fragment,null);let x=b.reduce((a,l)=>(a.canvas=l.target.source.id,a.annotations=[],a.annotations.push(null==l?void 0:l.id),a),{}),E=y.get(x.canvas),S=ce(y,E.id),k=null!=(o=null==S?void 0:S[0])&&o.service?(null==(c=null==(s=null==S?void 0:S[0])?void 0:s.service[0])?void 0:c.id)||(null==(f=null==(d=null==S?void 0:S[0])?void 0:d.service[0])?void 0:f["@id"]):void 0;return w.createElement(tf,{"data-testid":"annotation-page"},E&&w.createElement("header",null,w.createElement(ne,{label:E.label})),w.createElement("div",{"data-testid":"annotation-page-items"},null==b?void 0:b.map(a=>w.createElement($n,{annotation:a,targetResource:k,key:a.id}))))},tP=e3("div",{form:{display:"flex",alignItems:"center",width:"100%",height:"100%",gap:"1rem",padding:"0 1.618rem 1.618rem",".content-search-input":{flexGrow:"1",input:{width:"100%",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"1rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"#0006"}}}}}),tF=e3("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Aa=({searchServiceUrl:a,setContentSearchResource:l,setLoading:o})=>{let{t:s}=(0,b.$G)(),[c,d]=(0,w.useState)(),f=L(),{openSeadragonViewer:v,vault:y}=f;async function m(s){if(s.preventDefault(),v&&a){if(!c||""===c.trim()){l({});return}o(!0),wn(y,a,{q:c}).then(a=>{l(a),o(!1)})}}let x=s("contentSearchPlaceholder");return w.createElement(tP,null,w.createElement(H.fC,{onSubmit:m,className:"content-search-form"},w.createElement(H.gN,{className:"content-search-input",name:"searchTerms",onChange:a=>{a.preventDefault(),d(a.target.value)}},w.createElement(H.oT,{placeholder:x})),w.createElement(H.k4,{asChild:!0},w.createElement(tF,{type:"submit"},w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w.createElement("title",null,s("informationPanelTabsSearch")),w.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},Ra=({searchServiceUrl:a,setContentSearchResource:l,activeCanvas:o,annotationPage:s})=>{let c;let d=L(),{vault:f}=d,{t:v}=(0,b.$G)(),[y,x]=(0,w.useState)(!1),[E,S]=(0,w.useState)({});return(0,w.useEffect)(()=>{var a;if(!(null!=s&&s.items))return;let l=(null==(a=null==s?void 0:s.items)?void 0:a.map(a=>f.get(a.id))).reduce((a,l)=>{let o=l.target.source.id;return a[o]||(a[o]=[]),a[o].push(l.id),a},{});S(l)},[s]),w.createElement(w.Fragment,null,w.createElement(Aa,{searchServiceUrl:a,setContentSearchResource:l,activeCanvas:o,setLoading:x}),y?w.createElement("span",null,v("contentSearchLoading")):E&&Object.keys(E).length>0&&Object.keys(E).map(a=>(c=f.get(a),w.createElement(tf,{key:a,"data-testid":"annotation-page"},c&&w.createElement("header",null,w.createElement(ne,{label:c.label})),E[a].map(a=>{var l,o,s,d,v;let y=f.get(a),b=ce(f,c.id),x=null!=(l=null==b?void 0:b[0])&&l.service?(null==(s=null==(o=null==b?void 0:b[0])?void 0:o.service[0])?void 0:s.id)||(null==(v=null==(d=null==b?void 0:b[0])?void 0:d.service[0])?void 0:v["@id"]):void 0;return w.createElement($n,{annotation:y,targetResource:x,key:y.id,isContentSearch:!0})})))))},tz=e3("div",{width:"100%",padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"auto",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.47em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),tj=e3("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),$a=({homepage:a})=>(null==a?void 0:a.length)===0?w.createElement(w.Fragment,null):w.createElement(w.Fragment,null,w.createElement("span",{className:"manifest-property-title"},"Homepage"),w.createElement(ia,{homepage:a})),Ma=({id:a,htmlLabel:l,parent:o="manifest"})=>w.createElement(w.Fragment,null,w.createElement("span",{className:"manifest-property-title"},l),w.createElement("a",{href:a,target:"_blank",id:`iiif-${o}-id`},a)),Oa=({metadata:a,parent:l="manifest"})=>a?w.createElement(w.Fragment,null,w.createElement(fa,{metadata:a,id:`iiif-${l}-metadata`})):w.createElement(w.Fragment,null),Pa=({rendering:a})=>(null==a?void 0:a.length)===0?w.createElement(w.Fragment,null):w.createElement(w.Fragment,null,w.createElement("span",{className:"manifest-property-title"},"Alternate formats"),w.createElement(ga,{rendering:a})),Fa=({requiredStatement:a,parent:l="manifest"})=>a?w.createElement(w.Fragment,null,w.createElement(ya,{requiredStatement:a,id:`iiif-${l}-required-statement`})):w.createElement(w.Fragment,null),_a=({rights:a})=>a?w.createElement(w.Fragment,null,w.createElement("span",{className:"manifest-property-title"},"Rights"),w.createElement("a",{href:a,target:"_blank"},a)):w.createElement(w.Fragment,null),za=({seeAlso:a})=>(null==a?void 0:a.length)===0?w.createElement(w.Fragment,null):w.createElement(w.Fragment,null,w.createElement("span",{className:"manifest-property-title"},"See Also"),w.createElement(Ea,{seeAlso:a})),La=({summary:a,parent:l="manifest"})=>a?w.createElement(w.Fragment,null,w.createElement(xa,{summary:a,as:"p",id:`iiif-${l}-summary`})):w.createElement(w.Fragment,null),Da=({label:a,thumbnail:l})=>(null==l?void 0:l.length)===0?w.createElement(w.Fragment,null):w.createElement(w.Fragment,null,w.createElement(_n,{altAsLabel:a||{none:["resource"]},thumbnail:l,style:{backgroundColor:"#6663",objectFit:"cover"}})),Ba=()=>{let a=L(),{activeManifest:l,vault:o}=a,[s,c]=(0,w.useState)(),[d,f]=(0,w.useState)([]),[v,y]=(0,w.useState)([]),[b,x]=(0,w.useState)([]),[E,S]=(0,w.useState)([]);return(0,w.useEffect)(()=>{var a,s,d,v;let b=o.get(l);c(b),(null==(a=b.homepage)?void 0:a.length)>0&&f(o.get(b.homepage)),(null==(s=b.seeAlso)?void 0:s.length)>0&&y(o.get(b.seeAlso)),(null==(d=b.rendering)?void 0:d.length)>0&&x(o.get(b.rendering)),(null==(v=b.thumbnail)?void 0:v.length)>0&&S(o.get(b.thumbnail))},[l,o]),s?w.createElement(tj,null,w.createElement(tz,null,w.createElement(Da,{thumbnail:E,label:s.label}),w.createElement(La,{summary:s.summary}),w.createElement(Oa,{metadata:s.metadata}),w.createElement(Fa,{requiredStatement:s.requiredStatement}),w.createElement(_a,{rights:s.rights}),w.createElement($a,{homepage:d}),w.createElement(za,{seeAlso:v}),w.createElement(Pa,{rendering:b}),w.createElement(Ma,{id:s.id,htmlLabel:"IIIF Manifest"}))):w.createElement(w.Fragment,null)},Wa=({activeCanvas:a,annotationResources:l,searchServiceUrl:o,setContentSearchResource:s,contentSearchResource:c})=>{let{t:d}=(0,b.$G)(),f=J(),v=L(),{informationPanelResource:y,isAutoScrolling:x,isUserScrolling:E,vault:S,configOptions:k,plugins:I}=v,{informationPanel:R}=k,O=null==R?void 0:R.renderAbout,M=null==R?void 0:R.renderAnnotation,P=S.get({id:a,type:"Canvas"}),F=null==R?void 0:R.renderContentSearch,z=null==R?void 0:R.renderToggle,_=!!(null!=l&&l.length),{pluginsWithInfoPanel:B}=function(a){let l=[];return a.forEach(a=>{var o;null!=(o=a.informationPanel)&&o.component&&l.push(a)}),{pluginsWithInfoPanel:l}}(I);return(0,w.useEffect)(()=>{["manifest-about","manifest-annotations","manifest-content-search"].includes(String(null==R?void 0:R.defaultTab))?f({type:"updateInformationPanelResource",informationPanelResource:null==R?void 0:R.defaultTab}):f({type:"updateInformationPanelResource",informationPanelResource:"manifest-about"})},[]),w.createElement(tl,{"data-testid":"information-panel",defaultValue:y,onValueChange:a=>{f({type:"updateInformationPanelResource",informationPanelResource:a})},orientation:"horizontal",value:y,className:"clover-viewer-information-panel"},w.createElement(ts,{"aria-label":d("informationPanelTabs"),"data-testid":"information-panel-list"},z&&w.createElement(td,{value:"manifest-back","data-value":"manifest-back",onClick:()=>{f({type:"updateInformationOpen",isInformationOpen:!1})},as:"button"},d("informationPanelTabsClose")),O&&w.createElement(td,{value:"manifest-about"},d("informationPanelTabsAbout")),F&&c&&w.createElement(td,{value:"manifest-content-search"},d("informationPanelTabsSearch")),M&&_&&w.createElement(td,{value:"manifest-annotations"},d("informationPanelTabsAnnotations")),B&&B.map((a,l)=>{var o;return w.createElement(td,{key:l,value:a.id},w.createElement(ne,{label:null==(o=a.informationPanel)?void 0:o.label}))})),w.createElement(tm,{handleScroll:function(){if(!x){clearTimeout(E);let a=setTimeout(()=>{f({type:"updateUserScrolling",isUserScrolling:void 0})},1500);f({type:"updateUserScrolling",isUserScrolling:a})}}},O&&w.createElement(tu,{value:"manifest-about"},w.createElement(Ba,null)),F&&c&&w.createElement(tu,{value:"manifest-content-search"},w.createElement(Ra,{searchServiceUrl:o,setContentSearchResource:s,activeCanvas:a,annotationPage:c})),M&&l&&w.createElement(tu,{value:"manifest-annotations"},l.map(a=>w.createElement(Sa,{key:a.id,annotationPage:a}))),B&&B.map((a,l)=>(function(a,l){var o,s;let c=null==(o=null==a?void 0:a.informationPanel)?void 0:o.component;return void 0===c?w.createElement(w.Fragment,null):w.createElement(tu,{key:l,value:a.id},w.createElement(T.ErrorBoundary,{FallbackComponent:mt},w.createElement(c,{...null==(s=null==a?void 0:a.informationPanel)?void 0:s.componentProps,canvas:P,useViewerDispatch:J,useViewerState:L})))})(a,l))))},t_=e3("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),N=a=>w.createElement(t_,{...a,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},a.children);N.Title=({children:a})=>w.createElement("title",null,a),N.Add=()=>w.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),N.Audio=()=>w.createElement(w.Fragment,null,w.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),w.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),w.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),N.Close=()=>w.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),N.Download=()=>w.createElement(w.Fragment,null,w.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),w.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),N.Image=()=>w.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),N.Video=()=>w.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"});let tD=e5({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),tV=e5({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),tB=e3(W.Eh,{fill:"$secondaryAlt"}),tH=e3(W.x8,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),tN=e3(W.VY,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:tV},'&[data-side="bottom"]':{animationName:tD},'&[data-align="end"]':{[`& ${tB}`]:{margin:"0 0.7rem"}}}),tW=e3(W.xz,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),tq=e3(W.fC,{boxSizing:"content-box"}),de=({children:a})=>w.createElement(tq,null,a);de.Trigger=a=>w.createElement(tW,{...a},a.children),de.Content=a=>w.createElement(tN,{...a,sideOffset:5,collisionPadding:21},w.createElement(tB,null),w.createElement(tH,null,w.createElement(N,{isSmall:!0},w.createElement(N.Close,null))),a.children);let tU=e3("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"2px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${t_}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),tJ=e3("span",{background:"transparent",opacity:"0",border:"3px solid transparent",position:"absolute",width:"100%",height:"100%",zIndex:"0",left:"0",top:"0",transition:"$all"}),tG=e3("span",{display:"flex"}),tQ=e3("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),tZ=e3("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),tX=e3("div",{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",".media-thumbnail-lazyload":{width:"100%",height:"100%",borderRadius:"3px"},img:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"top center",filter:"blur(0)",transform:"scale3d(1, 1, 1)",borderRadius:"3px",transition:"$all",color:"transparent"},[`& ${tG}`]:{position:"absolute",right:"0",bottom:"0",[`& ${tU}`]:{display:"none",margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}),tY=e3(F.ck,{display:"flex",flexShrink:"0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left",figure:{margin:"0",width:"161.8px",figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}}}),tK=e3(F.fC,{display:"flex",flexDirection:"row",flexGrow:"1",overflowX:"scroll",position:"relative",zIndex:"0",gap:"1rem",padding:"1.618rem 0"}),t0=e3("div",{display:"flex",flexDirection:"row","&[data-active='true']":{[`& ${tY}`]:{figcaption:{fontWeight:"700"},[`& ${tU}`]:{backgroundColor:"$accent"},[`& ${tJ}`]:{background:"#0003",opacity:"1",borderBottom:"3px solid $accent"},"&:first-of-type":{[`& ${tJ}`]:{borderRight:"unset"}},"&:last-of-type":{[`& ${tJ}`]:{borderLeft:"unset"}}}},[`& ${tY}`]:{[`& ${tX}`]:{borderRadius:"unset"},"&:first-of-type":{[`& ${tX}`]:{borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"}},"&:last-of-type":{[`& ${tX}`]:{borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},[`& ${tU}`]:{display:"flex"}}}}),t1=e3("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),t2=e3("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"$primaryMuted"}}),t3=e3("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),t4=e3("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem",fontWeight:"bold",gap:"0.25rem",em:{opacity:"0.25"}}}),t5=e3("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${t1}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),us=(a,l)=>{(0,w.useEffect)(()=>{function n(o){o.key===a&&l()}return window.addEventListener("keyup",n),()=>window.removeEventListener("keyup",n)},[])},ms=({title:a})=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w.createElement("title",null,a),w.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),fs=({title:a})=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w.createElement("title",null,a),w.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),hs=({title:a})=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w.createElement("title",null,a),w.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),ps=({title:a})=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w.createElement("title",null,a),w.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),gs=({handleCanvasToggle:a,handleFilter:l,activeIndex:o,canvasLength:s})=>{let[c,d]=(0,w.useState)(!1),[f,v]=(0,w.useState)(!1),[y,x]=(0,w.useState)(!1),{t:E}=(0,b.$G)();return(0,w.useEffect)(()=>{x(0===o),o===s-1?v(!0):v(!1)},[o,s]),us("Escape",()=>{d(!1),l("")}),w.createElement(t5,{isToggle:c},w.createElement(t1,null,c&&w.createElement(t2,{autoFocus:!0,onChange:a=>l(a.target.value),placeholder:E("commonSearchPlaceholder")}),!c&&w.createElement(t4,null,w.createElement(t3,{onClick:()=>a(-1),disabled:y,type:"button"},w.createElement(ms,{title:E("commonPrevious")})),w.createElement("span",null,o+1," ",w.createElement("em",null,"/")," ",s),w.createElement(t3,{onClick:()=>a(1),disabled:f,type:"button"},w.createElement(fs,{title:E("commonNext")}))),w.createElement(t3,{onClick:()=>{d(a=>!a),l("")},type:"button",className:"clover-viewer-media-search"},c?w.createElement(hs,{title:E("commonClose")}):w.createElement(ps,{title:E("commonSearch")}))))},vs=({children:a,rootMargin:l="100px",attributes:o={},isVisibleCallback:s=()=>{}})=>{let c=(0,w.useRef)(null),[d,f]=(0,w.useState)(!1);return(0,w.useEffect)(()=>{let a=c.current;if(!a)return;let o=new IntersectionObserver(([a])=>{a.isIntersecting&&(s(!0),f(!0),o.disconnect())},{rootMargin:l});return o.observe(a),()=>o.disconnect()},[c]),w.createElement("div",{ref:c,...o},d?a:null)};var t6={},t8={get:a=>a,setMetaValue([a,l,o],s){let c=t8.getResourceMeta(a,l),d=c?c[o]:void 0,f="function"==typeof s?s(d):s;t6[a]={...t6[a]||{},[l]:{...(t6[a]||{})[l]||{},[o]:f}}},getResourceMeta:(a,l)=>{let o=t6[a];if(o)return l?o[l]:o},async load(a){let l="string"==typeof a?a:a.id;return fetch(l).then(a=>a.json())},requestStatus(a){}},t7=Object.defineProperty,bs=(a,l,o)=>l in a?t7(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o,Ie=(a,l,o)=>(bs(a,"symbol"!=typeof l?l+"":l,o),o);function se(a){return a.endsWith("info.json")?a:a.endsWith("/")?`${a}info.json`:`${a}/info.json`}var t9="http://library.stanford.edu/iiif/image-api/compliance.html#level1",ie="http://library.stanford.edu/iiif/image-api/compliance.html#level2",it="http://library.stanford.edu/iiif/image-api/conformance.html#level1",ii="http://library.stanford.edu/iiif/image-api/conformance.html#level2",ir="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",il="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",io="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",is="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",id="http://iiif.io/api/image/1/level1.json",iu="http://iiif.io/api/image/1/profiles/level1.json",im="http://iiif.io/api/image/1/level2.json",ih="http://iiif.io/api/image/1/profiles/level2.json",ip="http://iiif.io/api/image/2/level1.json",ig="http://iiif.io/api/image/2/profiles/level1.json",iv="http://iiif.io/api/image/2/level2.json",iy="http://iiif.io/api/image/2/profiles/level2.json",ib="level1",iw="level2",ix="http://iiif.io/api/image/2/level1",iE="http://iiif.io/api/image/2/level2",iS="https://iiif.io/api/image/1.1/compliance/#level1",iC="https://iiif.io/api/image/1.1/compliance/#level2",ik=[iE,ie,ii,il,is,im,ih,iv,iy,iw,iC],iI=[...ik,ix,t9,it,ir,io,id,iu,ip,ig,ib,iS],iA=["http://iiif.io/api/image/2/level0",ix,iE,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",t9,ie,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",it,ii,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",ir,il,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",io,is,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",id,iu,im,ih,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",ip,ig,iv,iy,"level0",ib,iw,"https://iiif.io/api/image/1.1/compliance/#level0",iS,iC],iR={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},i$={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},iT={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function D(a){return a["@id"]?a["@id"]:a.id?a.id:void 0}function Be(a){if(!a||!a.profile||!D(a))return!1;for(let l of Array.isArray(a.profile)?a.profile:[a.profile])if("string"==typeof l&&-1!==iA.indexOf(l))return!0;return!1}function ke(a,l){if(l&&l.profile){let o=l.profile;if(o){let l=Array.isArray(o)?o:[o];return l.includes(`level${a}`)||l.includes(`http://iiif.io/api/image/2/level${a}.json`)||l.includes(`http://iiif.io/api/image/1/level${a}.json`)||l.includes(`http://iiif.io/api/image/1/profiles/level${a}.json`)}}return!1}function at(a){return Be(a)?ke(0,a)?0:ke(1,a)?1:ke(2,a)?2:null:null}function dr(a){return -1!==(a["@context"]?Array.isArray(a["@context"])?a["@context"]:[a["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")}function Rt(a){let l=a.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(l&&l[4]&&l[5]){let o=l[1],s=parseInt(l[4],10),c=parseInt(l[5],10),d=l[7];if(("max"===o||"full"===o)&&s&&c&&d)return{type:"fixed",id:a,height:c,width:s}}return{type:"unknown",id:a}}function st(a){if("string"==typeof a)return Rt(a);let l=a["@type"]?a["@type"]:a.type?a.type:void 0;if("Image"!==l&&"sc:Image"!==l)return null;let o=D(a);return o?o&&a.width&&a.height?{id:o,type:"fixed",width:a.width,height:a.height,unsafe:!0}:Rt(o):null}function kt(a){let l=[],o=a.length;for(let s=0;s<o;s++){let o=a[s];if(!o)continue;let c=function(a){return Be(a)?(a&&a.sizes?a.sizes:[]).map(l=>({id:D(a),type:"fixed-service",height:l.height,width:l.width,level:at(a),version:dr(a)?3:2})):[]}(o);c.length&&l.push(...c);let d=function(a){if(!function(a){if(!Be(a))return!1;for(let l of Array.isArray(a.profile)?a.profile:[a.profile])if("string"==typeof l){if(-1!==iI.indexOf(l))return!0}else{let a=[...l.supports||[],...l.extraFeatures||[]];if(-1!==a.indexOf("regionByPx")&&(-1!==a.indexOf("sizeByW")||-1!==a.indexOf("sizeByWh")))return!0}return!1}(a))return[];let l=[],o=Array.isArray(a.profile)?a.profile:[a.profile],s=o.length;for(let l=0;l<s;l++){let s=o[l];if(s&&"string"!=typeof s&&(s.maxHeight||s.maxWidth))return[{id:D(a),type:"variable",minWidth:0,minHeight:0,maxHeight:s.maxHeight||s.maxWidth,maxWidth:s.maxWidth||s.maxHeight,level:at(a),version:"http://iiif.io/api/image/3/context.json"===a["@context"]?3:2}]}if(a.tiles){let o=a.tiles.length;for(let s=0;s<o;s++){let o=a.tiles[s];o&&(o.height||o.width)&&l.push({id:D(a),type:"variable",minHeight:0,minWidth:0,maxHeight:o.height||o.width,maxWidth:o.width,level:at(a),version:dr(a)?3:2})}}return l}(o);d.length&&l.push(...d)}return l}function ur(a){let l=a.service?Array.isArray(a.service)?a.service:[a.service]:[],o=l.length,s=[];for(let a=0;a<o;a++)Be(l[a])&&s.push(l[a]);return s}function Qe(a,l,o){let s=function(a){let l=function(a,l=""){let{path:o,scheme:s,server:c,prefix:d}=function(a,l=""){let o=a.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!o)throw Error(`Invalid or unknown input ${a}`);let s=o[2],c=o[3],d=o[4];if("/"===d[0]&&(d=d.substring(1)),l.length>0){if("/"===l[0]&&(l=l.substring(1)),l!==d.substring(0,l.length))throw Error(`Path does not start with prefix (path: ${d}, prefix: ${l})`);d=d.substring(l.length)}return{scheme:s,server:c,path:d,prefix:l}}(a,l),f=(o||"").split("/").reverse(),[v,y,b,w,...x]=f,E=x.reverse().filter(Boolean).join("/");if(1===f.length||""===v)return{type:"base",scheme:s,server:c,prefix:d,identifier:E};if("info.json"===v){let[,...a]=f;return{type:"info",scheme:s,server:c,prefix:d,identifier:a.reverse().filter(Boolean).join("/")}}let S=(v||"").split(".");if(typeof S[1]>"u"||typeof S[0]>"u"||typeof w>"u"||typeof b>"u"||typeof y>"u")throw Error("Invalid image request");return{type:"image",scheme:s,server:c,prefix:d,identifier:E,originalPath:o,region:function(a){try{if("full"===a)return{full:!0};if("square"===a)return{square:!0};let l=a.startsWith("pct:"),o=a.substr(l?4:0).split(",").map(a=>parseFloat(a));return{x:o[0],y:o[1],w:o[2],h:o[3],percent:l}}catch{throw Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+a)}}(w),size:function(a){let l={upscaled:!1,max:!1,confined:!1};if("^"===a[0]&&(l.upscaled=!0,a=a.slice(1)),"max"===a||"full"===a)return l.max=!0,l.serialiseAsFull="full"===a,l;if("!"===a[0]&&(l.confined=!0,a=a.slice(1)),"p"===a[0])return l.percentScale=parseFloat(a.slice(4)),l;let o=a.split(",").map(a=>a.trim());return o.length&&"u">typeof o[0]&&(""!==o[0]&&(l.width=parseInt(o[0],10)),"u">typeof o[1]&&""!==o[1]?(l.height=parseInt(o[1],10),l.version=2):l.version=3),l}(b),rotation:function(a){let l={angle:0};if("!"===a[0]&&(l.mirror=!0,a=a.substr(1)),l.angle=parseFloat(a)%360,Number.isNaN(l.angle))throw Error(`Invalid rotation ${a}`);return l}(y),quality:S[0],format:S[1]}}(se(a.id));if("info"!==l.type)throw Error("Invalid service URL");let o=function(a){let l=a?Array.isArray(a.profile)?a.profile:[a.profile]:[],o={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let a of l){var s;if("string"==typeof a&&(s=a,a=-1!==ik.indexOf(s)?iT:-1!==iI.indexOf(s)?i$:iR),a){if(a.formats)for(let l of a.formats)-1===o.extraFormats.indexOf(l)&&o.extraFormats.push(l);if(a.qualities)for(let l of a.qualities)-1===o.extraQualities.indexOf(l)&&o.extraQualities.push(l);if(a.supports)for(let l of a.supports)-1===o.extraFeatures.indexOf(l)&&o.extraFeatures.push(l);if(a.maxHeight&&(o.maxHeight=a.maxHeight),a.maxWidth&&(o.maxWidth=a.maxWidth),a.maxArea&&(o.maxArea=a.maxArea),a.extraFormats)for(let l of a.extraFormats)-1===o.extraFormats.indexOf(l)&&o.extraFormats.push(l);if(a.extraQualities)for(let l of a.extraQualities)-1===o.extraQualities.indexOf(l)&&o.extraQualities.push(l);if(a.extraFeatures)for(let l of a.extraFeatures)-1===o.extraFeatures.indexOf(l)&&o.extraFeatures.push(l);a.maxHeight&&(o.maxHeight=a.maxHeight),a.maxWidth&&(o.maxWidth=a.maxWidth),a.maxArea&&(o.maxArea=a.maxArea)}}if(a.extraFormats)for(let l of a.extraFormats)-1===o.extraFormats.indexOf(l)&&o.extraFormats.push(l);if(a.extraFeatures)for(let l of a.extraFeatures)-1===o.extraFeatures.indexOf(l)&&o.extraFeatures.push(l);if(a.extraQualities)for(let l of a.extraQualities)-1===o.extraQualities.indexOf(l)&&o.extraQualities.push(l);return o}(a);return{identifier:l.identifier,originalPath:"",server:l.server,prefix:l.prefix,scheme:l.scheme,type:"image",quality:-1===o.extraQualities.indexOf("default")?o.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}({"@context":3===a.version?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:se(D(a)),profile:null===a.level||typeof a.level>"u"?"level0":`level${a.level}`,type:3===a.version?"ImageService3":"ImageService2"});if("image"!==s.type)throw Error("Invalid service");return s.size.max=!1,s.size.width=l,s.size.height=o,{id:function(a,l){let o=a.prefix.startsWith("/")?a.prefix.substr(1):a.prefix,s=`${a.scheme}://${a.server}/${o?`${o}/`:""}${a.identifier}`;if("base"===a.type)return s;if("info"===a.type)return`${s}/info.json`;let{size:c}=a,{region:d,rotation:f,format:v,quality:y}=a;return[s,function({x:a=0,y:l=0,w:o,h:s,full:c,square:d,percent:f}){if(c)return"full";if(d)return"square";if(typeof o>"u"||typeof s>"u")throw Error("RegionParameter: invalid region");let v=`${a},${l},${o},${s}`;return f?`pct:${v}`:v}(d),function({max:a,percentScale:l,upscaled:o,confined:s,width:c,height:d,serialiseAsFull:f,version:v}){let y=[];return o&&y.push("^"),a?y.push(f?"full":"max"):(s&&y.push("!"),l&&y.push(`pct:${l}`),c&&y.push(`${c}`),y.push(","),d&&3===v&&y.push(`${d}`)),y.join("")}(c),`${f.mirror?"!":""}${(f.angle||0)%360}`,`${y}.${v}`].filter(Boolean).join("/")}(s),type:"fixed",width:l,height:o||a.height/(a.width||1)*l,unsafe:a.width>l}}function ue(a){let l=a.replace(/(https?:\/\/)?(www.)?/i,"");return -1!==l.indexOf("/")?l.split("/")[0]:l}var iO=class{constructor(a={}){Ie(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),Ie(this,"fetchingCount",0),Ie(this,"imageServices",{}),Ie(this,"knownImageServers",{}),this.config=Object.assign(this.config,a)}setConfig(a){Object.assign(this.config,a)}sample(a,l,o=!0){let s=ue(D(a)),c=se(D(a)),d=this.knownImageServers[s];return this.imageServices[c]=Object.assign(a,{real:!0}),d||!a.tiles||ke(0,a)?this.verify(a):(this.knownImageServers[s]={verifications:0,malformed:!1,root:s,preLoaded:o,sampledId:D(a),verified:!1,server:null,result:{context:a["@context"]||[],sampledProfile:a.profile,resourceServiceRatio:l&&a.height?l.height/a.height:1,sampledSizes:a.sizes||[],sizeRatios:function(a,l,o){let s=o.length,c=[];for(let l=0;l<s;l++){let s=o[l];if(s){let l=s.width;c.push(a/l)}}return c}(a.width,a.height,a.sizes||[]),sampledTiles:a.tiles||[]}},!0)}preLoad(a,l=!0){this.knownImageServers[a.root]=a,l&&(this.knownImageServers[a.root].malformed=!1,this.knownImageServers[a.root].verifications=this.config.verificationsRequired)}predict(a,l=!1,o=!1){let s=null==a?void 0:a.source,c=ue(D(a)),d=this.knownImageServers[c],f=se(D(a));return this.imageServices[f]?this.imageServices[f]||null:!(!this.config.approximateServices||!d||!d.result||!(null!=s&&s.height||a.height)||!(null!=s&&s.width||a.width)||!o&&(d.malformed||d.verifications<this.config.verificationsRequired)||ke(0,a.source))?(this.imageServices[f]||(this.imageServices[f]={"@context":d.result.context,"@id":D(a),id:D(a),protocol:"http://iiif.io/api/image",tiles:(null==s?void 0:s.tiles)||function(a,l,o){let s=a>l?a:l,c=o.length,d=[];for(let a=0;a<c;a++){let l=o[a];if(!l||0===l.scaleFactors.length)continue;let c=l.scaleFactors[0];if(!c)continue;let f=s/c,v=[c];for(;f>=l.width;)v.push(c*=2),f/=2;d.push({...l,scaleFactors:v})}return d}(a.width,a.height,d.result.sampledTiles),sizes:(null==s?void 0:s.sizes)||function(a,l,o){let s=o.length,c=[];for(let d=0;d<s;d++){let s=o[d];s&&c.push({width:Math.floor(a/s),height:Math.floor(l/s)})}return c}(Math.round(a.width/d.result.resourceServiceRatio),Math.round(a.height/d.result.resourceServiceRatio),d.result.sizeRatios),profile:(null==s?void 0:s.profile)||d.result.sampledProfile,height:(null==s?void 0:s.height)||a.height,width:(null==s?void 0:s.width)||a.width,real:!1}),this.imageServices[f]||null):null}async getThumbnailFromResource(a,l,o=!0,s=[]){let c=a?await this.getImageCandidates(a,o):[];return function(a,l){let o=[],s=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},a),i=(a,l=0)=>s.explain?o.push(Array(l).fill(0).map(a=>"    ").join("")+a().trim()):void 0,c=[],d=[],f=null;i(()=>`Using configuration: ${JSON.stringify(s,null,2)}`);let u=(a,l)=>{let o;if(i(()=>"Swapping choice",3),o=s.width?s.width:s.maxWidth,a.height<=s.maxHeight&&a.width<=s.maxWidth&&a.height>=s.minHeight&&a.width>=s.minWidth&&(!l||Math.abs(a.width-o)<Math.abs(l.width-o))){if(s.preferFixedSize&&a.unsafe){i(()=>`We found an image that was marked as unsafe, but it was the best size. (${a.id})`,4),d.push(a);return}s.returnAllOptions&&l&&d.push(l),i(()=>`We found a new image that was the best size. (${a.id})`,4),f=a}else s.returnAllOptions&&d.push(a)};i(()=>`The input shows we have ${l.length} list(s) of candidates to choose from.`);let v=l.length;for(let a=0;a<v;a++){let o=l[a]();i(()=>`Candidate group ${a}: ${JSON.stringify(o,null,2)}`,1);let d=o.length;i(()=>`Checking candidate list number ${a} and found ${d} potential ways of creating image(s)`,1);for(let a=0;a<d;a++){let l=o[a];i(()=>`-> Checking candidate ${a}`,1),"unknown"===l.type&&s.atAnyCost&&(i(()=>'We\'ve found an unknown image type, adding this to the "last resort" list',2),c.push(l)),"fixed"===l.type&&(l.unsafe?(i(()=>'We\'ve found an unsafe fixed image type, adding this to the "last resort" list',2),c.push(l)):(i(()=>"We've found a fixed size image, checking if it matches the request",2),u(l,f))),"fixed-service"===l.type&&(s.unsafeImageService?(i(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2),u(Qe(l,s.width,s.height),f)):(i(()=>"Checking for an image from the tile source 3",2),u(Qe(l,l.width,l.height),f))),"variable"===l.type&&l.maxWidth&&u(Qe({id:l.id,type:"fixed-service",width:l.maxWidth,height:l.maxWidth,level:l.level,version:l.version},l.maxWidth),f)}if(f&&!s.returnAllOptions){if(f.unsafe||s.allowUnsafe)continue;i(()=>`We found a match in choice list number ${a}, no searching any more`);break}}return s.atAnyCost&&0===d.length?(i(()=>f?`We found an image! ${f.id} of type ${f.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:f||c[0]||null,fallback:c.slice(1),log:o}):s.returnAllOptions?(i(()=>"Returning all options that we have found"),{best:(s.atAnyCost?f||d[0]||c[0]:f||d[0])||null,fallback:[...d,...c],log:o}):(i(()=>"Returning the best image that we found, and a fallback"),{best:f||d[0]||null,fallback:f?d:d.slice(1),log:o})}(l,[()=>s,()=>c])}async getImageCandidates(a,l=!0){if(l&&a&&a.height&&a.width)for(let l of ur(a)){let o={id:D(l),width:l.width?l.width:a.width,height:l.height?l.height:a.height,source:l};await this.loadService(o)}return function(a,l=!0,o){let s=[],c=st(a);if(null===c)return s;if(s.push(c),l&&a&&a.width&&a.height){let l=[];for(let s of ur(a)){let c={id:D(s),width:a.width,height:a.height};if(o.canLoadSync(c)){let s=o.loadServiceSync(c);s&&(s.height||(s.height=a.height),s.width||(s.width=a.width),l.push(...kt([s])))}}if(l.length)return s.push(...l),s}return a.service&&s.push(...kt(a.service)),s}(a,l,this)}async verify(a){let l=this.predict(a,!1,!0),o=await this.fetchService(D(a));if(!l)return!1;let s=l.height===o.height&&l.width===o.width&&l["@context"]===o["@context"]&&function(a,l){if(a.length!==l.length)return!1;if(0===a.length&&0===l.length)return!0;let o=a.length,s=!0;for(let c=0;c<o;c++){let o=a[c],d=l[c];if(o.width!==d.width||o.height!==d.height){s=!1;break}}if(s)return!0;let c=0;for(let s=0;s<o;s++)for(let d=0;d<o;d++)if(a[s].width===l[d].width&&a[s].height===l[d].height){c++;break}return c===o}(l.sizes||[],o.sizes||[]);if(s){let l=ue(D(a)),o=this.knownImageServers[l];o&&(o.verifications+=1,o.verifications>=this.config.verificationsRequired&&(o.verified=!0))}return s}canLoadSync(a){let l="string"==typeof a?a:D(a),o=se(l);if(this.imageServices[o])return!0;let s=this.knownImageServers[ue(l)];return!!(s&&!s.malformed&&s.verifications>=this.config.verificationsRequired)}async markAsMalformed(a){return this.knownImageServers[ue(D(a))].malformed=!0,this.loadService(a,!0)}async fetchService(a,l=!1){let o=se(a),s=this.imageServices[o];if(s&&(!l||s.real))return s;if(!this.config.enableFetching)throw Error("Fetching is not enabled");let c=await this.fetch(o).then(a=>a.json());return!c.id&&c["@id"]&&(c.id=c["@id"]),c.id!==a&&(c.id=a,c["@id"]&&(c["@id"]=a)),this.imageServices[o]=Object.assign(c,{real:!0}),this.imageServices[o]}async fetch(a,l){return fetch(a,l)}async loadService(a,l=!1){if(!this.config.disableThrottling){let a=!0;for(;a;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(a=>setTimeout(a,500));else{a=!1;break}}let o=this.knownImageServers[ue(D(a))];if(o&&!o.malformed&&!l){await o.result;let l=this.loadServiceSync(a);if(l)return l}this.fetchingCount++;let s=await this.fetchService(D(a),l);return this.fetchingCount--,s.real&&this.sample(s,a),s}loadServiceSync(a){let l=se(D(a));return this.imageServices[l]?this.imageServices[l]:this.config.approximateServices?this.predict(a):null}};new iO;var iM=new iO,iL=new Map;let sl=({type:a})=>{switch(a){case"Sound":return w.createElement(N.Audio,null);case"Image":default:return w.createElement(N.Image,null);case"Video":return w.createElement(N.Video,null)}},ll=({canvas:a,canvasIndex:l,isActive:o,type:s,handleChange:c})=>{let[d,f]=(0,w.useState)(!1),[v,y]=(0,w.useState)(),b=L(),{vault:x}=b,E=null!=a&&a.label?q(null==a?void 0:a.label):String(l+1);return(0,w.useEffect)(()=>{d&&(async()=>{var l,o;try{if((null==(l=null==a?void 0:a.thumbnail)?void 0:l.length)!==0)y(null==(o=null==a?void 0:a.thumbnail[0])?void 0:o.id);else{let{best:l}=await function(a,{vault:l=t8,dereference:o=!1,...s}={}){let c=iL.get(l);return c||(c=function(a=t8,l={}){let o=l.imageServiceLoader||iM;async function r(l,s,c=!1,d=[],f){let m=()=>o.getThumbnailFromResource(void 0,s,c,d);if(!l)return await o.getThumbnailFromResource(void 0,s,c,d);if("string"==typeof l){let a=st(l);return a&&d.push(a),await o.getThumbnailFromResource(void 0,s,c,d)}let v=a.get(l,{skipSelfReturn:!1});if("string"==typeof v)return{best:st(v),fallback:[],log:[]};if(!v)return await m();switch(await (async l=>{if(l&&l.thumbnail&&l.thumbnail.length){let s=a.get(l.thumbnail[0]),f=await o.getImageCandidates(s,c);f&&f.length&&d.push(...f)}})(v),v.type){case"Annotation":{let l=Array.isArray(v.body)?v.body:[v.body],y=a.get(l[0]);return f&&!y.width&&(y.width=f.width,y.height=f.height),await o.getThumbnailFromResource(y,s,c,d)}case"Canvas":return r(v.items[0],s,c,d,{width:v.width,height:v.height});case"AnnotationPage":return r(v.items[0],s,c,d,f);case"Choice":return!v.items||v.items[0]?await m():r(v.items[0],s,c,d,f);case"Collection":{let a=v.items[0];return a?r(a,s,c,d,f):await m()}case"Manifest":{let a=v.items[0];return a?r(a,s,c,d,f):await m()}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return f&&!v.width&&(v.width=f.width,v.height=f.height),o.getThumbnailFromResource(v,s,c,d)}return await m()}return{getBestThumbnailAtSize:r}}(l),iL.set(l,c)),c.getBestThumbnailAtSize(a,s,o)}(a,{vault:x,dereference:!0,width:200,height:200});y(null==l?void 0:l.id)}}catch(a){console.error("Error fetching thumbnail",a)}})()},[a,d]),w.createElement(tY,{"aria-checked":o,"data-testid":"media-thumbnail","data-canvas":l,onClick:()=>c(a.id),value:a.id},w.createElement("figure",null,w.createElement(tX,null,w.createElement(vs,{isVisibleCallback:a=>{f(a)},attributes:{className:"media-thumbnail-lazyload","data-lazyload":String(d),"data-testid":"media-thumbnail-lazyload"}},v&&w.createElement("img",{alt:E,"data-testid":"media-thumbnail-image",src:v})),w.createElement(tJ,null),w.createElement(tG,null,w.createElement(tU,{isIcon:!0,"data-testid":"thumbnail-tag"},w.createElement(tQ,null),w.createElement(N,{"aria-label":s},w.createElement(sl,{type:s})),["Video","Sound"].includes(s)&&w.createElement(tZ,null,hn(a.duration))))),w.createElement("figcaption",{"data-testid":"fig-caption"},a.label?w.createElement(ne,{label:a.label}):(l+1).toString())))},cl=a=>a.body?a.body.type:"Image",dl=({items:a})=>{let{t:l}=(0,b.$G)(),o=J(),s=L(),{activeCanvas:c,vault:d,sequence:f}=s,[v,y]=(0,w.useState)(""),[x,E]=(0,w.useState)([]),[S,k]=(0,w.useState)(0),I=w.useRef(null),p=a=>{c!==a&&o({type:"updateActiveCanvas",canvasId:a})};return(0,w.useEffect)(()=>{if(!x.length){let l=["Image","Sound","Video"],o=a.map(a=>En(d,a,"painting",l)).filter(a=>a.annotations.length>0);E(o)}},[a,x.length,d]),(0,w.useEffect)(()=>{x.forEach((a,l)=>{null!=a&&a.canvas&&a.canvas.id===c&&k(l)})},[c,x]),(0,w.useEffect)(()=>{let a=document.querySelector(`[data-canvas="${S}"]`);if(a instanceof HTMLElement&&I.current){let l=a.offsetLeft-I.current.offsetWidth/2+a.offsetWidth/2;I.current.scrollTo({left:l,behavior:"smooth"})}},[S]),w.createElement(w.Fragment,null,w.createElement(gs,{handleFilter:a=>y(a),handleCanvasToggle:a=>{let l=f[1].findIndex(a=>a.includes(S)),o=l+a>=0?l+a:f[1].length-1;if(!f[1][o])return;let s=f[1][o][0],c=f[0][s].id;c&&p(c)},activeIndex:S,canvasLength:a.length}),w.createElement(tK,{"aria-label":l("media.selectItem"),"data-testid":"media","data-active-canvas":a[S].id,"data-canvas-length":a.length,"data-filter":v,ref:I},f[1].filter(a=>a.some(a=>{var l;let o=f[0][a].id,s=x.find(a=>{var l;return(null==(l=null==a?void 0:a.canvas)?void 0:l.id)===o});if(!s)return!1;let c=q(null==(l=null==s?void 0:s.canvas)?void 0:l.label)||"";return!(v&&!c.toLowerCase().includes(v.toLowerCase()))})).map((a,l)=>{let o=a.map(a=>f[0][a].id).includes(c);return w.createElement(t0,{"data-active":o,key:l},a.map(a=>{var l,o;let s=f[0][a].id,d=x.find(a=>{var l;return(null==(l=null==a?void 0:a.canvas)?void 0:l.id)===s});return d?w.createElement(ll,{canvas:d.canvas,canvasIndex:x.findIndex(a=>a===d),handleChange:p,isActive:c===(null==(l=null==d?void 0:d.canvas)?void 0:l.id),key:null==(o=null==d?void 0:d.canvas)?void 0:o.id,type:cl(d.annotations[0])}):null}))})))},iP=e3("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all",opacity:1,display:"flex",alignItems:"center",justifyContent:"center",img:{width:"100%",height:"100%",objectFit:"contain",color:"transparent",aspectRatio:"auto"},"&[data-paged=true]":{"img:first-child ":{objectPosition:"100% 50%"},"img:last-child":{objectPosition:"0 50%"}},"&[data-active=false]":{opacity:0,objectPosition:"50% 50%"},variants:{isMedia:{true:{cursor:"pointer"}}}}),iF=e3("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),iz=e3(iF,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),ij=e3("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${iz}`]:{backgroundColor:"$accent"},[`${iP}`]:{backgroundColor:"#6662"}}}),i_=e3("div",{width:"100%",height:"100%"}),iD=e3("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),iV=e3(U.xz,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),iB=e3(U.VY,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),iH=e3(U.ck,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),iN=e3(U.__,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),iW=e3(U.fC,{position:"relative",zIndex:"5",width:"100%"}),Je=({direction:a,title:l})=>w.createElement(iD,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},w.createElement("title",null,l),"up"===a&&w.createElement(()=>w.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),null),"down"===a&&w.createElement(()=>w.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),null)),vr=({children:a,label:l,maxHeight:o,onValueChange:s,value:c})=>w.createElement(iW,{onValueChange:s,value:c},w.createElement(iV,{"data-testid":"select-button"},w.createElement(U.ki,{"data-testid":"select-button-value"}),w.createElement(U.GV,null,w.createElement(Je,{direction:"down",title:"select"}))),w.createElement(U.ue,null,w.createElement(iB,{css:{maxHeight:`${o} !important`},"data-testid":"select-content"},w.createElement(U.Pn,null,w.createElement(Je,{direction:"up",title:"scroll up for more"})),w.createElement(U.Q_,null,w.createElement(U.DI,null,l&&w.createElement(iN,null,w.createElement(ne,{"data-testid":"select-label",label:l})),a)),w.createElement(U.Jk,null,w.createElement(Je,{direction:"down",title:"scroll down for more"}))))),yr=a=>w.createElement(iH,{...a},a.thumbnail&&w.createElement(_n,{thumbnail:a.thumbnail}),w.createElement(U.S_,null,w.createElement(ne,{label:a.label})),w.createElement(U.o6,null)),iq=window.OpenSeadragon;if(!iq&&!(iq=G))throw Error("OpenSeadragon is missing.");let iU="http://www.w3.org/2000/svg";iq.Viewer&&(iq.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo||(this._svgOverlayInfo=new br(this)),this._svgOverlayInfo});let br=function(a){let l=this;this._viewer=a,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(iU,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(iU,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){l.resize()}),this._viewer.addHandler("open",function(){l.resize()}),this._viewer.addHandler("rotate",function(){l.resize()}),this._viewer.addHandler("flip",function(){l.resize()}),this._viewer.addHandler("resize",function(){l.resize()}),this.resize()};br.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));let a=this._viewer.viewport.pixelFromPoint(new iq.Point(0,0),!0),l=this._viewer.viewport.getZoom(!0),o=this._viewer.viewport.getRotation(),s=this._viewer.viewport.getFlip(),c=this._viewer.viewport._containerInnerSize.x,d=c*l,f=d;s&&(d=-d,a.x=-a.x+c),this._node.setAttribute("transform","translate("+a.x+","+a.y+") scale("+d+","+f+") rotate("+o+")")},onClick:function(a,l){new iq.MouseTracker({element:a,clickHandler:l}).setTracking(!0)}};let yl=a=>fetch(`${a.replace(/\/$/,"")}/info.json`).then(a=>a.json()).then(a=>a).catch(l=>{console.error(`The IIIF tilesource ${a.replace(/\/$/,"")}/info.json failed to load: ${l}`)}),bl=a=>{let l,o;return Array.isArray(a)&&(l=a[0])&&(o="@id"in l?l["@id"]:l.id),o},He=a=>{var l,o,s,c,d,f,v,y,b,w,x,E,S,I,R;let T,O={};if(Cl(a))T=a;else{let M=JSON.parse((0,k.o0)(a));switch(null==M?void 0:M.type){case"SpecificResource":O={manifest:T=null==(s=null==(o=null==(l=null==M?void 0:M.target)?void 0:l.partOf)?void 0:o[0])?void 0:s.id,canvas:null==(c=null==M?void 0:M.target)?void 0:c.id},null!=M&&M.selector&&(O.selector=M.selector);break;case"Range":case"Annotation":O={manifest:T=null==(v=null==(f=null==(d=null==M?void 0:M.target)?void 0:d.partOf)?void 0:f[0])?void 0:v.id,canvas:null==(y=null==M?void 0:M.target)?void 0:y.id},((null==(b=null==M?void 0:M.target)?void 0:b.type)==="SpecificResource"||null!=(w=null==M?void 0:M.target)&&w.selector)&&(O.selector=M.target.selector);break;case"Canvas":if(O={manifest:T=null==(E=null==(x=null==M?void 0:M.partOf)?void 0:x[0])?void 0:E.id,canvas:null==M?void 0:M.id},null!=(S=null==M?void 0:M.id)&&S.includes("#xywh=")){let[a,l]=M.id.split("#xywh=");O.canvas=a,O.selector={type:"FragmentSelector",value:`xywh=${l}`}}break;case"Manifest":T=null==M?void 0:M.id,O={collection:null==(R=null==(I=null==M?void 0:M.partOf)?void 0:I[0])?void 0:R.id,manifest:null==M?void 0:M.id};break;case"Collection":O={collection:T=null==M?void 0:M.id}}}return{resourceId:T,active:O}},wl=a=>{let{resourceId:l,active:o}=He(a);return o.collection||o.manifest||l},El=(a,l)=>{let o=l.items.map(a=>a.id),{active:s}=He(a),c=s.canvas;return o.includes(c)?c:o[0]},xl=(a,l)=>{let{active:o}=He(a),s=o.manifest,c=l.items.filter(a=>"Manifest"===a.type).map(a=>a.id);return 0==c.length?null:c.includes(s)?s:c[0]},Sl=a=>{let{active:l}=He(a);return l.selector},Cl=a=>{try{new URL(a)}catch{return!1}return!0};var iJ=((s=iJ||{}).TiledImage="tiledImage",s.SimpleImage="simpleImage",s);let Il=a=>{let l=Array.isArray(null==a?void 0:a.service)&&(null==a?void 0:a.service.length)>0,o=l?bl(null==a?void 0:a.service):null==a?void 0:a.id,s=l?iJ.TiledImage:iJ.SimpleImage;return{uri:o,imageType:s}},Al=(a,l)=>{let o=l?iJ.TiledImage:iJ.SimpleImage;return{uri:a,imageType:o}},iG=e3("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),iQ=e3("div",{position:"relative",width:"100%",height:"100%",zIndex:"0",".clover-iiif-image-openseadragon-annotation":{position:"relative",backgroundColor:"transparent",border:"2px solid #0003",boxSizing:"content-box",borderRadius:"3px",boxShadow:"0 0 38vw 38vw transparent",transition:"box-shadow 100ms ease-in-out",zIndex:"0",label:{opacity:0,position:"absolute",lineHeight:"1.47rem",pointerEvents:"none",textAlign:"center",minWidth:"300px",maxWidth:"20vw",padding:"0.5rem",borderRadius:"3px",top:"calc(100% + 0.5rem)",left:"50%",transform:"translate(-50%, 0)",backgroundColor:"$primary",color:"$secondary",transition:"opacity 100ms ease-in-out"},"&[data-active=true]":{border:"2px solid $accent !important",boxShadow:"0 0 38vw 38vw #0003",zIndex:"99999999",label:{opacity:1}}}}),iZ=e3("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${iG}`]:{display:"block"}},false:{[`${iG}`]:{display:"none"}}}}}),me=({className:a,id:l,label:o,children:s})=>{let c=o.toLowerCase().replace(/\s/g,"-");return w.createElement(iF,{id:l,className:a,"data-testid":"openseadragon-button","data-button":c},w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${l}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},w.createElement("title",{id:`${l}-svg-title`},o),s))},iX=e3("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),$l=()=>w.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),Ml=()=>w.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),Ol=()=>w.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),Pl=()=>w.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),Ot=()=>w.createElement(w.Fragment,null,w.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),w.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Fl=({_cloverViewerHasPlaceholder:a,config:l})=>{let o=L(),{activeCanvas:s,plugins:c,vault:d,openSeadragonViewer:f}=o,v=d.get({id:s,type:"Canvas"});return(0,w.useEffect)(()=>{if(!f)return;let a=f.viewport.getRotation();f.addHandler("home",()=>{f.viewport.setRotation(a)})},[f]),w.createElement(iX,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:a},l.showZoomControl&&w.createElement(w.Fragment,null,w.createElement(me,{id:l.zoomInButton,label:"zoom in"},w.createElement($l,null)),w.createElement(me,{id:l.zoomOutButton,label:"zoom out"},w.createElement(Ml,null))),l.showFullPageControl&&w.createElement(me,{id:l.fullPageButton,label:"full page"},w.createElement(Ol,null)),l.showRotationControl&&w.createElement(w.Fragment,null,w.createElement(me,{id:l.rotateRightButton,label:"rotate right"},w.createElement(Ot,null)),w.createElement(me,{id:l.rotateLeftButton,label:"rotate left"},w.createElement(Ot,null))),l.showHomeControl&&w.createElement(me,{id:l.homeButton,label:"reset"},w.createElement(Pl,null)),c.filter(a=>{var l;return null==(l=a.imageViewer)?void 0:l.controls}).map((a,l)=>{var o,s,c,d;let f=null==(s=null==(o=a.imageViewer)?void 0:o.controls)?void 0:s.component;return w.createElement(f,{key:l,...null==(d=null==(c=null==a?void 0:a.imageViewer)?void 0:c.controls)?void 0:d.componentProps,canvas:v,useViewerDispatch:J,useViewerState:L})}))};async function wr(a,l=3,o=500){try{return await a()}catch(s){if(l<=0)throw s;return await new Promise(a=>setTimeout(a,o)),wr(a,l-1,o)}}let _l=a=>new Promise(l=>setTimeout(l,a)),Pt=async(a,l,o=3,s=300)=>{for(let c=0;c<o;c++){let o=l?l-1:0,c=a.getItemAt(o);if(c)return c;await _l(s)}throw Error("No base item found at index 0 after retries")},zl=({annotations:a,ariaLabel:l,config:o,uri:s,_cloverViewerHasPlaceholder:c,imageType:d,openSeadragonCallback:f})=>{let[v,y]=(0,w.useState)([]),[b,x]=(0,w.useState)([]),[E,S]=(0,w.useState)(),[k,I]=(0,w.useState)([]),R=J(),T=(0,w.useRef)(!1);function g(){E&&(null==f||f(E))}return(0,w.useEffect)(()=>(T.current||(T.current=!0,E||S(G(o))),()=>null==E?void 0:E.destroy()),[]),(0,w.useEffect)(()=>{g()},[E,f]),(0,w.useEffect)(()=>{E&&JSON.stringify(s)!==JSON.stringify(b)&&(E.forceRedraw(),x(s))},[E,b,s]),(0,w.useEffect)(()=>{b.length&&E&&(E.close(),(async()=>{switch(d){case"simpleImage":let l=1,o=0;for(let s=0;s<b.length;s++){let c=b[s];if(a){let a=new Image;a.src=c,await a.decode(),I(l=>[...l,{width:null==a?void 0:a.width,height:null==a?void 0:a.height}])}try{if(0!==s){let a=(await Pt(E.world,s)).getBounds();o=a.x+a.width,l=a.height}E.addSimpleImage({url:c,x:o,y:0,height:l,success:()=>{y(a=>[...a,c]),"function"==typeof R&&R({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(a){console.error(`Failed to load image at ${c}:`,a)}}break;case"tiledImage":{let a=1,l=0;for(let o=0;o<b.length;o++){let s=b[o];try{let c=await wr(()=>yl(s),3,1e3);if(!c)throw Error(`No tile source for ${s}`);if(0!==o){let s=(await Pt(E.world,o)).getBounds();l=s.x+s.width,a=s.height}E.addTiledImage({tileSource:c,x:l,y:0,height:a,success:()=>{y(a=>[...a,s]),"function"==typeof R&&R({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(a){console.error(`Failed to load tile at ${s}:`,a)}}break}default:console.warn(`Unsupported imageType: "${d}"`)}})().catch(a=>console.error("Error drawing tiles",a)))},[b,d,E]),(0,w.useEffect)(()=>{if(v){let a=0,A=()=>{if(a<3){let l=null==E?void 0:E.world.getHomeBounds();l&&(null==E||E.viewport.fitBounds(l,!0)),a++,setTimeout(A,50)}};A(),null==E||E.addHandler("canvas-click",a=>{let l=null==E?void 0:E.getOverlayById(a.originalTarget.id);if(l){let o=null==l?void 0:l.getBounds(E.viewport);return o.x-=.1,o.y-=.1,o.width+=.2,o.height+=.2,null==E||E.viewport.fitBounds(o,!1),a.preventDefaultAction=!0}})}},[v]),(0,w.useEffect)(()=>{a&&(null==E||E.clearOverlays(),a.forEach(a=>{var l,o,s,c;let{annotation:d,targetIndex:f}=a,v=(null==(o=null==(l=null==E?void 0:E.viewport)?void 0:l.getBounds())?void 0:o.width)||1,y=null==E?void 0:E.world.getItemAt(f),b=y?(null==y?void 0:y.getBounds().width)/(null==y?void 0:y.getContentSize().x):(null==(s=k[f])?void 0:s.width)/v,w=Xo(null==d?void 0:d.target),x=null==(c=null==d?void 0:d.body[0])?void 0:c.value;if(null!=w&&w.rect){let{x:a,y:l,w:o,h:s}=null==w?void 0:w.rect,c=function(a,l,o){let s=a*o;if(0===l)return s;for(;l>0;){let a=null==E?void 0:E.world.getItemAt(l-1);if(a){let o=a.getBounds().width;s+=o,l--}else break}return s}(a,f,b),v=new G.Rect(c,l*b,o*b,s*b),y=document.createElement("button");if(y.classList.add("clover-iiif-image-openseadragon-annotation"),y.id=d.id,y.setAttribute("tabindex","0"),y.setAttribute("role","button"),y.setAttribute("data-active","true"),y.setAttribute("tabindex","0"),y.setAttribute("role","button"),y.setAttribute("data-active","false"),x){y.setAttribute("aria-label",x);let a=document.createElement("label");a.innerHTML=x,y.appendChild(a)}y.addEventListener("mousedown",a=>{a.stopPropagation(),a.preventDefault()}),y.addEventListener("touchstart",a=>{a.stopPropagation(),a.preventDefault()}),y.addEventListener("click",a=>{a.stopPropagation(),a.preventDefault()}),y.addEventListener("keydown",a=>{if("Enter"===a.key){a.stopPropagation(),a.preventDefault();let l=new G.Rect(v.x-.1,v.y-.1,v.width+.2,v.height+.2);null==E||E.viewport.fitBounds(l,!1)}}),y.addEventListener("focus",()=>{y.setAttribute("data-active","true")}),y.addEventListener("mouseover",()=>{y.setAttribute("data-active","true")}),y.addEventListener("mouseout",()=>{y.removeAttribute("data-active")}),y.addEventListener("blur",()=>{y.removeAttribute("data-active")}),null==E||E.addOverlay(y,v,G.Placement.CENTER)}}),g())},[v,a]),w.createElement(iZ,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":o.id,hasNavigator:o.showNavigator},w.createElement(Fl,{_cloverViewerHasPlaceholder:c,config:o}),o.showNavigator&&w.createElement(iG,{id:o.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),w.createElement(iQ,{id:o.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...l&&{"aria-label":l}}))},Dl=({_cloverViewerHasPlaceholder:a=!1,annotations:l,body:o,instanceId:s,isTiledImage:c=!1,label:d,src:f="",openSeadragonCallback:v,openSeadragonConfig:y={}})=>{let b=s??(0,S.Z)(),x="string"==typeof d?d:q(d),E={id:`openseadragon-${b}`,navigatorId:`openseadragon-navigator-${b}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${b}`,homeButton:`reset-${b}`,rotateLeftButton:`rotateLeft-${b}`,rotateRightButton:`rotateRight-${b}`,zoomInButton:`zoomIn-${b}`,zoomOutButton:`zoomOut-${b}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1},...y},k=Array.isArray(o)?o:o?[o]:[],I=Array.isArray(f)?f:f?[f]:[],R=[],O=iJ.SimpleImage;if(k.length){let a=k.map(Il);R=a.map(a=>a.uri).filter(Boolean),O=a.some(a=>a.imageType===iJ.TiledImage)?iJ.TiledImage:iJ.SimpleImage}else if(I.length){let a=I.map(a=>Al(a,c));R=a.map(a=>a.uri).filter(Boolean),O=a.some(a=>a.imageType===iJ.TiledImage)?iJ.TiledImage:iJ.SimpleImage}return R.length?w.createElement(T.ErrorBoundary,{FallbackComponent:mt},w.createElement(zl,{_cloverViewerHasPlaceholder:a,annotations:l,ariaLabel:x,config:E,imageType:O,key:b,uri:R,openSeadragonCallback:a=>{null==v||v(a)}})):null},Bl=({isActive:a,isMedia:l,items:o,setIsInteractive:s})=>{let{vault:c}=L(),[d,f]=(0,w.useState)([]),v=d.length>1;if((0,w.useEffect)(()=>{f([]);let a=o.map(a=>{let l=ce(c,a.id);if(!l)return null;let{id:o,width:s,height:d}=l[0];return o?{src:o,width:s||640,height:d||640,alt:a.label?ut(a.label):"placeholder image"}:null}).filter(a=>null!==a);a.length&&f(a)},[o,v]),!a||!d.length)return null;let y=d.map(a=>a.width/a.height*1),b=y.reduce((a,l)=>a+l,0);return w.createElement(iP,{onClick:()=>s(!0),isMedia:l,className:"clover-viewer-placeholder","data-active":a,"data-paged":v},d.map((a,l)=>{let o=y[l]/b*100;return w.createElement("img",{...a,key:l,alt:a.alt,style:{width:`${o}%`}})}))},iY=e3("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),iK=w.forwardRef((a,l)=>{let o=w.useRef(null),s=(0,w.useCallback)(()=>{var a,s;if(null!=(a=l.current)&&a.currentTime&&(null==(s=l.current)?void 0:s.currentTime)>0)return;let c=l.current;if(!c)return;let d=new AudioContext,f=d.createMediaElementSource(c),v=d.createAnalyser(),y=o.current;if(!y)return;y.width=c.offsetWidth,y.height=c.offsetHeight;let b=y.getContext("2d");f.connect(v),v.connect(d.destination),v.fftSize=256;let w=v.frequencyBinCount,x=new Uint8Array(w);setInterval(function(){!function(a,l,o,s,c,d){let f=c/o*2.6,v,y=0;a.getByteFrequencyData(s),l.fillStyle="#000000",l.fillRect(0,0,c,d);for(let a=0;a<o;a++)v=2*s[a],l.fillStyle="rgba(78, 42, 132, 1)",l.fillRect(y,d-v,f,v),y+=f+6}(v,b,w,x,y.width,y.height)},20)},[l]);return w.useEffect(()=>{l&&l.current&&(l.current.onplay=s)},[s,l]),w.createElement(iY,{ref:o,role:"presentation"})}),i0=e3("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),Nl=({resource:a,ignoreCaptionLabels:l})=>{let o=ut(a.label,"en");return Array.isArray(o)&&o.some(a=>l.includes(a))?null:w.createElement("track",{key:a.id,src:a.id,label:Array.isArray(o)?o[0]:o,srcLang:"en","data-testid":"player-track"})},i1=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Ul=({allSources:a,annotationResources:l,painting:o})=>{let[s,c]=w.useState(0),[d,f]=w.useState(),v=w.useRef(null),y=(null==o?void 0:o.type)==="Sound",b=L(),{activeCanvas:x,configOptions:E,vault:S}=b;return(0,w.useEffect)(()=>{if(!o.id||!v.current)return;if(null!=v&&v.current){let a=v.current;a.src=o.id,a.load()}if("m3u8"!==o.id.split(".").pop()&&o.format&&!i1.includes(o.format))return;let a=new B.ZP({xhrSetup:function(a,l){a.withCredentials=!!E.withCredentials}});return a.attachMedia(v.current),a.on(B.ZP.Events.MEDIA_ATTACHED,function(){a.loadSource(o.id)}),a.on(B.ZP.Events.ERROR,function(l,o){if(o.fatal)switch(o.type){case B.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${l} network error encountered, try to recover`),a.startLoad();break;case B.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${l} media error encountered, try to recover`),a.recoverMediaError();break;default:a.destroy()}}),()=>{if(a&&v.current){let l=v.current;a.detachMedia(),a.destroy(),l.currentTime=0}}},[E.withCredentials,o.id]),(0,w.useEffect)(()=>{var a,l,o,c;let d=S.get(x),v=null!=(a=d.accompanyingCanvas)&&a.id?ce(S,null==(l=d.accompanyingCanvas)?void 0:l.id):null,y=null!=(o=d.placeholderCanvas)&&o.id?ce(S,null==(c=d.placeholderCanvas)?void 0:c.id):null;v&&y?f(0===s?y[0].id:v[0].id):(v&&f(v[0].id),y&&f(y[0].id))},[x,s,S]),(0,w.useEffect)(()=>{if(null!=v&&v.current){let a=v.current;return null==a||a.addEventListener("timeupdate",()=>c(a.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),w.createElement(i0,{css:{backgroundColor:E.canvasBackgroundColor,maxHeight:E.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},w.createElement("video",{id:"clover-iiif-video",key:o.id,ref:v,controls:!0,height:o.height,width:o.width,crossOrigin:E.crossOrigin,poster:d,style:{maxHeight:E.canvasHeight,position:"relative",zIndex:"1"}},a.map(a=>w.createElement("source",{src:a.id,type:a.format,key:a.id})),(null==l?void 0:l.length)>0&&l.map(a=>{let l=[];return a.items.forEach(a=>{S.get(a.id).body.forEach(a=>{let o=S.get(a.id);l.push(o)})}),l.map(a=>w.createElement(Nl,{resource:a,ignoreCaptionLabels:E.ignoreCaptionLabels||[],key:a.id}))}),"Sorry, your browser doesn't support embedded videos."),y&&w.createElement(iK,{ref:v}))},ql=()=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},w.createElement("title",{id:"close-svg-title"},"close"),w.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Gl=({isMedia:a})=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},w.createElement("title",{id:"open-svg-title"},"open"),a?w.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):w.createElement(w.Fragment,null,w.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),w.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Ql=({handleToggle:a,isInteractive:l,isMedia:o})=>w.createElement(iz,{onClick:a,isInteractive:l,isMedia:o,"data-testid":"placeholder-toggle"},l?w.createElement(ql,null):w.createElement(Gl,{isMedia:o})),Jl=({activeCanvas:a,annotationResources:l,contentSearchResource:o,isMedia:s,painting:c})=>{var d,f;let[v,y]=w.useState(0),[b,x]=w.useState(!1),[E,S]=w.useState([]),[k,I]=w.useState([]),{configOptions:R,customDisplays:T,informationPanelResource:O,openSeadragonViewer:M,vault:P,viewerId:F,visibleCanvases:z}=L(),[_,B]=w.useState([]),H=J(),W=P.get(a),U=k.length&&!b&&!s,G=(null==c?void 0:c.length)>1,Q=`${F}-${wo(a+v+JSON.stringify(z))}`,Z=T.find(l=>{var o;let s=!1,{canvasId:d,paintingFormat:f}=l.target;if(Array.isArray(d)&&d.length>0&&(s=d.includes(a)),Array.isArray(f)&&f.length>0){let a=(null==(o=c[v])?void 0:o.format)||"";s=!!(a&&f.includes(a))}return s});(0,w.useEffect)(()=>{var a;let s=[];"manifest-annotations"===O&&(null==l||l.forEach((a,l)=>{var o;null==(o=null==a?void 0:a.items)||o.forEach(a=>{let o=P.get(a.id);o&&s.push({annotation:{...o,body:o.body.map(a=>{let l=P.get(a.id);return l||a})},targetIndex:l})})})),"manifest-content-search"===O&&(null==(a=null==o?void 0:o.items)||a.forEach(a=>{let l=P.get(a.id);if(l){let a=z.findIndex(a=>a.id===l.target.source.id);"number"==typeof a&&s.push({annotation:{...l,body:l.body.map(a=>{let l=P.get(a.id);return l||a})},targetIndex:a})}})),B(s)},[l,o,O,z]),(0,w.useEffect)(()=>{if(!s){let a=z.map(a=>{let l=a.id,o=ce(P,l);return o?o[v]:void 0}).filter(Boolean),l=z.map(a=>{var l;let o=a.id,s=P.get(o),c=null==(l=null==s?void 0:s.placeholderCanvas)?void 0:l.id;return c&&c?{id:c,label:null==s?void 0:s.label}:null}).filter(a=>null!==a);S(a),I(l)}},[v,a,z,s,W]),(0,w.useEffect)(()=>{y(0)},[z]);let Y=null==(d=null==Z?void 0:Z.display)?void 0:d.component;return w.createElement(ij,{className:"clover-viewer-painting"},w.createElement(i_,{style:{backgroundColor:R.canvasBackgroundColor,height:"auto"===R.canvasHeight?"100%":R.canvasHeight}},!!k.length&&!s&&w.createElement(Ql,{handleToggle:()=>x(!b),isInteractive:b,isMedia:s}),!!(null!=k&&k.length)&&!s&&w.createElement(Bl,{isActive:!!U,isMedia:s,items:k,setIsInteractive:x}),!U&&!Z&&(s?w.createElement(Ul,{allSources:c,painting:c[v],annotationResources:l}):c&&w.createElement(Dl,{_cloverViewerHasPlaceholder:!!(null!=k&&k.length),annotations:_,body:E,instanceId:Q,key:Q,openSeadragonCallback:a=>{a&&(null==M?void 0:M.id)!==`openseadragon-${Q}`&&H({type:"updateOpenSeadragonViewer",openSeadragonViewer:a})},openSeadragonConfig:R.openSeadragon})),!U&&Y&&w.createElement(Y,{id:a,annotationBody:c[v],...null==Z?void 0:Z.display.componentProps})),G&&w.createElement(vr,{value:null==(f=c[v])?void 0:f.id,onValueChange:a=>{let l=c.findIndex(l=>l.id===a);y(l)},maxHeight:"200px"},null==c?void 0:c.map(a=>w.createElement(yr,{value:null==a?void 0:a.id,key:null==a?void 0:a.id,label:null==a?void 0:a.label}))))},Yl=({activeCanvas:a,annotationResources:l,searchServiceUrl:o,setContentSearchResource:s,contentSearchResource:c,isAudioVideo:d,items:f,painting:v})=>{let{isInformationOpen:y,configOptions:b,sequence:x}=L(),{informationPanel:E}=b,S=(null==E?void 0:E.renderAnnotation)&&l.length>0&&!E.open,k=(null==E?void 0:E.renderAbout)&&y||S,I=null==E?void 0:E.renderToggle;return w.createElement(tt,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},w.createElement(ti,{"data-aside-active":k,"data-aside-toggle":I},w.createElement(Jl,{activeCanvas:a,annotationResources:l,contentSearchResource:c,isMedia:d,painting:v}),x[1].length>1&&w.createElement(te,{className:"clover-viewer-media-wrapper"},w.createElement(dl,{items:f,activeItem:0}))),k&&w.createElement(tn,{"data-aside-active":k,"data-aside-toggle":I},w.createElement(Wa,{activeCanvas:a,annotationResources:l,searchServiceUrl:o,setContentSearchResource:s,contentSearchResource:c})))},i2=e3(de.Trigger,{width:"30px",padding:"5px"}),i3=e3(de.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),i4=e3("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),i5=e3("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${iW}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),i6=e3("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),tc=()=>{var a;let l=J(),o=L(),{activeManifest:s,collection:c,configOptions:d,vault:f}=o,v=null==d?void 0:d.canvasHeight;return w.createElement("div",{style:{margin:"0.75rem"}},w.createElement(vr,{label:c.label,maxHeight:v,value:s,onValueChange:a=>{l({type:"updateActiveManifest",manifestId:a}),l({type:"updateViewerId",viewerId:(0,S.Z)()})}},null==(a=null==c?void 0:c.items)?void 0:a.map(a=>w.createElement(yr,{value:a.id,key:a.id,thumbnail:null!=a&&a.thumbnail?f.get(null==a?void 0:a.thumbnail):void 0,label:a.label}))))},nc=(a,l=2500)=>{let{t:o}=(0,b.$G)(),[s,c]=(0,w.useState)(""),d=(0,w.useCallback)(()=>{navigator.clipboard.writeText(a).then(()=>c(o("copySuccess")),()=>c(o("copyFailure")))},[a]);return(0,w.useEffect)(()=>{if(!s)return;let a=setTimeout(()=>c(""),l);return()=>clearTimeout(a)},[s]),[s,d]},i8=e3("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",lineHeight:"1em"}),ic=({status:a})=>a?w.createElement(i8,{"data-copy-status":a},a):null,Ft=({textPrompt:a,textToCopy:l})=>{let[o,s]=nc(l);return w.createElement("button",{onClick:s},a," ",w.createElement(ic,{status:o}))},oc=({title:a})=>{let l="#ed1d33",o="#2873ab";return w.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},w.createElement("title",null,a),w.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},w.createElement("g",{transform:"scale(0.1)"},w.createElement("path",{style:{fill:o},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),w.createElement("path",{style:{fill:o},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),w.createElement("path",{style:{fill:l},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),w.createElement("path",{style:{fill:l},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),w.createElement("path",{style:{fill:o},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),w.createElement("path",{style:{fill:o},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),w.createElement("path",{style:{fill:l},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},i7=e3(Q.fC,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),i9=e3(Q.bU,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",span:{fontFamily:"monospace",fontSize:"0.8333rem",fontWeight:"700",display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center",color:"$primary",opacity:"0.382",userSelect:"none",pointerEvents:"none"},'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))",span:{opacity:"1",color:"$accent"}}});e3("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"});let nt=e3("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),ni=w.memo(()=>{let{isInformationOpen:a}=L(),l=J(),{t:o}=(0,b.$G)();return w.createElement(nt,null,w.createElement(i7,{checked:a,onCheckedChange:a=>{l({type:"updateInformationOpen",isInformationOpen:a})},id:"information-toggle","aria-label":o("informationPanelToggle"),name:"toggled?"},w.createElement(i9,null,w.createElement("span",null,"i"))))}),nn=e3(de.Trigger,{width:"30px",padding:"5px",marginBottom:"auto"}),nr=e3(i3,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function _t(a,l){let o=[];if(!a)return o;for(let s of a)if(s.id){let a=l.get(s.id);a&&o.push(a)}return o}function zt(a,l){return a.map(({format:a,id:o,label:s})=>{let c=function(a){let{vault:l}=L();try{let o=a&&l.get(a);if(!o)throw Error(`Vault entity ${a} not found.`);return(null==o?void 0:o["@id"])||(null==o?void 0:o.id)}catch(l){return console.error(l),a}}(o);return{format:a,id:c,label:q(s)||l}})}let gc=()=>{let{allPages:a,individualPages:l}=function(){let a=function(){let{activeCanvas:a,activeManifest:l,vault:o}=L(),[s,c]=(0,w.useState)({root:[],canvas:[]});return(0,w.useEffect)(()=>{let s=o.get(l),d=o.get(a),f=null==s?void 0:s.rendering,v=null==d?void 0:d.rendering,y=_t(f,o),b=_t(v,o);c({root:y,canvas:b})},[a,l,o]),{...s}}(),l=zt((null==a?void 0:a.root)||[],"Root Rendering Label"),o=zt((null==a?void 0:a.canvas)||[],"Canvas Rendering Label");return{allPages:l,individualPages:o}}(),o=a.length>0||l.length>0,r=a=>{window.open(a,"_blank")};return o?w.createElement(de,null,w.createElement(nn,{"data-testid":"download-button"},w.createElement(N,null,w.createElement(N.Download,null))),w.createElement(nr,{"data-testid":"download-content"},l.length>0&&w.createElement(w.Fragment,null,w.createElement("h3",null,"Individual Pages"),w.createElement("ul",null,l.map(({format:a,id:l,label:o})=>w.createElement("li",{key:o},w.createElement("button",{onClick:()=>r(l)},o," (",a,")"))))),a.length>0&&w.createElement(w.Fragment,null,w.createElement("h3",null,"All Pages"),w.createElement("ul",null,a.map(({format:a,id:l,label:o})=>w.createElement("li",{key:o},w.createElement("button",{onClick:()=>r(l)},o," (",a,")"))))))):null},vc=({manifestId:a,manifestLabel:l})=>{let o=L(),{collection:s,configOptions:c}=o,{informationPanel:d,showDownload:f,showIIIFBadge:v,showTitle:y}=c,x=f||v||(null==d?void 0:d.renderToggle),{t:E}=(0,b.$G)();return w.createElement(i5,{className:"clover-viewer-header"},null!=s&&s.items?w.createElement(tc,null):w.createElement(i4,{className:y?"":"visually-hidden"},y&&w.createElement(ne,{label:l,className:"label"})),x&&w.createElement(i6,null,f&&w.createElement(gc,null),v&&w.createElement(de,null,w.createElement(i2,null,w.createElement(oc,{title:E("commonShare")})),w.createElement(i3,null,(null==s?void 0:s.items)&&w.createElement("button",{onClick:a=>{a.preventDefault(),window.open(s.id,"_blank")}},E("shareCollectionJson")),w.createElement("button",{onClick:l=>{l.preventDefault(),window.open(a,"_blank")}},E("shareManifestJson"))," ",(null==s?void 0:s.items)&&w.createElement(Ft,{textPrompt:E("shareCollectionCopy"),textToCopy:s.id}),w.createElement(Ft,{textPrompt:E("shareManifestCopy"),textToCopy:a}))),(null==d?void 0:d.renderToggle)&&w.createElement(ni,null)))},yc=a=>{let t=()=>!!window.matchMedia&&window.matchMedia(a).matches,[l,o]=(0,w.useState)(t);return(0,w.useEffect)(()=>{let i=()=>o(t);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)}),l},bc=({manifest:a,theme:l,iiifContentSearchQuery:o})=>{var s;let c=L(),d=J(),{activeCanvas:f,isInformationOpen:v,vault:y,configOptions:b,visibleCanvases:x}=c,E=(null==b?void 0:b.canvasHeight)&&["100%","auto"].includes(null==b?void 0:b.canvasHeight),[S,k]=(0,w.useState)(!1),[O,M]=(0,w.useState)([]),[P,F]=(0,w.useState)([]),[z,_]=(0,w.useState)(),B=yc(e2.sm),[H,W]=(0,w.useState)(),U=(0,w.useCallback)(a=>{d({type:"updateInformationOpen",isInformationOpen:a})},[d]);(0,w.useEffect)(()=>{var a;null!=(a=null==b?void 0:b.informationPanel)&&a.open&&U(!B)},[B,null==(s=null==b?void 0:b.informationPanel)?void 0:s.open]),(0,w.useEffect)(()=>{},[B]),(0,w.useEffect)(()=>{let l=ce(y,f);l&&(k(["Sound","Video"].indexOf(l[0].type)>-1),M(l));let o=(0,I.sA)(y,a,f);d({type:"updateVisibleCanvases",visibleCanvases:o})},[f,B,a,y,d]),(0,w.useEffect)(()=>{(async()=>{let a=await Promise.all(x.map(a=>Ro(y,a.id)));F(a.flat())})()},[x]);let G=a.service.some(a=>["SearchService1","SearchService2"].includes(a.type||a["@type"]));return(0,w.useEffect)(()=>{if(G){let l=a.service.find(a=>["SearchService1","SearchService2"].includes(a.type||a["@type"]));l&&W(l.id||l["@id"])}},[a,G]),(0,w.useEffect)(()=>{var a;H&&(null==(a=b.informationPanel)?void 0:a.renderContentSearch)!==!1&&wn(y,H,o).then(a=>_(a))},[H]),w.createElement(T.ErrorBoundary,{FallbackComponent:mt},w.createElement(tr,{className:`${l} clover-viewer`,css:{background:null==b?void 0:b.background},"data-absolute-position":E,"data-information-panel-open":v},w.createElement(R.fC,{open:v,onOpenChange:U},w.createElement(vc,{manifestLabel:a.label,manifestId:a.id}),w.createElement(Yl,{activeCanvas:f,painting:O,annotationResources:P,searchServiceUrl:H,setContentSearchResource:_,contentSearchResource:z,items:a.items,isAudioVideo:S}))))},nl={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function Dt(a,l=null){return{ok:!1,status:a.status,statusText:a.statusText,headers:a.getAllResponseHeaders(),data:l||a.statusText,json:()=>JSON.parse(l||a.statusText)}}let Hc=({canvasIdCallback:a=()=>{},customDisplays:l=[],plugins:o=[],customTheme:s,iiifContent:c,id:d,manifestId:f,options:v,iiifContentSearchQuery:y})=>{var b,x,E;let S=c;d&&(S=d),f&&(S=f);let k=vn(null==(x=null==(b=null==v?void 0:v.informationPanel)?void 0:b.vtt)?void 0:x.autoScroll);return w.createElement(Ao,{initialState:{...eK,customDisplays:l,plugins:o,isAutoScrollEnabled:k.enabled,isInformationOpen:!!(null!=(E=null==v?void 0:v.informationPanel)&&E.open),vault:new eZ({customFetcher:a=>(function(a,l=nl){let o=l.headers||nl.headers;return new Promise((s,c)=>{let d=new XMLHttpRequest;d.open("get",a),d.withCredentials=l.withCredentials,o&&Object.keys(o).forEach(a=>d.setRequestHeader(a,o[a])),d.onload=()=>{s({ok:d.status>=200&&d.status<300,status:d.status,statusText:d.statusText,headers:d.getAllResponseHeaders(),data:d.responseText,json:()=>JSON.parse(d.responseText)})},d.onerror=()=>{c(Dt(d,"Failed to make request."))},d.ontimeout=()=>{c(Dt(d,"Request took longer than expected."))},d.send()})})(a,{withCredentials:null==v?void 0:v.withCredentials,headers:null==v?void 0:v.requestHeaders}).then(a=>JSON.parse(a.data))})}},w.createElement(xc,{iiifContent:S,canvasIdCallback:a,customTheme:s,options:v,iiifContentSearchQuery:y}))},xc=({canvasIdCallback:a,customTheme:l,iiifContent:o,options:s,iiifContentSearchQuery:c})=>{let d=J(),f=L(),{activeCanvas:v,activeManifest:y,isLoaded:b,vault:x}=f,[E,S]=(0,w.useState)(),[k,R]=(0,w.useState)(),T={};if(l&&(T=(0,O.jG)("custom",l)),(0,w.useEffect)(()=>{a&&a(v)},[v,a]),(0,w.useEffect)(()=>{y&&x.load(y).then(a=>{let l=(0,I.rw)(x,a);R(a);let s=El(o,a),c=Sl(o);d({type:"updateActiveCanvas",canvasId:s}),c&&d({type:"updateActiveSelector",selector:c}),d({type:"updateManifestSequence",sequence:l})}).catch(a=>{console.error(`Manifest failed to load: ${a}`)}).finally(()=>{d({type:"updateIsLoaded",isLoaded:!0})})},[o,y,d,x]),(0,w.useEffect)(()=>{d({type:"updateConfigOptions",configOptions:s});let a=wl(o);x.load(a).then(a=>{S(a)}).catch(a=>{console.error(`The IIIF resource ${o} failed to load: ${a}`)})},[d,o,s,x]),(0,w.useEffect)(()=>{if((null==E?void 0:E.type)==="Collection"){d({type:"updateCollection",collection:E});let a=xl(o,E);a&&d({type:"updateActiveManifest",manifestId:a})}else(null==E?void 0:E.type)==="Manifest"&&d({type:"updateActiveManifest",manifestId:E.id})},[d,o,E]),!b){if(null==s||!s.customLoadingComponent)return w.createElement(w.Fragment,null,"Loading");{let a=s.customLoadingComponent;return w.createElement(a,null)}}return k&&k.items?0===k.items.length?(console.log(`The IIIF manifest ${o} does not contain canvases.`),w.createElement(w.Fragment,null)):w.createElement(bc,{manifest:k,theme:T,key:k.id,iiifContentSearchQuery:c}):(console.log(`The IIIF manifest ${o} failed to load.`),w.createElement(w.Fragment,null))}}}]);