"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7679],{10795:function(i,r,l){l.r(r),l.d(r,{default:function(){return Cl}});var s,d,h,g,v=l(15059),y=l(36609),E=l(12849),x=l(67294),S=l(68188),C=l(7207),k=l(57632),I=l(39597),A=l(76076),T=l(42216),R=l(69203),$=l(4511),P=l(86744),L=l(82968),_=l(94801),F=l(59821),V=l(43338),N=l(91036),j=l(93041),H=l(79890),B=l(72679),W=l(38886),G=l(22512);let Q="clover",Y=Object.fromEntries(Object.entries({en:{commonClose:"Close",commonNext:"Next",commonPrevious:"Previous",commonSearch:"Search",commonSearchPlaceholder:"Search...",commonShare:"Share",commonViewAll:"View All",copyFailure:"Failed",copySuccess:"Copied",informationPanelTabs:"Select",informationPanelTabsClose:"Viewer",informationPanelTabsAbout:"About",informationPanelTabsAnnotations:"Annotations",informationPanelTabsSearch:"Search",informationPanelToggle:"More Information",shareCollectionJson:"View Collection",shareCollectionCopy:"Copy Collection URL",shareManifestJson:"View Manifest",shareManifestCopy:"Copy Manifest URL"},pt:{}}).map(([i,r])=>[i,{[`${Q}`]:r}]));y.ZP.use(v.Z).use(E.Db).init({defaultNS:Q,fallbackLng:"en",ns:[Q],resources:{...Y}});var O=function(i){return function(){let r={type:i,getType:()=>i,toString:()=>i};return(i,l)=>({...r,...void 0!==i&&{payload:i},...void 0!==l&&{meta:l}})}},X="@iiif/IMPORT_ENTITIES",ee="@iiif/MODIFY_ENTITY_FIELD",ei="@iiif/REORDER_ENTITY_FIELD",er="@iiif/ADD_REFERENCE",eo="@iiif/UPDATE_REFERENCE",ec="@iiif/REMOVE_REFERENCE",ed="@iiif/ADD_METADATA",eu="@iiif/REMOVE_METADATA",em="@iiif/UPDATE_METADATA",ep="@iiif/REORDER_METADATA",eh=O(X)(),ef=O(ee)(),eg=O(ei)(),ev=O(er)(),ey=O(ec)(),eb=O(eo)(),eE=O(ed)(),ew=O(em)(),ex={importEntities:eh,modifyEntityField:ef,reorderEntityField:eg,addReference:ev,removeReference:ey,updateReference:eb,addMetadata:eE,removeMetadata:O(eu)(),updateMetadata:ew,reorderMetadata:O(ep)()},eS="@iiif/ADD_MAPPING",eC="@iiif/ADD_MAPPINGS",ek=O(eS)(),eI=O(eC)(),eA="RESOURCE_ERROR",eT="RESOURCE_LOADING",eO="RESOURCE_READY",eR="@iiif/REQUEST_RESOURCE",e$="@iiif/REQUEST_ERROR",eM="@iiif/REQUEST_MISMATCH",ez="@iiif/REQUEST_COMPLETE",eP=O(eR)(),eL=O(e$)(),e_=O(eM)(),eF=O(ez)(),eD="@iiif/BATCH",eV=O(eD)(),Kr=(i,r)=>{let{entities:l,resource:s,mapping:d}=(0,S.z)(r);if(void 0===s.id)return[eL({id:i,message:"ID is not defined in resource."})];let h=[eh({entities:l}),eI({mapping:d})];return s.id!==i&&(h.push(ek({id:i,type:s.type})),h.push(e_({requestId:i,actualId:s.id}))),h.push(eF({id:i})),h},eN=Number.isNaN||function(i){return"number"==typeof i&&i!=i};function st(i,r){if(!Array.isArray(i)||!Array.isArray(r))return i===r;if(i.length!==r.length)return!1;for(let d=0;d<i.length;d++){var l,s;if(!((l=i[d])===(s=r[d])||eN(l)&&eN(s)))return!1}return!0}function Re(i,r,l){let s=i.iiif.requests[r],d=i.iiif.mapping[r];if(!d||!i.iiif.entities[d][s.resourceUri])return;let h=i.iiif.entities[d][s.resourceUri];if(h&&h[S.c]){let i=h[S.c].find(i=>i[S.d]===h.id);return(0,S.j)(h,i)}return h}function lt(i,r,{waitTimeout:l=30}={}){return(s,d)=>{let h=i.getStore(),g=h.getState(),v=g.iiif.requests[s];if(v){if(v.loadingState===eO){let i=Re(g,s);if(i)return i}switch(v.loadingState){case eA:break;case eT:return(async()=>{let i,r=!1;try{let d=await Promise.race([new Promise((l,d)=>{r||(i=h.subscribe(()=>{let i=h.getState();if(i.iiif.requests[s].loadingState===eA){d();return}if(i.iiif.requests[s].loadingState===eO){let r=Re(i,s);r?l(r):d()}}))}),new Promise((i,s)=>setTimeout(()=>{r=!0,s()},6e4*l))]);if(i&&i(),d)return d}catch{i&&i()}})()}}i.dispatch(eP({id:s}));let u=r=>{if(!r)return;r.id||r["@id"]||(r["@type"]&&(r["@id"]=s),r.id=s);let l=Kr(s,r);return i.dispatch(eV({actions:l})),Re(h.getState(),s)};try{let l=r(s,d);return l&&"function"==typeof l.then?(async()=>{try{return u(await l)}catch(r){throw i.dispatch(eL({id:s,message:r.toString()})),r}})():u(l)}catch(r){throw i.dispatch(eL({id:s,message:r.toString()})),r}}}function jt(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}let ej={};var ct=i=>{let r;let l=new Set,o=(i,s)=>{let d="function"==typeof i?i(r):i;if(!Object.is(d,r)){let i=r;r=s??("object"!=typeof d||null===d)?d:Object.assign({},r,d),l.forEach(l=>l(r,i))}},a=()=>r,s={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(l.add(i),()=>l.delete(i)),destroy:()=>{(ej?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),l.clear()}},d=r=i(o,a,s);return s},ro=i=>i?ct(i):ct,eH="@iiif/SET_META_VALUE",eB="@iiif/SET_META_VALUE_DYNAMIC",eU="@iiif/UNSET_META_VALUE",eq={setMetaValue:O(eH)(),setMetaValueDynamic:O(eB)(),unsetMetaValue:O(eU)()};let eW={};var lo=(i,r)=>(l,s,d)=>(d.dispatch=r=>(l(l=>i(l,r),!1,r),r),d.dispatchFromDevtools=!0,{dispatch:(...i)=>d.dispatch(...i),...r}),eZ=new Map,ge=i=>{let r=eZ.get(i);return r?Object.fromEntries(Object.entries(r.stores).map(([i,r])=>[i,r.getState()])):{}},co=(i,r,l)=>{if(void 0===i)return{type:"untracked",connection:r.connect(l)};let s=eZ.get(l.name);if(s)return{type:"tracked",store:i,...s};let d={connection:r.connect(l),stores:{}};return eZ.set(l.name,d),{type:"tracked",store:i,...d}},mo=(i,r={})=>(l,s,d)=>{let h;let{enabled:g,anonymousActionType:v,store:y,...E}=r;try{h=(g??(eW?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!h)return(eW?"production":void 0)!=="production"&&g&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),i(l,s,d);let{connection:x,...S}=co(y,h,E),C=!0;d.setState=(i,r,h)=>{let g=l(i,r);if(!C)return g;let S=void 0===h?{type:v||"anonymous"}:"string"==typeof h?{type:h}:h;return void 0===y?null==x||x.send(S,s()):null==x||x.send({...S,type:`${y}/${S.type}`},{...ge(E.name),[y]:d.getState()}),g};let f=(...i)=>{let r=C;C=!1,l(...i),C=r},k=i(d.setState,s,d);if("untracked"===S.type?null==x||x.init(k):(S.stores[S.store]=d,null==x||x.init(Object.fromEntries(Object.entries(S.stores).map(([i,r])=>[i,i===S.store?k:r.getState()])))),d.dispatchFromDevtools&&"function"==typeof d.dispatch){let i=!1,r=d.dispatch;d.dispatch=(...l)=>{(eW?"production":void 0)==="production"||"__setState"!==l[0].type||i||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),i=!0),r(...l)}}return x.subscribe(i=>{var r;switch(i.type){case"ACTION":if("string"!=typeof i.payload){console.error("[zustand devtools middleware] Unsupported action format");return}return Me(i.payload,i=>{if("__setState"===i.type){if(void 0===y){f(i.state);return}1!==Object.keys(i.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let r=i.state[y];if(null==r)return;JSON.stringify(d.getState())!==JSON.stringify(r)&&f(r);return}d.dispatchFromDevtools&&"function"==typeof d.dispatch&&d.dispatch(i)});case"DISPATCH":switch(i.payload.type){case"RESET":return f(k),void 0===y?null==x?void 0:x.init(d.getState()):null==x?void 0:x.init(ge(E.name));case"COMMIT":if(void 0===y){null==x||x.init(d.getState());break}return null==x?void 0:x.init(ge(E.name));case"ROLLBACK":return Me(i.state,i=>{if(void 0===y){f(i),null==x||x.init(d.getState());return}f(i[y]),null==x||x.init(ge(E.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Me(i.state,i=>{if(void 0===y){f(i);return}JSON.stringify(d.getState())!==JSON.stringify(i[y])&&f(i[y])});case"IMPORT_STATE":{let{nextLiftedState:l}=i.payload,s=null==(r=l.computedStates.slice(-1)[0])?void 0:r.state;if(!s)return;f(void 0===y?s:s[y]),null==x||x.send(null,l);break}case"PAUSE_RECORDING":return C=!C}return}}),k},Me=(i,r)=>{let l;try{l=JSON.parse(i)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}void 0!==l&&r(l)},po=i=>(r,l,s)=>{let d=s.subscribe;return s.subscribe=(i,r,l)=>{let h=i;if(r){let d=(null==l?void 0:l.equalityFn)||Object.is,g=i(s.getState());h=l=>{let s=i(l);if(!d(g,s)){let i=g;r(g=s,i)}},null!=l&&l.fireImmediately&&r(g,g)}return d(h)},i(r,l,s)};function _e(i,r,l,s){return!(!i[l]||!i[l][r]||!i[l][r][s]||!Array.isArray(i[l][r][s]))}function w(i){return i.payload}function Pe(i,r){return typeof i>"u"?r:i}function Zt(i={}){let r=Object.keys(i);return function(l={},s){let d=!1,h={};for(let g=0;g<r.length;g++){let v=r[g];h[v]=i[v](l[v],s),d=d||h[v]!==l[v]}return d?h:l}}var eJ=Zt({mapping:(i={},r)=>{switch(r.type){case eS:return{...i,[r.payload.id]:r.payload.type};case eC:return{...i,...r.payload.mapping};default:return i}},entities:(i=jt(),r)=>{var l;let n=(l,s)=>({...i,[w(r).type]:{...i[w(r).type],[w(r).id]:{...l,...s}}});switch(r.type){case ee:{if(!i[w(r).type]||!i[w(r).type][w(r).id])return i;let l=i[w(r).type][w(r).id];return"string"==typeof l?i:n(l,{[w(r).key]:w(r).value})}case ei:{if(!_e(i,w(r).id,w(r).type,w(r).key))return i;let l=i[w(r).type][w(r).id];if("string"==typeof l)return i;let s=Array.from(l[w(r).key]),[d]=s.splice(w(r).startIndex,1);return s.splice(w(r).endIndex,0,d),n(l,{[w(r).key]:s})}case X:{let l=Object.keys(w(r).entities),s={...i};for(let d of l){let l=w(r).entities[d],h={...i[d]||{}},g=!1,v=Object.keys(l||{})||[];if(l&&v){for(let r of v)g=!0,h[r]=i[d][r]?function(i,r){let l={},s=[];for(let[d,h]of Object.entries(i||{})){s.push(d);let i=(r||{})[d];if(!i||0===i.length){l[d]=h;continue}l[d]=i}for(let[i,d]of Object.entries(r||{}))-1===s.indexOf(i)&&(l[i]=d);return l}(i[d][r],l[r]):l[r];g&&(s[d]=h)}}return s}case er:{if(!_e(i,w(r).id,w(r).type,w(r).key))return i;let l=i[w(r).type][w(r).id],s=Array.from(l[w(r).key]);return s.splice(Pe(w(r).index,s.length+1),0,w(r).reference),n(l,{[w(r).key]:s})}case eo:case ec:{if(!_e(i,w(r).id,w(r).type,w(r).key))return i;let s=i[w(r).type][w(r).id],d=Array.from(s[w(r).key]),h=Pe(w(r).index,d.findIndex(i=>i&&i.id===w(r).reference.id));return -1===h||(null==(l=d[h])?void 0:l.id)!==w(r).reference.id?i:(r.type===eo?d.splice(h,1,w(r).reference):d.splice(h,1),n(s,{[w(r).key]:d}))}case ed:{let l=i[w(r).type][w(r).id];if(!l)return i;let s=Array.from(l.metadata||[]),d=w(r);return s.splice(Pe(r.payload.beforeIndex,s.length+1),0,{label:d.label,value:d.label}),n(l,{metadata:s})}case ep:{let l=i[w(r).type][w(r).id];if("string"==typeof l||!l)return i;let s=Array.from(l.metadata||[]),[d]=s.splice(w(r).startIndex,1);return s.splice(w(r).endIndex,0,d),n(l,{metadata:s})}case em:case eu:{let l=i[w(r).type][w(r).id],s=Array.from(l.metadata||[]),d=w(r).atIndex;return typeof d>"u"||-1===d||!s[d]?i:(r.type===em?s.splice(d,1,{label:w(r).label,value:w(r).value}):s.splice(d,1),n(l,{metadata:s}))}default:return i}},requests:(i={},r)=>{switch(r.type){case eR:case"@iiif/REQUEST_OFFLINE_RESOURCE":return{...i,[r.payload.id]:{requestUri:r.payload.id,loadingState:eT,uriMismatch:!1,resourceUri:r.payload.id}};case eM:return{...i,[r.payload.requestId]:{...i[r.payload.requestId]||{},uriMismatch:!0,resourceUri:r.payload.actualId},[r.payload.actualId]:{requestUri:r.payload.requestId,loadingState:i[r.payload.requestId].loadingState,uriMismatch:!0,resourceUri:r.payload.actualId}};case e$:return{...i,[r.payload.id]:{...i[r.payload.id]||{},loadingState:eA,error:r.payload.message}};case ez:return{...i,[r.payload.id]:{...i[r.payload.id]||{},loadingState:eO,error:void 0}}}return i},meta:(i={},r)=>{let{id:l,updateValue:s,value:d,meta:h,key:g}=r&&r.payload||{};switch(r.type){case eH:return{...i,[l]:{...i[l]||{},[h]:{...i[l]&&i[l][h]||{},[g]:d}}};case eB:return{...i,[l]:{...i[l]||{},[h]:{...i[l]&&i[l][h]||{},[g]:s(i[l]&&i[l][h]?i[l][h][g]:void 0)}}};case eU:return i[l]&&i[l][h]&&i[l][h][g]?{...i,[l]:{...i[l]||{},[h]:{...i[l]&&i[l][h]||{},[g]:void 0}}}:i;default:return i}}}),eG=Object.defineProperty,Io=(i,r,l)=>r in i?eG(i,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[r]=l,Z=(i,r,l)=>(Io(i,"symbol"!=typeof r?r+"":r,l),l);function z(i,r,l,s=!0){r[eY]=r[eY]||[],r[eY].push(i);let d=new Map;Object.defineProperty(r,i,{enumerable:s,get(){if(typeof r[eK][i]>"u")return;let s=r[eK][i];if(!s)return s;let h=l.get(r[eK][i],{parent:this.id?{id:this.id,type:this.type}:void 0});return d.has(h)||(d.clear(),d.set(h,re(h,l))),d.get(h)},set(s){r[eK][i]!==s&&(this[eQ]?l.modifyEntityField({id:this.id,type:this.type},i,function Xt(i){return Array.isArray(i)?i.map(i=>Xt(i)):i&&i.type?{id:i.id,type:i.type}:i}(s)):this[eK][i]=s)}})}var eK=Symbol.for("_refs_"),eQ=Symbol.for("_reactive_"),eY=Symbol.for("_defined_"),eX=Symbol.for("_parent_");function re(i,r,l=!1,s){if(Array.isArray(i))return i.map(i=>re(i,r,l));if(!i||!i.type||!i.id)return i;let d=function(i,r=!1,l){let s={id:"",type:"unknown",[eY]:[],[eK]:{},[eX]:null,[eQ]:null,is(i){return"string"==typeof i?this.id===i:!!i.id&&i.id===this.id},reactive(){if(!this[eQ])return this[eQ]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){let i=this.unwrap();for(let r of Object.keys(i||{}))this[eY].includes(r)?this[eK][r]=i[r]:this[r]=i[r]}},unreactive(){this[eQ]&&(this[eQ](),this[eQ]=null)},unwrap(){if(!this.id)throw Error("Invalid object");let r=this[eX];return i.get(this.id,{parent:r?{id:r,type:"unknown"}:void 0})},toPresentation3(){return i.toPresentation3(this.unwrap())},toPresentation2(){return i.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){return{...this,items:this.items,annotations:this.annotations,structures:this.structures,seeAlso:this.seeAlso,service:this.service,services:this.services,rendering:this.rendering,partOf:this.partOf,start:this.start,supplementary:this.supplementary,homepage:this.homepage,thumbnail:this.thumbnail,placeholderCanvas:this.placeholderCanvas,accompanyingCanvas:this.accompanyingCanvas,provider:this.provider}},subscribe(r,l=!0){return i.subscribe(()=>this.id?i.get(this.id):null,r,l)}};return z("items",s,i),z("annotations",s,i),z("structures",s,i),z("seeAlso",s,i),z("rendering",s,i),z("partOf",s,i),z("start",s,i,!1),z("supplementary",s,i),z("homepage",s,i),z("thumbnail",s,i),z("placeholderCanvas",s,i,!1),z("accompanyingCanvas",s,i,!1),z("provider",s,i),z("body",s,i),z("logo",s,i),s}(r,l),h=Object.create(d),g=Object.assign(h,i);return l&&g.reactive(),g}function mt(i){switch(i){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return i}var e0=class{constructor(i,r){var l;Z(this,"options"),Z(this,"store"),Z(this,"emitter"),Z(this,"isBatching",!1),Z(this,"batchQueue",[]),Z(this,"remoteFetcher"),Z(this,"staticFetcher"),Z(this,"defaultFetcher",i=>fetch(i).then(i=>i.json())),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},i||{}),this.store=r||function(i={}){var r;let{enableDevtools:l=!1,iiifStoreName:s="iiif",defaultState:d={iiif:{entities:jt(),meta:{},mapping:{},requests:{}}},customReducers:h={}}=i,g=(r=Zt({[s]:eJ,...h}),(i,l)=>l&&l.type===eD?l.payload.actions.reduce(r,i):l&&"@iiif/BATCH_IMPORT"===l.type?{...i,iiif:{...i.iiif,...l.payload.state}}:r(i,l)),v="u">typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?mo:(i,r)=>i;return ro(po(v(lo(g,d),{enabled:l})))}({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter={all:l=l||new Map,on:function(i,r){var s=l.get(i);s?s.push(r):l.set(i,[r])},off:function(i,r){var s=l.get(i);s&&(r?s.splice(s.indexOf(r)>>>0,1):l.set(i,[]))},emit:function(i,r){var s=l.get(i);s&&s.slice().map(function(i){i(r)}),(s=l.get("*"))&&s.slice().map(function(l){l(i,r)})}},this.remoteFetcher=lt(this,this.options.customFetcher),this.staticFetcher=lt(this,(i,r)=>r)}batch(i){this.isBatching=!0;try{i(this),this.isBatching=!1,this.dispatch(eV({actions:this.batchQueue}))}catch(i){throw this.batchQueue=[],this.isBatching=!1,i}this.batchQueue=[]}async asyncBatch(i){this.isBatching=!0;try{await i(this),this.isBatching=!1,this.dispatch(eV({actions:this.batchQueue}))}catch(i){throw this.batchQueue=[],this.isBatching=!1,i}this.batchQueue=[]}modifyEntityField(i,r,l){this.dispatch(ex.modifyEntityField({id:i.id,type:i.type,key:r,value:l}))}dispatch(i){if(this.isBatching)this.batchQueue.push(i);else{if(i.type===eD){for(let r of i.payload.actions)this.emitter.emit(r.type,{action:r,state:this.store.getState()});this.store.dispatch(i);let r=this.getState();for(let l of i.payload.actions)this.emitter.emit(`after:${l.type}`,{action:l,state:r});return}this.emitter.emit(i.type,{action:i,state:this.store.getState()}),this.store.dispatch(i);let r=this.store.getState();this.emitter.emit(`after:${i.type}`,{action:i,state:r});return}}on(i,r){return this.emitter.on(i,r),()=>{this.emitter.off(i,r)}}serialize(i,r){return(0,S.B)(this.getState().iiif,i,r)}toPresentation2(i){return this.serialize(i,S.E)}toPresentation3(i){return this.serialize(i,S.F)}hydrate(i,r,l={}){return this.get(i,r,{...l,skipSelfReturn:!1})}get(i,r,l={}){"string"!=typeof r&&(l=r||{},r=void 0);let{skipSelfReturn:s=!0}=l||{},d=l.parent?"string"==typeof l.parent?l.parent:l.parent.id:void 0;if(Array.isArray(i))return i.map(i=>this.get(i,l));let h=this.getState();if((0,C.a)(i)&&!l.preserveSpecificResources&&(i=i.source),"string"==typeof i){let l=mt(r||h.iiif.mapping[i]);if(!l)return s?null:{id:i,type:"unknown"};i={id:i,type:l}}if(i&&i.partOf&&!d&&!l.skipPartOfCheck){let r=Array.isArray(i.partOf)?i.partOf[0]:i.partOf;r&&("string"==typeof r&&(d=r),"string"==typeof r.id&&(d=r.id))}let g=mt(r||(null==i?void 0:i.type)),v=null==i?void 0:i.id,y=h.iiif.entities[g];if(!y){let r=h.iiif.requests[v];return r&&r.resourceUri!==v?this.get(r.resourceUri,l):s?null:i}let E=y[i.id];if(E&&E[S.c]){let i=E[S.c].find(i=>d?i[S.d]===d:i[S.d]===E.id);return(0,S.j)(E,i)}return y[i.id]||(s?null:i)}select(i){return i(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(i,r){if(typeof i>"u")return this.get(r,{skipSelfReturn:!1});if("function"==typeof i)try{let l=i(this.get(r,{skipSelfReturn:!1})),a=i=>this.deep(i,l);return a.size=Array.isArray(l)?l.length:1,a}catch{let a=i=>this.deep(i,void 0);return a.size=0,a}let n=r=>this.deep(r,i);return n.size=Array.isArray(i)?i.length:1,n}loadManifest(i,r){let l="string"==typeof i?i:i.id;return this.load(l,r)}loadCollection(i,r){let l="string"==typeof i?i:i.id;return this.load(l,r)}load(i,r){let l="string"==typeof i?i:i.id;return r?Promise.resolve(this.staticFetcher(l,r)):Promise.resolve(this.remoteFetcher(l))}loadSync(i,r){let l="string"==typeof i?i:i.id;return this.staticFetcher(l,r)}loadManifestSync(i,r){let l="string"==typeof i?i:i.id;return this.loadSync(l,r)}loadCollectionSync(i,r){let l="string"==typeof i?i:i.id;return this.loadSync(l,r)}areInputsEqual(i,r){return st(i,r)}subscribe(i,r,l){return typeof l>"u"&&(typeof r>"u"||!1===r||!0===r)&&(l=r,r=i,i=i=>i),this.store.subscribe(i,i=>r(i,this),{equalityFn:st,fireImmediately:!l})}async ensureLoaded(i){let r="string"==typeof i?i:i.id;this.requestStatus(r)||await this.load(r)}requestStatus(i){return this.select(r=>r.iiif.requests[i])}getResourceMeta(i,r){let l=this.getState().iiif.meta[i];if(l)return r?l[r]:l}getObject(i,r,l={}){let{reactive:s,...d}=l;return re(this.get(i,r,d),this,s)}async loadObject(i,r){return re(await this.load(i,r),this)}async loadManifestObject(i,r){return re(await this.loadManifest(i,r),this)}async loadCollectionObject(i,r){return re(await this.loadCollection(i,r),this)}wrapObject(i){return re(this.get(i,{skipSelfReturn:!1}),this)}isWrapped(i){return!!i[eY]}setMetaValue([i,r,l],s){this.dispatch("function"==typeof s?eq.setMetaValueDynamic({id:i,meta:r,key:l,updateValue:s}):eq.setMetaValue({id:i,meta:r,key:l,value:s}))}};let Ro=i=>{let r=i.toString().split(":"),l=Math.ceil(parseInt(r[0])),s=Math.ceil(parseInt(r[1])),d=Mo(Math.ceil(parseInt(r[2])),2),h=`${0!==l&&s<10?(s+"").padStart(2,"0"):s}:${d}`;return 0!==l&&(h=`${l}:${h}`),h},Kt=i=>{let r=new Date(1e3*i).toISOString().substr(11,8);return Ro(r)},en=(i,r)=>{if("object"!=typeof i||null===i)return r;for(let l in r)"object"!=typeof r[l]||null===r[l]||Array.isArray(r[l])?i[l]=r[l]:(i[l]||(i[l]={}),i[l]=en(i[l],r[l]));return i},$o=i=>i.split("").reduce(function(i,r){return(i=(i<<5)-i+r.charCodeAt(0))&i},0),tn=(i,r)=>Object.hasOwn(i,r)?i[r].toString():void 0,Mo=(i,r)=>String(i).padStart(r,"0"),e1={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},crossOrigin:void 0,ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:{behavior:"smooth",block:"center"}}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function nn(i){let r={...e1.informationPanel.vtt.autoScroll};return"object"==typeof i&&(r="enabled"in i?i:{enabled:!0,settings:i}),!1===i&&(r.enabled=!1),function({behavior:i,block:r}){let l=["auto","instant","smooth"],s=["center","end","nearest","start"];if(!l.includes(i))throw TypeError(`'${i}' not in ${l.join(" | ")}`);if(!s.includes(r))throw TypeError(`'${r}' not in ${s.join(" | ")}`)}(r.settings),r}let e2=nn(null==(h=null==(d=null==e1?void 0:e1.informationPanel)?void 0:d.vtt)?void 0:h.autoScroll),e4={activeCanvas:"",activeManifest:"",activeSelector:void 0,OSDImageLoaded:!1,collection:{},configOptions:e1,customDisplays:[],plugins:[],isAutoScrollEnabled:e2.enabled,isAutoScrolling:!1,isInformationOpen:null==(g=null==e1?void 0:e1.informationPanel)?void 0:g.open,isLoaded:!1,isUserScrolling:void 0,sequence:[[],[]],vault:new e0,contentSearchVault:new e0,openSeadragonViewer:null,viewerId:(0,k.Z)()},e3=x.createContext(e4),e5=x.createContext(e4);function Lo(i,r){switch(r.type){case"updateActiveCanvas":return r.canvasId||(r.canvasId=""),{...i,activeCanvas:r.canvasId};case"updateActiveManifest":return{...i,activeManifest:r.manifestId};case"updateOSDImageLoaded":return{...i,OSDImageLoaded:r.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...i,isAutoScrollEnabled:r.isAutoScrollEnabled};case"updateAutoScrolling":return{...i,isAutoScrolling:r.isAutoScrolling};case"updateCollection":return{...i,collection:r.collection};case"updateConfigOptions":return{...i,configOptions:en(i.configOptions,r.configOptions)};case"updateInformationOpen":return{...i,isInformationOpen:r.isInformationOpen};case"updateIsLoaded":return{...i,isLoaded:r.isLoaded};case"updateManifestSequence":return{...i,sequence:r.sequence};case"updateUserScrolling":return{...i,isUserScrolling:r.isUserScrolling};case"updateOpenSeadragonViewer":return{...i,openSeadragonViewer:r.openSeadragonViewer};case"updateViewerId":return{...i,viewerId:r.viewerId};case"updateActiveSelector":return{...i,activeSelector:r.selector};default:throw Error(`Unhandled action type: ${r.type}`)}}let Fo=({initialState:i=e4,children:r})=>{let[l,s]=(0,x.useReducer)(Lo,i);return x.createElement(e3.Provider,{value:l},x.createElement(e5.Provider,{value:s},r))};function M(){let i=x.useContext(e3);if(void 0===i)throw Error("useViewerState must be used within a ViewerProvider");return i}function U(){let i=x.useContext(e5);if(void 0===i)throw Error("useViewerDispatch must be used within a ViewerProvider");return i}let e6=window.OpenSeadragon;if(!e6&&!(e6=R))throw Error("OpenSeadragon is missing.");let e8="http://www.w3.org/2000/svg";e6.Viewer&&(e6.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo||(this._svgOverlayInfo=new Ke(this)),this._svgOverlayInfo});let Ke=function(i){let r=this;this._viewer=i,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(e8,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(e8,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){r.resize()}),this._viewer.addHandler("open",function(){r.resize()}),this._viewer.addHandler("rotate",function(){r.resize()}),this._viewer.addHandler("flip",function(){r.resize()}),this._viewer.addHandler("resize",function(){r.resize()}),this.resize()};Ke.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));let i=this._viewer.viewport.pixelFromPoint(new e6.Point(0,0),!0),r=this._viewer.viewport.getZoom(!0),l=this._viewer.viewport.getRotation(),s=this._viewer.viewport.getFlip(),d=this._viewer.viewport._containerInnerSize.x,h=d*r,g=h;s&&(h=-h,i.x=-i.x+d),this._node.setAttribute("transform","translate("+i.x+","+i.y+") scale("+h+","+g+") rotate("+l+")")},onClick:function(i,r){new e6.MouseTracker({element:i,clickHandler:r}).setTracking(!0)}};let Do=i=>new Ke(i),et=i=>{var r,l,s,d,h;let g={id:"string"==typeof i?i:i.source};if("string"==typeof i){if(i.includes("#xywh=")){let r=i.split("#xywh=");if(r&&r[1]){let[i,l,s,d]=r[1].split(",").map(i=>Number(i));g={id:r[0],rect:{x:i,y:l,w:s,h:d}}}}else if(i.includes("#t=")){let r=i.split("#t=");r&&r[1]&&(g={id:r[0],t:r[1]})}}else if("object"==typeof i){if((null==(r=i.selector)?void 0:r.type)==="PointSelector")g={id:i.source,point:{x:i.selector.x,y:i.selector.y}};else if((null==(l=i.selector)?void 0:l.type)==="SvgSelector")g={id:i.source,svg:i.selector.value};else if((null==(s=i.selector)?void 0:s.type)==="FragmentSelector"&&null!=(d=i.selector)&&d.value.includes("xywh=")&&"Canvas"==i.source.type&&i.source.id){let r=null==(h=i.selector)?void 0:h.value.split("xywh=");if(r&&r[1]){let[l,s,d,h]=r[1].split(",").map(i=>Number(i));g={id:i.source.id,rect:{x:l,y:s,w:d,h:h}}}}}return g},zo=i=>fetch(`${i.replace(/\/$/,"")}/info.json`).then(i=>i.json()).then(i=>i).catch(r=>{console.error(`The IIIF tilesource ${i.replace(/\/$/,"")}/info.json failed to load: ${r}`)}),Bo=i=>{let r,l;return Array.isArray(i)&&(r=i[0])&&(l="@id"in r?r["@id"]:r.id),l},Te=i=>{var r,l,s,d,h,g,v,y,E,x,S,C,k,A,T;let R,$={};if(Uo(i))R=i;else{let P=JSON.parse((0,I.o0)(i));switch(null==P?void 0:P.type){case"SpecificResource":$={manifest:R=null==(s=null==(l=null==(r=null==P?void 0:P.target)?void 0:r.partOf)?void 0:l[0])?void 0:s.id,canvas:null==(d=null==P?void 0:P.target)?void 0:d.id},null!=P&&P.selector&&($.selector=P.selector);break;case"Range":case"Annotation":$={manifest:R=null==(v=null==(g=null==(h=null==P?void 0:P.target)?void 0:h.partOf)?void 0:g[0])?void 0:v.id,canvas:null==(y=null==P?void 0:P.target)?void 0:y.id},((null==(E=null==P?void 0:P.target)?void 0:E.type)==="SpecificResource"||null!=(x=null==P?void 0:P.target)&&x.selector)&&($.selector=P.target.selector);break;case"Canvas":if($={manifest:R=null==(C=null==(S=null==P?void 0:P.partOf)?void 0:S[0])?void 0:C.id,canvas:null==P?void 0:P.id},null!=(k=null==P?void 0:P.id)&&k.includes("#xywh=")){let[i,r]=P.id.split("#xywh=");$.canvas=i,$.selector={type:"FragmentSelector",value:`xywh=${r}`}}break;case"Manifest":R=null==P?void 0:P.id,$={collection:null==(T=null==(A=null==P?void 0:P.partOf)?void 0:A[0])?void 0:T.id,manifest:null==P?void 0:P.id};break;case"Collection":$={collection:R=null==P?void 0:P.id}}}return{resourceId:R,active:$}},No=i=>{let{resourceId:r,active:l}=Te(i);return l.collection||l.manifest||r},Vo=(i,r)=>{let l=r.items.map(i=>i.id),{active:s}=Te(i),d=s.canvas;return l.includes(d)?d:l[0]},Ho=(i,r)=>{let{active:l}=Te(i),s=l.manifest,d=r.items.filter(i=>"Manifest"===i.type).map(i=>i.id);return 0==d.length?null:d.includes(s)?s:d[0]},Wo=i=>{let{active:r}=Te(i);return r.selector},Uo=i=>{try{new URL(i)}catch{return!1}return!0};var e7=((s=e7||{}).TiledImage="tiledImage",s.SimpleImage="simpleImage",s);function an(i,r,l,s,d){if(!i)return;let h=1/r.width;s.forEach(r=>{if(!r.target)return;let s=et(r.target),{point:g,rect:v,svg:y}=s;if(v){let{x:r,y:s,w:g,h:y}=v;!function(i,r,l,s,d,h,g){let v=new R.Rect(r,l,s,d),y=document.createElement("div");if(h){let{backgroundColor:i,opacity:r,borderType:l,borderColor:s,borderWidth:d}=h;y.style.backgroundColor=i,y.style.opacity=r,y.style.border=`${l} ${d} ${s}`,y.className=g}i.addOverlay(y,v)}(i,r*h,s*h,g*h,y*h,l,d)}if(g){let{x:r,y:s}=g,v=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${r}" cy="${s}" r="20" />
        </svg>
      `;pt(i,v,l,h,d)}y&&pt(i,y,l,h,d)})}function sn(i,r,l){let s,d,h=40,g=40;r.rect&&(s=r.rect.x,d=r.rect.y,h=r.rect.w,g=r.rect.h),r.point&&(s=r.point.x,d=r.point.y);let v=1/i.width;return new R.Rect(s*v-h*v/2*(l-1),d*v-g*v/2*(l-1),h*v*l,g*v*l)}function pt(i,r,l,s,d){let h=function(i){if(!i)return null;let r=document.createElement("template");return r.innerHTML=i.trim(),r.content.children[0]}(r);if(h)for(let r of h.children)!function ln(i,r,l,s,d){var h;if("#text"===r.nodeName)r.textContent&&(r.textContent.includes(`
`)||console.log("nodeName:",r.nodeName,", textContent:",r.textContent,", childNodes.length",r.childNodes.length));else{let g=function(i,r,l){let s=!1,d=!1,h=!1,g=!1,v=document.createElementNS("http://www.w3.org/2000/svg",i.nodeName);if(i.attributes.length>0)for(let r=0;r<i.attributes.length;r++){let l=i.attributes[r];switch(l.name){case"fill":h=!0;break;case"stroke":s=!0;break;case"stroke-width":d=!0;break;case"fill-opacity":g=!0}v.setAttribute(l.name,l.textContent)}return s||(v.style.stroke=null==r?void 0:r.borderColor),d||(v.style.strokeWidth=null==r?void 0:r.borderWidth),h||(v.style.fill=null==r?void 0:r.backgroundColor),g||(v.style.fillOpacity=null==r?void 0:r.opacity),v.setAttribute("transform",`scale(${l})`),v}(r,l,s),v=Do(i);v.node().append(g),null==(h=v._svg)||h.setAttribute("class",d),r.childNodes.forEach(r=>{ln(i,r,l,s,d)})}}(i,r,l,s,d)}let Qo=i=>{let r=Array.isArray(null==i?void 0:i.service)&&(null==i?void 0:i.service.length)>0,l=r?Bo(null==i?void 0:i.service):null==i?void 0:i.id,s=r?e7.TiledImage:e7.SimpleImage;return{uri:l,imageType:s}},Yo=(i,r)=>{let l=r?e7.TiledImage:e7.SimpleImage;return{uri:i,imageType:l}};function cn(i,r){if(!i)return;r.startsWith(".")||(r="."+r);let l=document.querySelectorAll(r);l&&l.forEach(r=>i.removeOverlay(r))}function je(i,r,l,s){let d=et(l),{point:h,rect:g,svg:v}=d;if(h||g||v){let l=sn(s,d,r);null==i||i.viewport.fitBounds(l)}}let Xo=(i,r,l,s)=>{var d;let h;if(!r||!i||!l||("FragmentSelector"===i.type&&i.value?h=`${l.id}#${i.value}`:"PointSelector"===i.type?h={source:l.id,selector:{type:"PointSelector",x:i.x,y:i.y}}:"SvgSelector"===i.type&&(h={source:l.id,selector:{type:"SvgSelector",value:i.value}}),!h))return;let g=et(h);if(!g)return;let v=(null==(d=null==s?void 0:s.annotationOverlays)?void 0:d.zoomLevel)||2,y=sn(l,g,v);y&&r.viewport.fitBounds(y)},Ko=async(i,r)=>{let l=i.get({id:r,type:"Canvas"});if(!(null!=l&&l.annotations)||!l.annotations[0])return[];let s=i.get(l.annotations).filter(i=>!!i.items&&i),d=[];for(let r of s)if(r.items.length>0){let i=r.label||{none:["Annotations"]};d.push({...r,label:i})}else{let l={};try{l=await i.load(r.id)}catch(i){console.log(i)}if(l.items&&l.items.length>0){let i=l.label||{none:["Annotations"]};d.push({...l,label:i})}}return d},dn=async(i,r,l,s)=>{let d;if(null==s||null==s.q)return{label:{none:[l]}};let h=`${r}?q=${s.q.trim()}`;try{d=await i.load(h)}catch{return console.log("Could not load content search."),{}}return null==d.label&&(d.label={none:[l]}),d},un=(i,r,l,s)=>{var d,h;let g={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]};if(g.canvas=i.get(r),g.canvas&&(g.annotationPage=i.get(g.canvas.items[0]),g.accompanyingCanvas=null!=(d=g.canvas)&&d.accompanyingCanvas?i.get(null==(h=g.canvas)?void 0:h.accompanyingCanvas):void 0),g.annotationPage){let d=i.get(g.annotationPage.items).map(r=>({body:i.get(r.body[0].id),motivation:r.motivation,type:"Annotation"})),h=[];d.forEach(r=>{"Choice"===r.body.type?r.body.items.forEach(l=>h.push({...r,id:l.id,body:i.get(l.id)})):h.push(r)}),g.annotations=h.filter(d=>{if(d){if(!d.body||!d.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",d);return}let h=d.body;Array.isArray(h)&&(h=h[0]);let g=i.get(h.id);if(g)switch(l){case"painting":return d.target===r.id&&d.motivation&&"painting"===d.motivation[0]&&s.includes(g.type)&&(d.body=g),!!d;case"supplementing":return;default:throw Error("Invalid annotation motivation.")}}})}return g},pe=(i,r="en")=>{if(!i)return"";if(!i[r]){let r=Object.getOwnPropertyNames(i);if(r.length>0)return i[r[0]]}return i[r]},ue=(i,r)=>{let l=un(i,{id:r,type:"Canvas"},"painting",["Image","Sound","Video"]);if(0!==l.annotations.length&&l.annotations&&l.annotations)return l.annotations.map(i=>null==i?void 0:i.body)},ea=(i,r,l,s)=>{let d=[];if(r.canvas&&r.canvas.thumbnail.length>0){let l=i.get(r.canvas.thumbnail[0]);d.push(l)}if(r.annotations[0]){if(r.annotations[0].thumbnail&&r.annotations[0].thumbnail.length>0){let l=i.get(r.annotations[0].thumbnail[0]);d.push(l)}if(!r.annotations[0].body)return;let l=r.annotations[0].body;"Image"===l.type&&d.push(l)}return 0===d.length?void 0:{id:d[0].id,format:d[0].format,type:d[0].type,width:l,height:s}},e9={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:te,css:tt,keyframes:ta,createTheme:ti}=(0,P.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(209 100% 38.2%)",accentMuted:"hsl(209 80% 61.8%)",accentAlt:"hsl(209 80% 30%)",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:e9}),tr=te("div",{display:"flex",flexDirection:"column",alignItems:"center"}),to=te("p",{fontWeight:"bold",fontSize:"x-large"}),tc=te("span",{fontSize:"medium"}),nt=({error:i})=>{let{message:r}=i;return x.createElement(tr,{role:"alert"},x.createElement(to,{"data-testid":"headline"},"Something went wrong"),r&&x.createElement(tc,null,`Error message: ${r}`," "))},td=te("div",{position:"relative",zIndex:"0"}),tu=te("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden"}),tm=te("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"100%",height:"100%","&[data-aside-active='true']":{width:"61.8%","@sm":{width:"0",opacity:"0"}},"&[data-aside-toggle='false']":{"@sm":{width:"100% !important",opacity:"1 !important"}}}),tp=te("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"0",maxHeight:"100%","&[data-aside-active='true']":{width:"38.2%","@sm":{width:"100%"}},"&[data-aside-toggle='false']":{"@sm":{width:"0 !important"}}}),th=te("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${tu}`]:{flexGrow:"1"},[`& ${tm}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{}}}),tf=te(L.fC,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),tg=te(L.aV,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),tv=te(L.xz,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&[data-value='manifest-back']":{display:"none;","@sm":{display:"block"}},"&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),ty=te(L.VY,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),tb=te(({handleScroll:i,children:r,className:l})=>x.createElement("div",{className:l,onScroll:i},r),{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),tE={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},tw=te("button",{textAlign:"left","&:hover":{color:"$accent"}}),tx=te("div",{display:"flex",flexDirection:"column",width:"100%"}),tS=te("div",{...tE}),tC=te("div",{"&:hover":{color:"$accent"}}),ht=({value:i,handleClick:r})=>x.createElement(tw,{onClick:r},i),ha=({value:i,handleClick:r})=>x.createElement(tC,{dangerouslySetInnerHTML:{__html:i},onClick:r}),ga=()=>{function e(i){return i.map(i=>{let r=i.identifier||(0,k.Z)();return{...i,identifier:r}})}return{addIdentifiersToParsedCues:e,createNestedCues:function(i){var r;let l=[],s=[],d=e(i);for(let i of d){for(;s.length>0&&s[s.length-1].end<=i.start;)s.pop();s.length>0?(s[s.length-1].children||(s[s.length-1].children=[]),null==(r=s[s.length-1].children)||r.push(i)):l.push(i),s.push(i)}return l},isChild:function(i,r=[]){return r.some(r=>i.start>=r.start&&i.end<=r.end)},orderCuesByTime:function(i=[]){return i.sort((i,r)=>i.start-r.start)}}},tk=ta({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),tI=te(_.fC,{display:"flex",flexDirection:"column",width:"100%"}),tA=te(_.ck,{...tE,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:tk,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:tk,boxSizing:"content-box","@sm":{content:"unset"}}}}),Ea=i=>{for(;i&&i!==document.body;){let r=window.getComputedStyle(i).overflowY;if("visible"!==r&&"hidden"!==r&&i.scrollHeight>i.clientHeight)return i;i=i.parentNode}return null},ba=({label:i,start:r,end:l})=>{var s,d;let h=U(),{configOptions:g,isAutoScrollEnabled:v,isUserScrolling:y}=M(),E=null==(d=null==(s=null==g?void 0:g.informationPanel)?void 0:s.vtt)?void 0:d.autoScroll,[S,C]=(0,x.useState)(!1),k=(0,x.useRef)(null),I=document.getElementById("clover-iiif-video");return(0,x.useEffect)(()=>(null==I||I.addEventListener("timeupdate",()=>{let{currentTime:i}=I;C(r<=i&&i<l)}),()=>document.removeEventListener("timeupdate",()=>{})),[l,r,I]),(0,x.useEffect)(()=>{var i,r;if(v&&S&&k.current&&!y){let l=k.current;if(l&&l instanceof HTMLElement){let s=Ea(l);if(s&&s instanceof HTMLElement){let d;switch(null==(i=null==E?void 0:E.settings)?void 0:i.block){case"center":let g=s.getBoundingClientRect();d=l.offsetTop+l.offsetHeight-Math.floor((g.bottom-g.top)/2);break;case"end":d=l.offsetTop+l.offsetHeight-(s.clientHeight-l.clientHeight)+2;break;default:d=l.offsetTop-2}h({type:"updateAutoScrolling",isAutoScrolling:!0}),s.scrollTo({top:d,left:0,behavior:null==(r=null==E?void 0:E.settings)?void 0:r.behavior}),setTimeout(()=>h({type:"updateAutoScrolling",isAutoScrolling:!1}),750)}}}},[E,S,y,v,h]),x.createElement(tA,{ref:k,"aria-checked":S,"data-testid":"information-panel-cue",onClick:()=>{I&&(I.pause(),I.currentTime=r,I.play())},value:i},i,x.createElement("strong",null,Kt(r)))},tT=te("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${tA}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),yn=({items:i})=>x.createElement(tT,null,i.map(i=>{let{text:r,start:l,end:s,children:d,identifier:h}=i;return x.createElement("li",{key:h},x.createElement(ba,{label:r,start:l,end:s}),d&&x.createElement(yn,{items:d}))})),wa=({label:i,vttUri:r})=>{let[l,s]=x.useState([]),{createNestedCues:d,orderCuesByTime:h}=ga(),[g,v]=x.useState();return(0,x.useEffect)(()=>{r&&fetch(r,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(i=>i.text()).then(i=>{let r=(0,F.parse)(i).cues,l=h(r),g=d(l);s(g)}).catch(i=>{console.error(r,i.toString()),v(i)})},[r]),x.createElement(tI,{"data-testid":"annotation-item-vtt","aria-label":`${pe(i)}`},g&&x.createElement("div",{"data-testid":"error-message"},"Network Error: ",g.toString()),x.createElement(yn,{items:l}))},xa=({caption:i,handleClick:r,imageUri:l})=>x.createElement(tw,{onClick:r},x.createElement("img",{src:l,alt:`A visual annotation for ${i}`}),x.createElement("span",null,i)),Ca=({annotation:i})=>{var r,l;let{target:s}=i,d=M(),{openSeadragonViewer:h,vault:g,activeCanvas:v,configOptions:y}=d,E=i.body.map(i=>g.get(i.id)),S=(null==(r=E.find(i=>i.format))?void 0:r.format)||"",C=(null==(l=E.find(i=>i.value))?void 0:l.value)||"",k=g.get({id:v,type:"Canvas"});function m(){var i;if(!s)return;let r=(null==(i=y.annotationOverlays)?void 0:i.zoomLevel)||1;je(h,r,s,k)}return x.createElement(tS,null,function(){var i,r;switch(S){case"text/plain":return x.createElement(ht,{value:C,handleClick:m});case"text/html":return x.createElement(ha,{value:C,handleClick:m});case"text/vtt":return x.createElement(wa,{label:E[0].label,vttUri:E[0].id||""});case null==(i=S.match(/^image\//))?void 0:i.input:let l=(null==(r=E.find(i=>{var r;return!(null!=(r=i.id)&&r.includes("vault://"))}))?void 0:r.id)||"";return x.createElement(xa,{caption:C,handleClick:m,imageUri:l});default:return x.createElement(ht,{value:C,handleClick:m})}}())},Ia=({annotationPage:i})=>{var r;let l=M(),{vault:s}=l;if(!i||!i.items||(null==(r=i.items)?void 0:r.length)===0)return x.createElement(x.Fragment,null);let d=i.items.map(i=>s.get(i.id));return d?x.createElement(tx,{"data-testid":"annotation-page"},null==d?void 0:d.map(i=>x.createElement(Ca,{key:i.id,annotation:i}))):x.createElement(x.Fragment,null)},tO=te("button",{textAlign:"left","&:hover":{color:"$accent"}}),tR=te("li",{margin:"0.25rem 0"}),t$=te("ol",{listStyleType:"auto",marginBottom:"1rem",listStylePosition:"inside"}),tM=te("div",{margin:"0.5rem 1.618rem"}),tz=te("div",{fontWeight:"bold"}),tP=te("div",{marginBottom:"1rem"}),_a=({value:i,handleClick:r,target:l,canvas:s})=>x.createElement(tO,{onClick:r,"data-target":l,"data-canvas":s},i),Pa=({annotation:i,activeContentSearchTarget:r,setActiveContentSearchTarget:l})=>{var s,d,h;let g,v;let y=U(),E=M(),{openSeadragonViewer:S,vault:C,contentSearchVault:k,activeCanvas:I,configOptions:A,OSDImageLoaded:T}=E,R=C.get({id:I,type:"Canvas"}),$=(null==(s=i.body.map(i=>k.get(i.id)).find(i=>i.value))?void 0:s.value)||"";if(i.target&&"string"==typeof i.target&&(g=i.target),g){let i=g.split("#xywh");i.length>1&&(v=i[0])}let P=(null==(h=null==(d=A.contentSearch)?void 0:d.overlays)?void 0:h.zoomLevel)||1;(0,x.useEffect)(()=>{T&&S&&i.target&&i.target==r&&je(S,P,g,R)},[S,T]);let L=JSON.stringify(g);return x.createElement(tR,null,x.createElement(_a,{target:L,canvas:v,value:$,handleClick:function(i){if(!S)return;let r=JSON.parse(i.target.dataset.target),s=i.target.dataset.canvas;I===s?je(S,P,g,R):(y({type:"updateOSDImageLoaded",OSDImageLoaded:!1}),y({type:"updateActiveCanvas",canvasId:s}),l(r))}}))},Oa=({annotationPage:i})=>{var r,l,s;let d=M(),{contentSearchVault:h,configOptions:g}=d,[v,y]=(0,x.useState)(),E=null==(r=g.contentSearch)?void 0:r.searchResultsLimit,S=null==(l=g.localeText)?void 0:l.contentSearch;return i&&i.items&&(null==(s=i.items)?void 0:s.length)!==0?x.createElement(x.Fragment,null,Object.entries(function(i){let r={};return i.items.forEach(i=>{let l=h.get(i.id),s="";if(l.label){let i=pe(l.label);i&&(s=i[0])}null==r[s]&&(r[s]=[]),r[s].push(l)}),r}(i)).map(([i,r],l)=>x.createElement("div",{key:l},x.createElement(tz,{className:"content-search-results-title"},i),x.createElement(t$,{className:"content-search-results"},(E?r.slice(0,E):r).map((i,r)=>x.createElement(Pa,{key:r,annotation:i,activeContentSearchTarget:v,setActiveContentSearchTarget:y}))),function(i){if(E){let r=i.length-E;if(r>0)return x.createElement(tP,null,r," ",null==S?void 0:S.moreResults)}}(r)))):x.createElement("p",null,null==S?void 0:S.noSearchResults)},tL=te("div",{".content-search-form":{display:"flex",marginBottom:"1rem"},input:{padding:".25rem",marginRight:"1rem"}}),t_=te("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Da=({searchServiceUrl:i,setContentSearchResource:r,setLoading:l})=>{var s;let[d,h]=(0,x.useState)(),g=M(),{contentSearchVault:v,openSeadragonViewer:y,configOptions:E}=g,S=null==(s=E.localeText)?void 0:s.contentSearch;async function c(s){s.preventDefault();let h=null==S?void 0:S.tabLabel;if(y&&i){if(!d||""===d.trim()){r({label:{none:[h]}});return}l(!0),dn(v,i,h,{q:d}).then(i=>{r(i),l(!1)})}}return x.createElement(tL,null,x.createElement(V.fC,{onSubmit:c,className:"content-search-form"},x.createElement(V.gN,{className:"FormField",name:"searchTerms",onChange:i=>{i.preventDefault(),h(i.target.value)}},x.createElement(V.oT,{placeholder:null==S?void 0:S.formPlaceholder})),x.createElement(V.k4,{asChild:!0},x.createElement(t_,{type:"submit"},x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},x.createElement("title",null,"Search"),x.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},za=({searchServiceUrl:i,setContentSearchResource:r,activeCanvas:l,annotationPage:s})=>{let[d,h]=(0,x.useState)(!1);return x.createElement(tM,null,x.createElement(Da,{searchServiceUrl:i,setContentSearchResource:r,activeCanvas:l,setLoading:h}),!d&&x.createElement(Oa,{annotationPage:s}),d&&x.createElement("span",null,"Loading..."))},tF=te("div",{width:"100%",padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),tD=te("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),En=(i,r="none")=>{if(!i)return null;if("string"==typeof i)return[i];if(!i[r]){let r=Object.getOwnPropertyNames(i);if(r.length>0)return i[r[0]]}return i[r]&&Array.isArray(i[r])?i[r]:null},q=(i,r="none",l=", ")=>{let s=En(i,r);return Array.isArray(s)?s.join(`${l}`):s};function J(i,r){let l=Object.keys(i).filter(i=>r.includes(i)?null:i),s={};return l.forEach(r=>{s[r]=i[r]}),s}let tV=te("span",{}),K=i=>{let{as:r,label:l}=i,s=J(i,["as","label"]);return x.createElement(tV,{as:r,...s},q(l,s.lang))},Ua=(i,r="200,",l="full")=>{let s;Array.isArray(i)&&(i=i[0]);let{id:d,service:h}=i;if(!h)return d;if(Array.isArray(i.service)&&i.service.length>0&&(s=h[0]),s){if(s["@id"])return`${s["@id"]}/${l}/${r}/0/default.jpg`;if(s.id)return`${s.id}/${l}/${r}/0/default.jpg`}},tN=te("img",{objectFit:"cover"}),qa=i=>{let r;let l=(0,x.useRef)(null),{contentResource:s,altAsLabel:d,region:h="full"}=i;d&&(r=q(d));let g=J(i,["contentResource","altAsLabel"]),{type:v,id:y,width:E=200,height:S=200,duration:C}=s;(0,x.useEffect)(()=>{if(!y&&!l.current||["Image"].includes(v)||!y.includes("m3u8"))return;let i=new j.ZP;return l.current&&(i.attachMedia(l.current),i.on(j.ZP.Events.MEDIA_ATTACHED,function(){i.loadSource(y)})),i.on(j.ZP.Events.ERROR,function(r,l){if(l.fatal)switch(l.type){case j.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${r} network error encountered, try to recover`),i.startLoad();break;case j.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${r} media error encountered, try to recover`),i.recoverMediaError();break;default:i.destroy()}}),()=>{i&&(i.detachMedia(),i.destroy())}},[y,v]);let k=(0,x.useCallback)(()=>{if(!l.current)return;let i=0,r=30;if(C&&(r=C),!y.split("#t=")&&C&&(i=.1*C),y.split("#t=").pop()){let r=y.split("#t=").pop();r&&(i=parseInt(r.split(",")[0]))}let s=l.current;s.autoplay=!0,s.currentTime=i,setTimeout(()=>k(),1e3*r)},[C,y]);(0,x.useEffect)(()=>k(),[k]);let I=Ua(s,`${E},${S}`,h);switch(v){case"Image":return x.createElement(tN,{as:"img",alt:r,css:{width:E,height:S},key:y,src:I,...g});case"Video":return x.createElement(tN,{as:"video",css:{width:E,height:S},disablePictureInPicture:!0,key:y,loop:!0,muted:!0,onPause:k,ref:l,src:y});default:return console.warn(`Resource type: ${v} is not valid or not yet supported in Primitives.`),x.createElement(x.Fragment,null)}},tj=te("a",{}),ja=i=>{let{children:r,homepage:l}=i,s=J(i,["children","homepage"]);return x.createElement(x.Fragment,null,l&&l.map(i=>{let l=q(i.label,s.lang);return x.createElement(tj,{"aria-label":r?l:void 0,href:i.id,key:i.id,...s},r||l)}))},tH={delimiter:", "},tB=(0,x.createContext)(void 0),bn=()=>{let i=(0,x.useContext)(tB);if(void 0===i)throw Error("usePrimitivesContext must be used with a PrimitivesProvider");return i},ot=({children:i,initialState:r=tH})=>{let l=Qa(r,"delimiter");return x.createElement(tB.Provider,{value:{delimiter:l}},i)},Qa=(i,r)=>Object.hasOwn(i,r)?i[r].toString():void 0,tU=te("span",{}),yt=i=>{let{as:r,markup:l}=i,{delimiter:s}=bn();if(!l)return x.createElement(x.Fragment,null);let d=J(i,["as","markup"]),h={__html:N(q(l,d.lang,s),{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})};return x.createElement(tU,{as:r,...d,dangerouslySetInnerHTML:h})},Sn=i=>x.useContext(tB)?x.createElement(yt,{...i}):x.createElement(ot,null,x.createElement(yt,{...i})),Za=({as:i="dd",lang:r,value:l})=>x.createElement(Sn,{markup:l,as:i,lang:r}),tq=te("span",{}),Ka=({as:i="dd",customValueContent:r,lang:l,value:s})=>{var d;let{delimiter:h}=bn(),g=null==(d=En(s,l))?void 0:d.map(i=>(0,x.cloneElement)(r,{value:i}));return x.createElement(tq,{as:i,lang:l},null==g?void 0:g.map((i,r)=>[r>0&&`${h}`,x.createElement(x.Fragment,{key:r},i)]))},wn=i=>{var r;let{item:l,lang:s,customValueContent:d}=i,{label:h,value:g}=l,v=null==(r=q(h))?void 0:r.replace(" ","-").toLowerCase();return x.createElement("div",{role:"group","data-label":v},x.createElement(K,{as:"dt",label:h,lang:s}),d?x.createElement(Ka,{as:"dd",customValueContent:d,value:g,lang:s}):x.createElement(Za,{as:"dd",value:g,lang:s}))},tW=te("dl",{}),ni=i=>{let{as:r,customValueContent:l,metadata:s}=i;if(!Array.isArray(s))return x.createElement(x.Fragment,null);let d=tn(i,"customValueDelimiter"),h=J(i,["as","customValueContent","customValueDelimiter","metadata"]);return x.createElement(ot,{..."string"==typeof d?{initialState:{delimiter:d}}:void 0},s.length>0&&x.createElement(tW,{as:r,...h},s.map((i,r)=>{let s=l?function(i,r){let l=r.filter(r=>{let{matchingLabel:l}=r,s=Object.keys(r.matchingLabel)[0],d=q(l,s);if(q(i,s)===d)return!0}).map(i=>i.Content);if(Array.isArray(l))return l[0]}(i.label,l):void 0;return x.createElement(wn,{customValueContent:s,item:i,key:r,lang:null==h?void 0:h.lang})})))};te("li",{}),te("ul",{});let tZ=te("li",{}),tJ=te("ul",{}),ai=i=>{let{as:r,rendering:l}=i,s=J(i,["as","rendering"]);return x.createElement(tJ,{as:r},l&&l.map(i=>{let r=q(i.label,s.lang);return x.createElement(tZ,{key:i.id},x.createElement("a",{href:i.id,...s,target:"_blank"},r||i.id))}))},tG=te("dl",{}),si=i=>{let{as:r,requiredStatement:l}=i;if(!l)return x.createElement(x.Fragment,null);let s=tn(i,"customValueDelimiter"),d=J(i,["as","customValueDelimiter","requiredStatement"]);return x.createElement(ot,{..."string"==typeof s?{initialState:{delimiter:s}}:void 0},x.createElement(tG,{as:r,...d},x.createElement(wn,{item:l,lang:d.lang})))},tK=te("li",{}),tQ=te("ul",{}),di=i=>{let{as:r,seeAlso:l}=i,s=J(i,["as","seeAlso"]);return x.createElement(tQ,{as:r},l&&l.map(i=>{let r=q(i.label,s.lang);return x.createElement(tK,{key:i.id},x.createElement("a",{href:i.id,...s},r||i.id))}))},ui=i=>{let{as:r,summary:l}=i,s=J(i,["as","customValueDelimiter","summary"]);return x.createElement(Sn,{as:r,markup:l,...s})},xn=i=>{let{thumbnail:r,region:l}=i,s=J(i,["thumbnail"]);return x.createElement(x.Fragment,null,r&&r.map(i=>x.createElement(qa,{contentResource:i,key:i.id,region:l,...s})))},mi=({homepage:i})=>(null==i?void 0:i.length)===0?x.createElement(x.Fragment,null):x.createElement(x.Fragment,null,x.createElement("span",{className:"manifest-property-title"},"Homepage"),x.createElement(ja,{homepage:i})),fi=({id:i,htmlLabel:r,parent:l="manifest"})=>x.createElement(x.Fragment,null,x.createElement("span",{className:"manifest-property-title"},r),x.createElement("a",{href:i,target:"_blank",id:`iiif-${l}-id`},i)),pi=({metadata:i,parent:r="manifest"})=>i?x.createElement(x.Fragment,null,x.createElement(ni,{metadata:i,id:`iiif-${r}-metadata`})):x.createElement(x.Fragment,null),hi=({rendering:i})=>(null==i?void 0:i.length)===0?x.createElement(x.Fragment,null):x.createElement(x.Fragment,null,x.createElement("span",{className:"manifest-property-title"},"Alternate formats"),x.createElement(ai,{rendering:i})),gi=({requiredStatement:i,parent:r="manifest"})=>i?x.createElement(x.Fragment,null,x.createElement(si,{requiredStatement:i,id:`iiif-${r}-required-statement`})):x.createElement(x.Fragment,null),vi=({rights:i})=>i?x.createElement(x.Fragment,null,x.createElement("span",{className:"manifest-property-title"},"Rights"),x.createElement("a",{href:i,target:"_blank"},i)):x.createElement(x.Fragment,null),yi=({seeAlso:i})=>(null==i?void 0:i.length)===0?x.createElement(x.Fragment,null):x.createElement(x.Fragment,null,x.createElement("span",{className:"manifest-property-title"},"See Also"),x.createElement(di,{seeAlso:i})),Ei=({summary:i,parent:r="manifest"})=>i?x.createElement(x.Fragment,null,x.createElement(ui,{summary:i,as:"p",id:`iiif-${r}-summary`})):x.createElement(x.Fragment,null),bi=({label:i,thumbnail:r})=>(null==r?void 0:r.length)===0?x.createElement(x.Fragment,null):x.createElement(x.Fragment,null,x.createElement(xn,{altAsLabel:i||{none:["resource"]},thumbnail:r,style:{backgroundColor:"#6663",objectFit:"cover"}})),Si=()=>{let i=M(),{activeManifest:r,vault:l}=i,[s,d]=(0,x.useState)(),[h,g]=(0,x.useState)([]),[v,y]=(0,x.useState)([]),[E,S]=(0,x.useState)([]),[C,k]=(0,x.useState)([]);return(0,x.useEffect)(()=>{var i,s,h,v;let E=l.get(r);d(E),(null==(i=E.homepage)?void 0:i.length)>0&&g(l.get(E.homepage)),(null==(s=E.seeAlso)?void 0:s.length)>0&&y(l.get(E.seeAlso)),(null==(h=E.rendering)?void 0:h.length)>0&&S(l.get(E.rendering)),(null==(v=E.thumbnail)?void 0:v.length)>0&&k(l.get(E.thumbnail))},[r,l]),s?x.createElement(tD,null,x.createElement(tF,null,x.createElement(bi,{thumbnail:C,label:s.label}),x.createElement(Ei,{summary:s.summary}),x.createElement(pi,{metadata:s.metadata}),x.createElement(gi,{requiredStatement:s.requiredStatement}),x.createElement(vi,{rights:s.rights}),x.createElement(mi,{homepage:h}),x.createElement(yi,{seeAlso:v}),x.createElement(hi,{rendering:E}),x.createElement(fi,{id:s.id,htmlLabel:"IIIF Manifest"}))):x.createElement(x.Fragment,null)},Ci=({activeCanvas:i,annotationResources:r,searchServiceUrl:l,setContentSearchResource:s,contentSearchResource:d})=>{let{t:h}=(0,E.$G)(),g=U(),v=M(),{isAutoScrolling:y,isUserScrolling:S,vault:C,configOptions:k,plugins:I}=v,{informationPanel:A}=k,[T,R]=(0,x.useState)(),P=null==A?void 0:A.renderAbout,L=null==A?void 0:A.renderAnnotation,_=C.get({id:i,type:"Canvas"}),F=null==A?void 0:A.renderContentSearch,V=null==A?void 0:A.renderToggle,N=[...P?["manifest-about"]:[],...F&&l?["manifest-content-search"]:[],...L&&r?r.map(i=>i.id):[]],{pluginsWithInfoPanel:j}=function(i){let r=[];return i.forEach(i=>{var l;null!=(l=i.informationPanel)&&l.component&&r.push(i)}),{pluginsWithInfoPanel:r}}(I);return(0,x.useEffect)(()=>{if(null!=A&&A.defaultTab)switch(null==A?void 0:A.defaultTab){case"manifest-annotations":r&&(null==r?void 0:r.length)>0&&R(r[0].id);break;case"manifest-content-search":R("manifest-content-search");break;default:R("manifest-about")}else N&&N.length>0&&R(N[0])},[]),x.createElement(tf,{"data-testid":"information-panel",defaultValue:T,onValueChange:i=>{R(i)},orientation:"horizontal",value:T,className:"clover-viewer-information-panel"},x.createElement(tg,{"aria-label":h("informationPanelTabs"),"data-testid":"information-panel-list"},V&&x.createElement(tv,{value:"manifest-back","data-value":"manifest-back",onClick:()=>{g({type:"updateInformationOpen",isInformationOpen:!1})},as:"button"},h("informationPanelTabsClose")),P&&x.createElement(tv,{value:"manifest-about"},x.createElement(x.Fragment,null),h("informationPanelTabsAbout")),F&&d&&x.createElement(tv,{value:"manifest-content-search"},x.createElement(K,{label:d.label})),L&&r&&r.map((i,r)=>x.createElement(tv,{key:r,value:i.id},x.createElement(K,{label:i.label}))),j&&j.map((i,r)=>{var l;return x.createElement(tv,{key:r,value:i.id},x.createElement(K,{label:null==(l=i.informationPanel)?void 0:l.label}))})),x.createElement(tb,{handleScroll:function(){if(!y){clearTimeout(S);let i=setTimeout(()=>{g({type:"updateUserScrolling",isUserScrolling:void 0})},1500);g({type:"updateUserScrolling",isUserScrolling:i})}}},P&&x.createElement(ty,{value:"manifest-about"},x.createElement(Si,null)),F&&d&&x.createElement(ty,{value:"manifest-content-search"},x.createElement(za,{searchServiceUrl:l,setContentSearchResource:s,activeCanvas:i,annotationPage:d})),L&&r&&r.map(i=>x.createElement(ty,{key:i.id,value:i.id},x.createElement(Ia,{annotationPage:i}))),j&&j.map((i,r)=>(function(i,r){var l,s;let d=null==(l=null==i?void 0:i.informationPanel)?void 0:l.component;return void 0===d?x.createElement(x.Fragment,null):x.createElement(ty,{key:r,value:i.id},x.createElement($.ErrorBoundary,{FallbackComponent:nt},x.createElement(d,{...null==(s=null==i?void 0:i.informationPanel)?void 0:s.componentProps,canvas:_,useViewerDispatch:U,useViewerState:M})))})(i,r))))},tY=te("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),D=i=>x.createElement(tY,{...i,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},i.children);D.Title=({children:i})=>x.createElement("title",null,i),D.Add=()=>x.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),D.Audio=()=>x.createElement(x.Fragment,null,x.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),x.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),x.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),D.Close=()=>x.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),D.Download=()=>x.createElement(x.Fragment,null,x.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),x.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),D.Image=()=>x.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),D.Video=()=>x.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"});let tX=ta({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),t0=ta({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),t1=te(H.Eh,{fill:"$secondaryAlt"}),t2=te(H.x8,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),t4=te(H.VY,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:t0},'&[data-side="bottom"]':{animationName:tX},'&[data-align="end"]':{[`& ${t1}`]:{margin:"0 0.7rem"}}}),t3=te(H.xz,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),t5=te(H.fC,{boxSizing:"content-box"}),ae=({children:i})=>x.createElement(t5,null,i);ae.Trigger=i=>x.createElement(t3,{...i},i.children),ae.Content=i=>x.createElement(t4,{...i,sideOffset:5,collisionPadding:21},x.createElement(t1,null),x.createElement(t2,null,x.createElement(D,{isSmall:!0},x.createElement(D.Close,null))),i.children);let t6=te("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"2px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${tY}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),t8=te("span",{background:"transparent",opacity:"0",border:"3px solid transparent",position:"absolute",width:"100%",height:"100%",zIndex:"0",left:"0",top:"0",transition:"$all"}),t7=te("span",{display:"flex"}),t9=te("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),ne=te("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),na=te("div",{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${t7}`]:{position:"absolute",right:"0",bottom:"0",[`& ${t6}`]:{display:"none",margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}),nr=te(_.ck,{display:"flex",flexShrink:"0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left",figure:{margin:"0",width:"161.8px",figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}}}),no=te(_.fC,{display:"flex",flexDirection:"row",flexGrow:"1",overflowX:"scroll",position:"relative",zIndex:"0",gap:"1rem",padding:"1.618rem 0"}),nc=te("div",{display:"flex",flexDirection:"row","&[data-active='true']":{[`& ${nr}`]:{figcaption:{fontWeight:"700"},[`& ${t6}`]:{backgroundColor:"$accent"},[`& ${t8}`]:{background:"#0003",opacity:"1",borderBottom:"3px solid $accent"},"&:first-of-type":{[`& ${t8}`]:{borderRight:"unset"}},"&:last-of-type":{[`& ${t8}`]:{borderLeft:"unset"}}}},[`& ${nr}`]:{[`& ${na}`]:{borderRadius:"unset"},"&:first-of-type":{[`& ${na}`]:{borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"}},"&:last-of-type":{[`& ${na}`]:{borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},[`& ${t6}`]:{display:"flex"}}}}),nd=te("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),nu=te("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),nm=te("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),np=te("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem",fontWeight:"bold",gap:"0.25rem",em:{opacity:"0.25"}}}),nh=te("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${nd}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),ji=(i,r)=>{(0,x.useEffect)(()=>{function n(l){l.key===i&&r()}return window.addEventListener("keyup",n),()=>window.removeEventListener("keyup",n)},[])},Ji=({title:i})=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},x.createElement("title",null,i),x.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),Qi=({title:i})=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},x.createElement("title",null,i),x.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),Yi=({title:i})=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},x.createElement("title",null,i),x.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Zi=({title:i})=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},x.createElement("title",null,i),x.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),Xi=({handleCanvasToggle:i,handleFilter:r,activeIndex:l,canvasLength:s})=>{let[d,h]=(0,x.useState)(!1),[g,v]=(0,x.useState)(!1),[y,S]=(0,x.useState)(!1),{t:C}=(0,E.$G)();return(0,x.useEffect)(()=>{S(0===l),l===s-1?v(!0):v(!1)},[l,s]),ji("Escape",()=>{h(!1),r("")}),x.createElement(nh,{isToggle:d},x.createElement(nd,null,d&&x.createElement(nu,{autoFocus:!0,onChange:i=>r(i.target.value),placeholder:C("commonSearchPlaceholder")}),!d&&x.createElement(np,null,x.createElement(nm,{onClick:()=>i(-1),disabled:y,type:"button"},x.createElement(Ji,{title:C("commonPrevious")})),x.createElement("span",null,l+1," ",x.createElement("em",null,"/")," ",s),x.createElement(nm,{onClick:()=>i(1),disabled:g,type:"button"},x.createElement(Qi,{title:C("commonNext")}))),x.createElement(nm,{onClick:()=>{h(i=>!i),r("")},type:"button",className:"clover-viewer-media-search"},d?x.createElement(Yi,{title:C("commonClose")}):x.createElement(Zi,{title:C("commonSearch")}))))},Ki=({type:i})=>{switch(i){case"Sound":return x.createElement(D.Audio,null);case"Image":default:return x.createElement(D.Image,null);case"Video":return x.createElement(D.Video,null)}},es=({canvas:i,canvasIndex:r,isActive:l,thumbnail:s,type:d,handleChange:h})=>{let g=null!=i&&i.label?pe(i.label):(r+1).toString();return x.createElement(nr,{"aria-checked":l,"data-testid":"media-thumbnail","data-canvas":r,onClick:()=>h(i.id),value:i.id},x.createElement("figure",null,x.createElement(na,null,(null==s?void 0:s.id)&&x.createElement(B.LazyLoadImage,{src:s.id,alt:g,loading:"lazy"}),x.createElement(t8,null),x.createElement(t7,null,x.createElement(t6,{isIcon:!0,"data-testid":"thumbnail-tag"},x.createElement(t9,null),x.createElement(D,{"aria-label":d},x.createElement(Ki,{type:d})),["Video","Sound"].includes(d)&&x.createElement(ne,null,Kt(i.duration))))),x.createElement("figcaption",{"data-testid":"fig-caption"},i.label?x.createElement(K,{label:i.label}):(r+1).toString())))},ts=i=>i.body?i.body.type:"Image",ns=({items:i})=>{let{t:r}=(0,E.$G)(),l=U(),s=M(),{activeCanvas:d,vault:h,sequence:g}=s,[v,y]=(0,x.useState)(""),[S,C]=(0,x.useState)([]),[k,I]=(0,x.useState)(0),A=x.useRef(null),p=i=>{d!==i&&l({type:"updateActiveCanvas",canvasId:i})};return(0,x.useEffect)(()=>{if(!S.length){let r=["Image","Sound","Video"],l=i.map(i=>un(h,i,"painting",r)).filter(i=>i.annotations.length>0);C(l)}},[i,S.length,h]),(0,x.useEffect)(()=>{S.forEach((i,r)=>{null!=i&&i.canvas&&i.canvas.id===d&&I(r)})},[d,S]),(0,x.useEffect)(()=>{let i=document.querySelector(`[data-canvas="${k}"]`);if(i instanceof HTMLElement&&A.current){let r=i.offsetLeft-A.current.offsetWidth/2+i.offsetWidth/2;A.current.scrollTo({left:r,behavior:"smooth"})}},[k]),x.createElement(x.Fragment,null,x.createElement(Xi,{handleFilter:i=>y(i),handleCanvasToggle:i=>{let r=g[1].findIndex(i=>i.includes(k)),l=r+i>=0?r+i:g[1].length-1;if(!g[1][l])return;let s=g[1][l][0],d=g[0][s].id;d&&p(d)},activeIndex:k,canvasLength:i.length}),x.createElement(no,{"aria-label":r("media.selectItem"),"data-testid":"media","data-active-canvas":i[k].id,"data-canvas-length":i.length,"data-filter":v,ref:A},g[1].filter(i=>i.some(i=>{var r;let l=g[0][i].id,s=S.find(i=>{var r;return(null==(r=null==i?void 0:i.canvas)?void 0:r.id)===l});if(!s)return!1;let d=q(null==(r=null==s?void 0:s.canvas)?void 0:r.label)||"";return!(v&&!d.toLowerCase().includes(v.toLowerCase()))})).map((i,r)=>{let l=i.map(i=>g[0][i].id).includes(d);return x.createElement(nc,{"data-active":l,key:r},i.map(i=>{var r,l;let s=g[0][i].id,v=S.find(i=>{var r;return(null==(r=null==i?void 0:i.canvas)?void 0:r.id)===s});return v?x.createElement(es,{canvas:v.canvas,canvasIndex:S.findIndex(i=>i===v),handleChange:p,isActive:d===(null==(r=null==v?void 0:v.canvas)?void 0:r.id),key:null==(l=null==v?void 0:v.canvas)?void 0:l.id,thumbnail:ea(h,v,200,200),type:ts(v.annotations[0])}):null}))})))},nf=te("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all",opacity:1,display:"flex",alignItems:"center",justifyContent:"center",img:{width:"100%",height:"100%",objectFit:"contain",color:"transparent",aspectRatio:"auto"},"&[data-paged=true]":{"img:first-child ":{objectPosition:"100% 50%"},"img:last-child":{objectPosition:"0 50%"}},"&[data-active=false]":{opacity:0,objectPosition:"50% 50%"},variants:{isMedia:{true:{cursor:"pointer"}}}}),ng=te("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),nv=te(ng,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),ny=te("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${nv}`]:{backgroundColor:"$accent"},[`${nf}`]:{backgroundColor:"#6662"}}}),nb=te("div",{width:"100%",height:"100%"}),nE=te("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),nw=te(W.xz,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),nx=te(W.VY,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),nS=te(W.ck,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),nC=te(W.__,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),nk=te(W.fC,{position:"relative",zIndex:"5",width:"100%"}),Fe=({direction:i,title:r})=>x.createElement(nE,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},x.createElement("title",null,r),"up"===i&&x.createElement(()=>x.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),null),"down"===i&&x.createElement(()=>x.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),null)),_n=({children:i,label:r,maxHeight:l,onValueChange:s,value:d})=>x.createElement(nk,{onValueChange:s,value:d},x.createElement(nw,{"data-testid":"select-button"},x.createElement(W.ki,{"data-testid":"select-button-value"}),x.createElement(W.GV,null,x.createElement(Fe,{direction:"down",title:"select"}))),x.createElement(W.ue,null,x.createElement(nx,{css:{maxHeight:`${l} !important`},"data-testid":"select-content"},x.createElement(W.Pn,null,x.createElement(Fe,{direction:"up",title:"scroll up for more"})),x.createElement(W.Q_,null,x.createElement(W.DI,null,r&&x.createElement(nC,null,x.createElement(K,{"data-testid":"select-label",label:r})),i)),x.createElement(W.Jk,null,x.createElement(Fe,{direction:"down",title:"scroll down for more"}))))),Pn=i=>x.createElement(nS,{...i},i.thumbnail&&x.createElement(xn,{thumbnail:i.thumbnail}),x.createElement(W.S_,null,x.createElement(K,{label:i.label})),x.createElement(W.o6,null)),nI=te("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),nA=te("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),nT=te("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${nI}`]:{display:"block"}},false:{[`${nI}`]:{display:"none"}}}}}),se=({className:i,id:r,label:l,children:s})=>{let d=l.toLowerCase().replace(/\s/g,"-");return x.createElement(ng,{id:r,className:i,"data-testid":"openseadragon-button","data-button":d},x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${r}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},x.createElement("title",{id:`${r}-svg-title`},l),s))},nO=te("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),fs=()=>x.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),ps=()=>x.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),hs=()=>x.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),gs=()=>x.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),Et=()=>x.createElement(x.Fragment,null,x.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),x.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),vs=({_cloverViewerHasPlaceholder:i,config:r})=>{let l=M(),{activeCanvas:s,plugins:d,vault:h,openSeadragonViewer:g}=l,v=h.get({id:s,type:"Canvas"});return(0,x.useEffect)(()=>{if(!g)return;let i=g.viewport.getRotation();g.addHandler("home",()=>{g.viewport.setRotation(i)})},[g]),x.createElement(nO,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:i},r.showZoomControl&&x.createElement(x.Fragment,null,x.createElement(se,{id:r.zoomInButton,label:"zoom in"},x.createElement(fs,null)),x.createElement(se,{id:r.zoomOutButton,label:"zoom out"},x.createElement(ps,null))),r.showFullPageControl&&x.createElement(se,{id:r.fullPageButton,label:"full page"},x.createElement(hs,null)),r.showRotationControl&&x.createElement(x.Fragment,null,x.createElement(se,{id:r.rotateRightButton,label:"rotate right"},x.createElement(Et,null)),x.createElement(se,{id:r.rotateLeftButton,label:"rotate left"},x.createElement(Et,null))),r.showHomeControl&&x.createElement(se,{id:r.homeButton,label:"reset"},x.createElement(gs,null)),d.filter(i=>{var r;return null==(r=i.imageViewer)?void 0:r.controls}).map((i,r)=>{var l,s,d,h;let g=null==(s=null==(l=i.imageViewer)?void 0:l.controls)?void 0:s.component;return x.createElement(g,{key:r,...null==(h=null==(d=null==i?void 0:i.imageViewer)?void 0:d.controls)?void 0:h.componentProps,canvas:v,useViewerDispatch:U,useViewerState:M})}))};async function On(i,r=3,l=500){try{return await i()}catch(s){if(r<=0)throw s;return await new Promise(i=>setTimeout(i,l)),On(i,r-1,l)}}let ys=i=>new Promise(r=>setTimeout(r,i)),bt=async(i,r,l=3,s=300)=>{for(let d=0;d<l;d++){let l=r?r-1:0,d=i.getItemAt(l);if(d)return d;await ys(s)}throw Error("No base item found at index 0 after retries")},Es=({ariaLabel:i,config:r,uri:l,_cloverViewerHasPlaceholder:s,imageType:d,openSeadragonCallback:h})=>{let[g,v]=(0,x.useState)([]),[y,E]=(0,x.useState)([]),[S,C]=(0,x.useState)(),k=U(),I=(0,x.useRef)(!1);return(0,x.useEffect)(()=>(I.current||(I.current=!0,S||C(R(r))),()=>null==S?void 0:S.destroy()),[]),(0,x.useEffect)(()=>{S&&h&&h(S)},[S,h]),(0,x.useEffect)(()=>{S&&JSON.stringify(l)!==JSON.stringify(y)&&(S.forceRedraw(),E(l))},[S,y,l]),(0,x.useEffect)(()=>{y.length&&S&&(S.close(),(async()=>{switch(d){case"simpleImage":let i=1,r=0;for(let l=0;l<y.length;l++){let s=y[l];try{if(0!==l){let s=(await bt(S.world,l)).getBounds();r=s.x+s.width,i=s.height}S.addSimpleImage({url:s,x:r,y:0,height:i,success:()=>{"function"==typeof k&&k({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}}),v(i=>[...i,s])}catch(i){console.error(`Failed to load image at ${s}:`,i)}}break;case"tiledImage":{let i=1,r=0;for(let l=0;l<y.length;l++){let s=y[l];try{let d=await On(()=>zo(s),3,1e3);if(!d)throw Error(`No tile source for ${s}`);if(0!==l){let s=(await bt(S.world,l)).getBounds();r=s.x+s.width,i=s.height}S.addTiledImage({tileSource:d,x:r,y:0,height:i,success:()=>{"function"==typeof k&&k({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}}),v(i=>[...i,s])}catch(i){console.error(`Failed to load tile at ${s}:`,i)}}break}default:console.warn(`Unsupported imageType: "${d}"`)}})().catch(i=>console.error("Error drawing tiles",i)))},[y,d,S]),(0,x.useEffect)(()=>{if(g){let i=0,b=()=>{if(i<3){let r=null==S?void 0:S.world.getHomeBounds();r&&(null==S||S.viewport.fitBounds(r,!0)),i++,setTimeout(b,50)}};b()}},[g]),x.createElement(nT,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":r.id,hasNavigator:r.showNavigator},x.createElement(vs,{_cloverViewerHasPlaceholder:s,config:r}),r.showNavigator&&x.createElement(nI,{id:r.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),x.createElement(nA,{id:r.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...i&&{"aria-label":i}}))},Ss=({_cloverViewerHasPlaceholder:i=!1,body:r,instanceId:l,isTiledImage:s=!1,label:d,src:h="",openSeadragonCallback:g,openSeadragonConfig:v={}})=>{let y=l??(0,k.Z)(),E="string"==typeof d?d:q(d),S={id:`openseadragon-${y}`,navigatorId:`openseadragon-navigator-${y}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${y}`,homeButton:`reset-${y}`,rotateLeftButton:`rotateLeft-${y}`,rotateRightButton:`rotateRight-${y}`,zoomInButton:`zoomIn-${y}`,zoomOutButton:`zoomOut-${y}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1},...v},C=Array.isArray(r)?r:r?[r]:[],I=Array.isArray(h)?h:h?[h]:[],A=[],T=e7.SimpleImage;if(C.length){let i=C.map(Qo);A=i.map(i=>i.uri).filter(Boolean),T=i.some(i=>i.imageType===e7.TiledImage)?e7.TiledImage:e7.SimpleImage}else if(I.length){let i=I.map(i=>Yo(i,s));A=i.map(i=>i.uri).filter(Boolean),T=i.some(i=>i.imageType===e7.TiledImage)?e7.TiledImage:e7.SimpleImage}return A.length?x.createElement($.ErrorBoundary,{FallbackComponent:nt},x.createElement(Es,{_cloverViewerHasPlaceholder:i,ariaLabel:E,config:S,imageType:T,key:y,uri:A,openSeadragonCallback:g})):null},ws=({isActive:i,isMedia:r,items:l,setIsInteractive:s})=>{let{vault:d}=M(),[h,g]=(0,x.useState)([]),v=h.length>1;if((0,x.useEffect)(()=>{g([]);let i=l.map(i=>{let r=ue(d,i.id);if(!r)return null;let{id:l,width:s,height:h}=r[0];return l?{src:l,width:s||640,height:h||640,alt:i.label?pe(i.label):"placeholder image"}:null}).filter(i=>null!==i);i.length&&g(i)},[l,v]),!i||!h.length)return null;let y=h.map(i=>i.width/i.height*1),E=y.reduce((i,r)=>i+r,0);return x.createElement(nf,{onClick:()=>s(!0),isMedia:r,className:"clover-viewer-placeholder","data-active":i,"data-paged":v},h.map((i,r)=>{let l=y[r]/E*100;return x.createElement("img",{...i,key:r,alt:i.alt,style:{width:`${l}%`}})}))},nR=te("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),n$=x.forwardRef((i,r)=>{let l=x.useRef(null),s=(0,x.useCallback)(()=>{var i,s;if(null!=(i=r.current)&&i.currentTime&&(null==(s=r.current)?void 0:s.currentTime)>0)return;let d=r.current;if(!d)return;let h=new AudioContext,g=h.createMediaElementSource(d),v=h.createAnalyser(),y=l.current;if(!y)return;y.width=d.offsetWidth,y.height=d.offsetHeight;let E=y.getContext("2d");g.connect(v),v.connect(h.destination),v.fftSize=256;let x=v.frequencyBinCount,S=new Uint8Array(x);setInterval(function(){!function(i,r,l,s,d,h){let g=d/l*2.6,v,y=0;i.getByteFrequencyData(s),r.fillStyle="#000000",r.fillRect(0,0,d,h);for(let i=0;i<l;i++)v=2*s[i],r.fillStyle="rgba(78, 42, 132, 1)",r.fillRect(y,h-v,g,v),y+=g+6}(v,E,x,S,y.width,y.height)},20)},[r]);return x.useEffect(()=>{r&&r.current&&(r.current.onplay=s)},[s,r]),x.createElement(nR,{ref:l,role:"presentation"})}),nM=te("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),As=({resource:i,ignoreCaptionLabels:r})=>{let l=pe(i.label,"en");return Array.isArray(l)&&l.some(i=>r.includes(i))?null:x.createElement("track",{key:i.id,src:i.id,label:Array.isArray(l)?l[0]:l,srcLang:"en","data-testid":"player-track"})},nz=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Ts=({allSources:i,annotationResources:r,painting:l})=>{let[s,d]=x.useState(0),[h,g]=x.useState(),v=x.useRef(null),y=(null==l?void 0:l.type)==="Sound",E=M(),{activeCanvas:S,configOptions:C,vault:k}=E;return(0,x.useEffect)(()=>{if(!l.id||!v.current)return;if(null!=v&&v.current){let i=v.current;i.src=l.id,i.load()}if("m3u8"!==l.id.split(".").pop()&&l.format&&!nz.includes(l.format))return;let i=new j.ZP({xhrSetup:function(i,r){i.withCredentials=!!C.withCredentials}});return i.attachMedia(v.current),i.on(j.ZP.Events.MEDIA_ATTACHED,function(){i.loadSource(l.id)}),i.on(j.ZP.Events.ERROR,function(r,l){if(l.fatal)switch(l.type){case j.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${r} network error encountered, try to recover`),i.startLoad();break;case j.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${r} media error encountered, try to recover`),i.recoverMediaError();break;default:i.destroy()}}),()=>{if(i&&v.current){let r=v.current;i.detachMedia(),i.destroy(),r.currentTime=0}}},[C.withCredentials,l.id]),(0,x.useEffect)(()=>{var i,r,l,d;let h=k.get(S),v=null!=(i=h.accompanyingCanvas)&&i.id?ue(k,null==(r=h.accompanyingCanvas)?void 0:r.id):null,y=null!=(l=h.placeholderCanvas)&&l.id?ue(k,null==(d=h.placeholderCanvas)?void 0:d.id):null;v&&y?g(0===s?y[0].id:v[0].id):(v&&g(v[0].id),y&&g(y[0].id))},[S,s,k]),(0,x.useEffect)(()=>{if(null!=v&&v.current){let i=v.current;return null==i||i.addEventListener("timeupdate",()=>d(i.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),x.createElement(nM,{css:{backgroundColor:C.canvasBackgroundColor,maxHeight:C.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},x.createElement("video",{id:"clover-iiif-video",key:l.id,ref:v,controls:!0,height:l.height,width:l.width,crossOrigin:C.crossOrigin,poster:h,style:{maxHeight:C.canvasHeight,position:"relative",zIndex:"1"}},i.map(i=>x.createElement("source",{src:i.id,type:i.format,key:i.id})),(null==r?void 0:r.length)>0&&r.map(i=>{let r=[];return i.items.forEach(i=>{k.get(i.id).body.forEach(i=>{let l=k.get(i.id);r.push(l)})}),r.map(i=>x.createElement(As,{resource:i,ignoreCaptionLabels:C.ignoreCaptionLabels||[],key:i.id}))}),"Sorry, your browser doesn't support embedded videos."),y&&x.createElement(n$,{ref:v}))},Rs=()=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},x.createElement("title",{id:"close-svg-title"},"close"),x.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),$s=({isMedia:i})=>x.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},x.createElement("title",{id:"open-svg-title"},"open"),i?x.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):x.createElement(x.Fragment,null,x.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),x.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Ms=({handleToggle:i,isInteractive:r,isMedia:l})=>x.createElement(nv,{onClick:i,isInteractive:r,isMedia:l,"data-testid":"placeholder-toggle"},r?x.createElement(Rs,null):x.createElement($s,{isMedia:l})),_s=({activeCanvas:i,annotationResources:r,isMedia:l,painting:s,visibleCanvases:d})=>{var h,g,v,y;let[E,S]=x.useState(0),[C,k]=x.useState(!1),[I,A]=x.useState([]),[T,R]=x.useState([]),{configOptions:$,customDisplays:P,openSeadragonViewer:L,vault:_,viewerId:F}=M(),V=U(),N=_.get(i),j=T.length&&!C&&!l,H=(null==s?void 0:s.length)>1,B=`${F}-${$o(i+E+JSON.stringify(d))}`,W=P.find(r=>{var l;let d=!1,{canvasId:h,paintingFormat:g}=r.target;if(Array.isArray(h)&&h.length>0&&(d=h.includes(i)),Array.isArray(g)&&g.length>0){let i=(null==(l=s[E])?void 0:l.format)||"";d=!!(i&&g.includes(i))}return d}),G=[];null==(g=null==(h=r[0])?void 0:h.items)||g.forEach(i=>{let r=_.get(i.id);G.push(r)}),(0,x.useEffect)(()=>{var i;G&&L&&null!=(i=$.annotationOverlays)&&i.renderOverlays&&(cn(L,"annotation-overlay"),an(L,N,$.annotationOverlays,G,"annotation-overlay"))},[N,G,L,$]),(0,x.useEffect)(()=>{if(S(0),!l){let i=d.map(i=>{let r=i.id,l=ue(_,r);return l?l[E]:void 0}).filter(Boolean),r=d.map(i=>{var r;let l=i.id,s=_.get(l),d=null==(r=null==s?void 0:s.placeholderCanvas)?void 0:r.id;return d&&d?{id:d,label:null==s?void 0:s.label}:null}).filter(i=>null!==i);A(i),R(r)}},[i,d,l,N]);let Q=null==(v=null==W?void 0:W.display)?void 0:v.component;return x.createElement(ny,{className:"clover-viewer-painting"},x.createElement(nb,{style:{backgroundColor:$.canvasBackgroundColor,height:"auto"===$.canvasHeight?"100%":$.canvasHeight}},!!T.length&&!l&&x.createElement(Ms,{handleToggle:()=>k(!C),isInteractive:C,isMedia:l}),!!(null!=T&&T.length)&&!l&&x.createElement(ws,{isActive:!!j,isMedia:l,items:T,setIsInteractive:k}),!j&&!W&&(l?x.createElement(Ts,{allSources:s,painting:s[E],annotationResources:r}):s&&x.createElement(Ss,{_cloverViewerHasPlaceholder:!!(null!=T&&T.length),body:I,instanceId:B,key:B,openSeadragonCallback:i=>{i&&(null==L?void 0:L.id)!==`openseadragon-${B}`&&V({type:"updateOpenSeadragonViewer",openSeadragonViewer:i})},openSeadragonConfig:$.openSeadragon})),!j&&Q&&x.createElement(Q,{id:i,annotationBody:s[E],...null==W?void 0:W.display.componentProps})),H&&x.createElement(_n,{value:null==(y=s[E])?void 0:y.id,onValueChange:i=>{let r=s.findIndex(r=>r.id===i);S(r)},maxHeight:"200px"},null==s?void 0:s.map(i=>x.createElement(Pn,{value:null==i?void 0:i.id,key:null==i?void 0:i.id,label:null==i?void 0:i.label}))))},Ps=({activeCanvas:i,annotationResources:r,searchServiceUrl:l,setContentSearchResource:s,contentSearchResource:d,isAudioVideo:h,items:g,painting:v,visibleCanvases:y})=>{let{isInformationOpen:E,configOptions:S,sequence:C}=M(),{informationPanel:k}=S,I=(null==k?void 0:k.renderAnnotation)&&r.length>0&&!k.open,A=(null==k?void 0:k.renderAbout)&&E||I,T=null==k?void 0:k.renderToggle;return x.createElement(tu,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},x.createElement(tm,{"data-aside-active":A,"data-aside-toggle":T},x.createElement(_s,{activeCanvas:i,annotationResources:r,isMedia:h,painting:v,visibleCanvases:y}),C[1].length>1&&x.createElement(td,{className:"clover-viewer-media-wrapper"},x.createElement(ns,{items:g,activeItem:0}))),A&&x.createElement(tp,{"data-aside-active":A,"data-aside-toggle":T},x.createElement(Ci,{activeCanvas:i,annotationResources:r,searchServiceUrl:l,setContentSearchResource:s,contentSearchResource:d})))},nP=te(ae.Trigger,{width:"30px",padding:"5px"}),nL=te(ae.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),n_=te("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),nF=te("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${nk}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),nD=te("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),zs=()=>{var i;let r=U(),l=M(),{activeManifest:s,collection:d,configOptions:h,vault:g}=l,v=null==h?void 0:h.canvasHeight;return x.createElement("div",{style:{margin:"0.75rem"}},x.createElement(_n,{label:d.label,maxHeight:v,value:s,onValueChange:i=>{r({type:"updateActiveManifest",manifestId:i}),r({type:"updateViewerId",viewerId:(0,k.Z)()})}},null==(i=null==d?void 0:d.items)?void 0:i.map(i=>x.createElement(Pn,{value:i.id,key:i.id,thumbnail:null!=i&&i.thumbnail?g.get(null==i?void 0:i.thumbnail):void 0,label:i.label}))))},Bs=(i,r=2500)=>{let{t:l}=(0,E.$G)(),[s,d]=(0,x.useState)(""),h=(0,x.useCallback)(()=>{navigator.clipboard.writeText(i).then(()=>d(l("copySuccess")),()=>d(l("copyFailure")))},[i]);return(0,x.useEffect)(()=>{if(!s)return;let i=setTimeout(()=>d(""),r);return()=>clearTimeout(i)},[s]),[s,h]},nV=te("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",lineHeight:"1em"}),Vs=({status:i})=>i?x.createElement(nV,{"data-copy-status":i},i):null,St=({textPrompt:i,textToCopy:r})=>{let[l,s]=Bs(r);return x.createElement("button",{onClick:s},i," ",x.createElement(Vs,{status:l}))},Hs=({title:i})=>{let r="#ed1d33",l="#2873ab";return x.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},x.createElement("title",null,i),x.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},x.createElement("g",{transform:"scale(0.1)"},x.createElement("path",{style:{fill:l},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),x.createElement("path",{style:{fill:l},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),x.createElement("path",{style:{fill:r},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),x.createElement("path",{style:{fill:r},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),x.createElement("path",{style:{fill:l},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),x.createElement("path",{style:{fill:l},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),x.createElement("path",{style:{fill:r},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},nN=te(G.fC,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),nj=te(G.bU,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",span:{fontFamily:"monospace",fontSize:"0.8333rem",fontWeight:"700",display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center",color:"$primary",opacity:"0.382",userSelect:"none",pointerEvents:"none"},'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))",span:{opacity:"1",color:"$accent"}}});te("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"});let nH=te("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),nB=x.memo(()=>{let{isInformationOpen:i}=M(),r=U(),{t:l}=(0,E.$G)();return x.createElement(nH,null,x.createElement(nN,{checked:i,onCheckedChange:i=>{r({type:"updateInformationOpen",isInformationOpen:i})},id:"information-toggle","aria-label":l("informationPanelToggle"),name:"toggled?"},x.createElement(nj,null,x.createElement("span",null,"i"))))}),nU=te(ae.Trigger,{width:"30px",padding:"5px",marginBottom:"auto"}),nq=te(nL,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function wt(i,r){let l=[];if(!i)return l;for(let s of i)if(s.id){let i=r.get(s.id);i&&l.push(i)}return l}function xt(i,r){return i.map(({format:i,id:l,label:s})=>{let d=function(i){let{vault:r}=M();try{let l=i&&r.get(i);if(!l)throw Error(`Vault entity ${i} not found.`);return(null==l?void 0:l["@id"])||(null==l?void 0:l.id)}catch(r){return console.error(r),i}}(l);return{format:i,id:d,label:q(s)||r}})}let Ks=()=>{let{allPages:i,individualPages:r}=function(){let i=function(){let{activeCanvas:i,activeManifest:r,vault:l}=M(),[s,d]=(0,x.useState)({root:[],canvas:[]});return(0,x.useEffect)(()=>{let s=l.get(r),h=l.get(i),g=null==s?void 0:s.rendering,v=null==h?void 0:h.rendering,y=wt(g,l),E=wt(v,l);d({root:y,canvas:E})},[i,r,l]),{...s}}(),r=xt((null==i?void 0:i.root)||[],"Root Rendering Label"),l=xt((null==i?void 0:i.canvas)||[],"Canvas Rendering Label");return{allPages:r,individualPages:l}}(),l=i.length>0||r.length>0,o=i=>{window.open(i,"_blank")};return l?x.createElement(ae,null,x.createElement(nU,{"data-testid":"download-button"},x.createElement(D,null,x.createElement(D.Download,null))),x.createElement(nq,{"data-testid":"download-content"},r.length>0&&x.createElement(x.Fragment,null,x.createElement("h3",null,"Individual Pages"),x.createElement("ul",null,r.map(({format:i,id:r,label:l})=>x.createElement("li",{key:l},x.createElement("button",{onClick:()=>o(r)},l," (",i,")"))))),i.length>0&&x.createElement(x.Fragment,null,x.createElement("h3",null,"All Pages"),x.createElement("ul",null,i.map(({format:i,id:r,label:l})=>x.createElement("li",{key:l},x.createElement("button",{onClick:()=>o(r)},l," (",i,")"))))))):null},el=({manifestId:i,manifestLabel:r})=>{let l=M(),{collection:s,configOptions:d}=l,{informationPanel:h,showDownload:g,showIIIFBadge:v,showTitle:y}=d,S=g||v||(null==h?void 0:h.renderToggle),{t:C}=(0,E.$G)();return x.createElement(nF,{className:"clover-viewer-header"},null!=s&&s.items?x.createElement(zs,null):x.createElement(n_,{className:y?"":"visually-hidden"},y&&x.createElement(K,{label:r,className:"label"})),S&&x.createElement(nD,null,g&&x.createElement(Ks,null),v&&x.createElement(ae,null,x.createElement(nP,null,x.createElement(Hs,{title:C("commonShare")})),x.createElement(nL,null,(null==s?void 0:s.items)&&x.createElement("button",{onClick:i=>{i.preventDefault(),window.open(s.id,"_blank")}},C("shareCollectionJson")),x.createElement("button",{onClick:r=>{r.preventDefault(),window.open(i,"_blank")}},C("shareManifestJson"))," ",(null==s?void 0:s.items)&&x.createElement(St,{textPrompt:C("shareCollectionCopy"),textToCopy:s.id}),x.createElement(St,{textPrompt:C("shareManifestCopy"),textToCopy:i}))),(null==h?void 0:h.renderToggle)&&x.createElement(nB,null)))},tl=i=>{let t=()=>!!window.matchMedia&&window.matchMedia(i).matches,[r,l]=(0,x.useState)(t);return(0,x.useEffect)(()=>{let a=()=>l(t);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}),r},nl=({manifest:i,theme:r,iiifContentSearchQuery:l})=>{var s;let d=M(),h=U(),{activeCanvas:g,activeSelector:v,isInformationOpen:y,vault:E,contentSearchVault:S,configOptions:C,openSeadragonViewer:k}=d,I=(null==C?void 0:C.canvasHeight)&&["100%","auto"].includes(null==C?void 0:C.canvasHeight),[R,P]=(0,x.useState)(!1),[L,_]=(0,x.useState)(!1),[F,V]=(0,x.useState)([]),[N,j]=(0,x.useState)([]),[H,B]=(0,x.useState)(),W=tl(e9.sm),[G,Q]=(0,x.useState)(),[Y,X]=(0,x.useState)([]),ee=(0,x.useCallback)(i=>{h({type:"updateInformationOpen",isInformationOpen:i})},[h]);(0,x.useEffect)(()=>{var i;null!=(i=null==C?void 0:C.informationPanel)&&i.open&&ee(!W)},[W,null==(s=null==C?void 0:C.informationPanel)?void 0:s.open]),(0,x.useEffect)(()=>{},[W]),(0,x.useEffect)(()=>{let r=ue(E,g);r&&(_(["Sound","Video"].indexOf(r[0].type)>-1),V(r));let l=(0,A.sA)(E,i,g);if(X(l),Ko(E,g).then(i=>{i.length>0&&!W&&h({type:"updateInformationOpen",isInformationOpen:!0}),j(i),P(0!==i.length)}),k&&g&&v){let i=E.get({id:g,type:"Canvas"});setTimeout(()=>{Xo(v,k,i,C)},300)}},[g,v,N.length,W,i,E,h,k,C]);let ei=i.service.some(i=>"SearchService2"===i.type);return(0,x.useEffect)(()=>{if(ei){let r=i.service.find(i=>"SearchService2"===i.type);r&&Q(r.id)}},[i,ei]),(0,x.useEffect)(()=>{var i,r,s;G&&(null==(i=C.informationPanel)?void 0:i.renderContentSearch)!==!1&&dn(S,G,null==(s=null==(r=C.localeText)?void 0:r.contentSearch)?void 0:s.tabLabel,l).then(i=>{B(i)})},[G]),(0,x.useEffect)(()=>{if(!k||!H)return;let i=E.get({id:g,type:"Canvas"});cn(k,"content-search-overlay"),function(i,r,l,s,d){var h;if(!(null!=r&&r.items)||(null==r?void 0:r.items.length)===0)return;let g=[];r.items.forEach(r=>{let l=i.get(r.id);"string"==typeof l.target&&l.target.startsWith(s.id)&&g.push(l)}),l&&null!=(h=d.contentSearch)&&h.overlays&&an(l,s,d.contentSearch.overlays,g,"content-search-overlay")}(S,H,k,i,C)},[k,H]),x.createElement($.ErrorBoundary,{FallbackComponent:nt},x.createElement(th,{className:`${r} clover-viewer`,css:{background:null==C?void 0:C.background},"data-absolute-position":I,"data-information-panel":R,"data-information-panel-open":y},x.createElement(T.fC,{open:y,onOpenChange:ee},x.createElement(el,{manifestLabel:i.label,manifestId:i.id}),x.createElement(Ps,{activeCanvas:g,painting:F,annotationResources:N,searchServiceUrl:G,setContentSearchResource:B,contentSearchResource:H,items:i.items,isAudioVideo:L,visibleCanvases:Y}))))},nW={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function It(i,r=null){return{ok:!1,status:i.status,statusText:i.statusText,headers:i.getAllResponseHeaders(),data:r||i.statusText,json:()=>JSON.parse(r||i.statusText)}}let Cl=({canvasIdCallback:i=()=>{},customDisplays:r=[],plugins:l=[],customTheme:s,iiifContent:d,id:h,manifestId:g,options:v,iiifContentSearchQuery:y})=>{var E,S,C;let k=d;h&&(k=h),g&&(k=g);let I=nn(null==(S=null==(E=null==v?void 0:v.informationPanel)?void 0:E.vtt)?void 0:S.autoScroll);return x.createElement(Fo,{initialState:{...e4,customDisplays:r,plugins:l,isAutoScrollEnabled:I.enabled,isInformationOpen:!!(null!=(C=null==v?void 0:v.informationPanel)&&C.open),vault:new e0({customFetcher:i=>(function(i,r=nW){let l=r.headers||nW.headers;return new Promise((s,d)=>{let h=new XMLHttpRequest;h.open("get",i),h.withCredentials=r.withCredentials,l&&Object.keys(l).forEach(i=>h.setRequestHeader(i,l[i])),h.onload=()=>{s({ok:h.status>=200&&h.status<300,status:h.status,statusText:h.statusText,headers:h.getAllResponseHeaders(),data:h.responseText,json:()=>JSON.parse(h.responseText)})},h.onerror=()=>{d(It(h,"Failed to make request."))},h.ontimeout=()=>{d(It(h,"Request took longer than expected."))},h.send()})})(i,{withCredentials:null==v?void 0:v.withCredentials,headers:null==v?void 0:v.requestHeaders}).then(i=>JSON.parse(i.data))})}},x.createElement(al,{iiifContent:k,canvasIdCallback:i,customTheme:s,options:v,iiifContentSearchQuery:y}))},al=({canvasIdCallback:i,customTheme:r,iiifContent:l,options:s,iiifContentSearchQuery:d})=>{let h=U(),g=M(),{activeCanvas:v,activeManifest:y,isLoaded:E,vault:S}=g,[C,k]=(0,x.useState)(),[I,T]=(0,x.useState)(),R={};if(r&&(R=(0,P.jG)("custom",r)),(0,x.useEffect)(()=>{i&&i(v)},[v,i]),(0,x.useEffect)(()=>{y&&S.load(y).then(i=>{let r=(0,A.rw)(S,i);T(i);let s=Vo(l,i),d=Wo(l);h({type:"updateActiveCanvas",canvasId:s}),d&&h({type:"updateActiveSelector",selector:d}),h({type:"updateManifestSequence",sequence:r})}).catch(i=>{console.error(`Manifest failed to load: ${i}`)}).finally(()=>{h({type:"updateIsLoaded",isLoaded:!0})})},[l,y,h,S]),(0,x.useEffect)(()=>{h({type:"updateConfigOptions",configOptions:s});let i=No(l);S.load(i).then(i=>{k(i)}).catch(i=>{console.error(`The IIIF resource ${l} failed to load: ${i}`)})},[h,l,s,S]),(0,x.useEffect)(()=>{if((null==C?void 0:C.type)==="Collection"){h({type:"updateCollection",collection:C});let i=Ho(l,C);i&&h({type:"updateActiveManifest",manifestId:i})}else(null==C?void 0:C.type)==="Manifest"&&h({type:"updateActiveManifest",manifestId:C.id})},[h,l,C]),!E){if(null==s||!s.customLoadingComponent)return x.createElement(x.Fragment,null,"Loading");{let i=s.customLoadingComponent;return x.createElement(i,null)}}return I&&I.items?0===I.items.length?(console.log(`The IIIF manifest ${l} does not contain canvases.`),x.createElement(x.Fragment,null)):x.createElement(nl,{manifest:I,theme:R,key:I.id,iiifContentSearchQuery:d}):(console.log(`The IIIF manifest ${l} failed to load.`),x.createElement(x.Fragment,null))}}}]);